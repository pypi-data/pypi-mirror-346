import{s as J,M as ce,q as ue,E as P,F as W,a as T,d as h,f as c,i as I,g as w,n as H,z as de,B as he,j as F,p as fe,e as j,t as L,k as N,c as E,b as M,o as O,G as me,u as Z,h as A}from"./BDiUIGvQ.js";import{S as G,i as Y,b as X,d as ee,m as te,t as $,a as q,e as ae,f as pe,g as ge,c as _e}from"./CMw2dQw9.js";import{a as we,b as ye,u as ne,d as re,e as ke,f as K,s as be,h as ve}from"./DymSoHLR.js";import{r as oe,m as Ce,c as Se,e as z}from"./zXyoBDYa.js";import{T as Te}from"./h_WTVbQz.js";import{t as Q}from"./CCWCPRcv.js";import{m as Ie}from"./DBlB6aBr.js";import{M as je}from"./cyg7nPOp.js";function Ee(n){let e,a;return e=new Te({props:{tags:n[0]}}),e.$on("delete",n[4]),e.$on("add",n[5]),{c(){X(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,s){te(e,t,s),a=!0},p(t,[s]){const r={};s&1&&(r.tags=t[0]),e.$set(r)},i(t){a||($(e.$$.fragment,t),a=!0)},o(t){q(e.$$.fragment,t),a=!1},d(t){ae(e,t)}}}function Be(n,e,a){const t=ce();let{chatId:s=""}=e,r=[];const o=async()=>await we(localStorage.token,s).catch(async m=>[]),i=async m=>{await ye(localStorage.token,s,m).catch(async f=>(Q.error(`${f}`),null))&&(a(0,r=await o()),await ne(localStorage.token,s,{tags:r}),await oe.set(await re(localStorage.token)),t("add",{name:m}))},p=async m=>{await ke(localStorage.token,s,m),a(0,r=await o()),await ne(localStorage.token,s,{tags:r}),await oe.set(await re(localStorage.token)),t("delete",{name:m})};ue(async()=>{s&&a(0,r=await o())});const v=m=>{p(m.detail)},C=m=>{i(m.detail)};return n.$$set=m=>{"chatId"in m&&a(3,s=m.chatId)},[r,i,p,s,v,C]}class Fe extends G{constructor(e){super(),Y(this,e,Be,Ee,J,{chatId:3})}}function Le(n){let e,a,t;return{c(){e=P("svg"),a=P("path"),t=P("path"),this.h()},l(s){e=W(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=T(e);a=W(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),T(a).forEach(h),t=W(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),T(t).forEach(h),r.forEach(h),this.h()},h(){c(a,"fill-rule","evenodd"),c(a,"d","M8.914 6.025a.75.75 0 0 1 1.06 0 3.5 3.5 0 0 1 0 4.95l-2 2a3.5 3.5 0 0 1-5.396-4.402.75.75 0 0 1 1.251.827 2 2 0 0 0 3.085 2.514l2-2a2 2 0 0 0 0-2.828.75.75 0 0 1 0-1.06Z"),c(a,"clip-rule","evenodd"),c(t,"fill-rule","evenodd"),c(t,"d","M7.086 9.975a.75.75 0 0 1-1.06 0 3.5 3.5 0 0 1 0-4.95l2-2a3.5 3.5 0 0 1 5.396 4.402.75.75 0 0 1-1.251-.827 2 2 0 0 0-3.085-2.514l-2 2a2 2 0 0 0 0 2.828.75.75 0 0 1 0 1.06Z"),c(t,"clip-rule","evenodd"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 0 16 16"),c(e,"fill","currentColor"),c(e,"class",n[0])},m(s,r){I(s,e,r),w(e,a),w(e,t)},p(s,[r]){r&1&&c(e,"class",s[0])},i:H,o:H,d(s){s&&h(e)}}}function Me(n,e,a){let{className:t="w-4 h-4"}=e;return n.$$set=s=>{"className"in s&&a(0,t=s.className)},[t]}class Ue extends G{constructor(e){super(),Y(this,e,Me,Le,J,{className:0})}}function le(n){var B;let e,a,t,s,r,o,i,p,v,C,m,b,f;function g(l,d){return l[2].share_id?Ne:Ae}let y=g(n),k=y(n),_=((B=n[4])==null?void 0:B.features.enable_community_sharing)&&ie(n);v=new Ue({});function U(l,d){return l[2].share_id?De:Oe}let u=U(n),S=u(n);return{c(){e=j("div"),a=j("div"),k.c(),t=N(),s=j("div"),r=j("div"),o=j("div"),_&&_.c(),i=N(),p=j("button"),X(v.$$.fragment),C=N(),S.c(),this.h()},l(l){e=E(l,"DIV",{class:!0});var d=T(e);a=E(d,"DIV",{class:!0});var D=T(a);k.l(D),D.forEach(h),t=O(d),s=E(d,"DIV",{class:!0});var V=T(s);r=E(V,"DIV",{class:!0});var se=T(r);o=E(se,"DIV",{class:!0});var x=T(o);_&&_.l(x),i=O(x),p=E(x,"BUTTON",{class:!0,type:!0,id:!0});var R=T(p);ee(v.$$.fragment,R),C=O(R),S.l(R),R.forEach(h),x.forEach(h),se.forEach(h),V.forEach(h),d.forEach(h),this.h()},h(){c(a,"class","text-sm dark:text-gray-300 mb-1"),c(p,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),c(p,"type","button"),c(p,"id","copy-and-share-chat-button"),c(o,"class","flex gap-1"),c(r,"class","flex flex-col items-end space-x-1 mt-3"),c(s,"class","flex justify-end"),c(e,"class","px-5 pt-4 pb-5 w-full flex flex-col justify-center")},m(l,d){I(l,e,d),w(e,a),k.m(a,null),w(e,t),w(e,s),w(s,r),w(r,o),_&&_.m(o,null),w(o,i),w(o,p),te(v,p,null),w(p,C),S.m(p,null),m=!0,b||(f=Z(p,"click",n[11]),b=!0)},p(l,d){var D;y===(y=g(l))&&k?k.p(l,d):(k.d(1),k=y(l),k&&(k.c(),k.m(a,null))),(D=l[4])!=null&&D.features.enable_community_sharing?_?_.p(l,d):(_=ie(l),_.c(),_.m(o,i)):_&&(_.d(1),_=null),u===(u=U(l))&&S?S.p(l,d):(S.d(1),S=u(l),S&&(S.c(),S.m(p,null)))},i(l){m||($(v.$$.fragment,l),m=!0)},o(l){q(v.$$.fragment,l),m=!1},d(l){l&&h(e),k.d(),_&&_.d(),ae(v),S.d(),b=!1,f()}}}function Ae(n){let e=n[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"",a;return{c(){a=L(e)},l(t){a=M(t,e)},m(t,s){I(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"")&&A(a,e)},d(t){t&&h(a)}}}function Ne(n){let e,a=n[3].t("You have shared this chat")+"",t,s,r,o=n[3].t("before")+"",i,p,v,C,m=n[3].t("Click here to")+"",b,f,g,y=n[3].t("delete this link")+"",k,_,U=n[3].t("and create a new shared link.")+"",u,S,B;return{c(){e=j("a"),t=L(a),s=N(),r=j("span"),i=L(o),p=L("."),C=N(),b=L(m),f=N(),g=j("button"),k=L(y),_=N(),u=L(U),this.h()},l(l){e=E(l,"A",{href:!0,target:!0});var d=T(e);t=M(d,a),s=O(d),r=E(d,"SPAN",{class:!0});var D=T(r);i=M(D,o),D.forEach(h),p=M(d,"."),d.forEach(h),C=O(l),b=M(l,m),f=O(l),g=E(l,"BUTTON",{class:!0});var V=T(g);k=M(V,y),V.forEach(h),_=O(l),u=M(l,U),this.h()},h(){c(r,"class","underline"),c(e,"href",v="/s/"+n[2].share_id),c(e,"target","_blank"),c(g,"class","underline")},m(l,d){I(l,e,d),w(e,t),w(e,s),w(e,r),w(r,i),w(e,p),I(l,C,d),I(l,b,d),I(l,f,d),I(l,g,d),w(g,k),I(l,_,d),I(l,u,d),S||(B=Z(g,"click",n[9]),S=!0)},p(l,d){d&8&&a!==(a=l[3].t("You have shared this chat")+"")&&A(t,a),d&8&&o!==(o=l[3].t("before")+"")&&A(i,o),d&4&&v!==(v="/s/"+l[2].share_id)&&c(e,"href",v),d&8&&m!==(m=l[3].t("Click here to")+"")&&A(b,m),d&8&&y!==(y=l[3].t("delete this link")+"")&&A(k,y),d&8&&U!==(U=l[3].t("and create a new shared link.")+"")&&A(u,U)},d(l){l&&(h(e),h(C),h(b),h(f),h(g),h(_),h(u)),S=!1,B()}}}function ie(n){let e,a=n[3].t("Share to Open WebUI Community")+"",t,s,r;return{c(){e=j("button"),t=L(a),this.h()},l(o){e=E(o,"BUTTON",{class:!0,type:!0});var i=T(e);t=M(i,a),i.forEach(h),this.h()},h(){c(e,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full"),c(e,"type","button")},m(o,i){I(o,e,i),w(e,t),s||(r=Z(e,"click",n[10]),s=!0)},p(o,i){i&8&&a!==(a=o[3].t("Share to Open WebUI Community")+"")&&A(t,a)},d(o){o&&h(e),s=!1,r()}}}function Oe(n){let e=n[3].t("Copy Link")+"",a;return{c(){a=L(e)},l(t){a=M(t,e)},m(t,s){I(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Copy Link")+"")&&A(a,e)},d(t){t&&h(a)}}}function De(n){let e=n[3].t("Update and Copy Link")+"",a;return{c(){a=L(e)},l(t){a=M(t,e)},m(t,s){I(t,a,s)},p(t,s){s&8&&e!==(e=t[3].t("Update and Copy Link")+"")&&A(a,e)},d(t){t&&h(a)}}}function $e(n){let e,a,t,s=n[3].t("Share Chat")+"",r,o,i,p='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',v,C,m,b,f=n[2]&&le(n);return{c(){e=j("div"),a=j("div"),t=j("div"),r=L(s),o=N(),i=j("button"),i.innerHTML=p,v=N(),f&&f.c(),this.h()},l(g){e=E(g,"DIV",{});var y=T(e);a=E(y,"DIV",{class:!0});var k=T(a);t=E(k,"DIV",{class:!0});var _=T(t);r=M(_,s),_.forEach(h),o=O(k),i=E(k,"BUTTON",{class:!0,"data-svelte-h":!0}),me(i)!=="svelte-745w2y"&&(i.innerHTML=p),k.forEach(h),v=O(y),f&&f.l(y),y.forEach(h),this.h()},h(){c(t,"class","text-lg font-medium self-center"),c(i,"class","self-center"),c(a,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(g,y){I(g,e,y),w(e,a),w(a,t),w(t,r),w(a,o),w(a,i),w(e,v),f&&f.m(e,null),C=!0,m||(b=Z(i,"click",n[8]),m=!0)},p(g,y){(!C||y&8)&&s!==(s=g[3].t("Share Chat")+"")&&A(r,s),g[2]?f?(f.p(g,y),y&4&&$(f,1)):(f=le(g),f.c(),$(f,1),f.m(e,null)):f&&(ge(),q(f,1,1,()=>{f=null}),_e())},i(g){C||($(f),C=!0)},o(g){q(f),C=!1},d(g){g&&h(e),f&&f.d(),m=!1,b()}}}function ze(n){let e,a,t;function s(o){n[12](o)}let r={size:"md",$$slots:{default:[$e]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new je({props:r}),de.push(()=>pe(e,"show",s)),{c(){X(e.$$.fragment)},l(o){ee(e.$$.fragment,o)},m(o,i){te(e,o,i),t=!0},p(o,[i]){const p={};i&65567&&(p.$$scope={dirty:i,ctx:o}),!a&&i&1&&(a=!0,p.show=o[0],he(()=>a=!1)),e.$set(p)},i(o){t||($(e.$$.fragment,o),t=!0)},o(o){q(e.$$.fragment,o),t=!1},d(o){ae(e,o)}}}function Ve(n,e,a){let t,s,r;F(n,Ce,u=>a(14,t=u)),F(n,Se,u=>a(4,r=u));let{chatId:o}=e,i=null,p=null;const v=fe("i18n");F(n,v,u=>a(3,s=u));const C=async()=>{const u=await be(localStorage.token,o);return p=`${window.location.origin}/s/${u.id}`,console.log(p),a(2,i=await K(localStorage.token,o)),p},m=async()=>{const u=i.chat;console.log("share",u),Q.success(s.t("Redirecting you to Open WebUI Community"));const S="https://openwebui.com",B=await window.open(`${S}/chats/upload`,"_blank");window.addEventListener("message",l=>{l.origin===S&&l.data==="loaded"&&B.postMessage(JSON.stringify({chat:u,models:t.filter(d=>u.models.includes(d.id))}),"*")},!1)};let{show:b=!1}=e;const f=u=>i?u?i.id!==u.id||i.share_id!==u.share_id:!1:!0,g=()=>{a(0,b=!1)},y=async()=>{await ve(localStorage.token,o)&&a(2,i=await K(localStorage.token,o))},k=()=>{m(),a(0,b=!1)},_=async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){console.log("isSafari");const S=async()=>{const B=await C();return new Blob([B],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":S()})]).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(B=>(console.error("Async: Could not copy text: ",B),!1))}else Ie(await C());Q.success(s.t("Copied shared chat URL to clipboard!")),a(0,b=!1)};function U(u){b=u,a(0,b)}return n.$$set=u=>{"chatId"in u&&a(1,o=u.chatId),"show"in u&&a(0,b=u.show)},n.$$.update=()=>{n.$$.dirty&7&&b&&(async()=>{if(o){const u=await K(localStorage.token,o);f(u)&&a(2,i=u)}else a(2,i=null),console.log(i)})()},[b,o,i,s,r,v,C,m,g,y,k,_,U]}class Ke extends G{constructor(e){super(),Y(this,e,Ve,ze,J,{chatId:1,show:0})}}function Pe(n){let e,a;return{c(){e=P("svg"),a=P("path"),this.h()},l(t){e=W(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=T(e);a=W(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),T(a).forEach(h),s.forEach(h),this.h()},h(){c(a,"stroke-linecap","round"),c(a,"stroke-linejoin","round"),c(a,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",n[1]),c(e,"stroke","currentColor"),c(e,"class",n[0])},m(t,s){I(t,e,s),w(e,a)},p(t,[s]){s&2&&c(e,"stroke-width",t[1]),s&1&&c(e,"class",t[0])},i:H,o:H,d(t){t&&h(e)}}}function We(n,e,a){let{className:t="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&a(0,t=r.className),"strokeWidth"in r&&a(1,s=r.strokeWidth)},[t,s]}class Qe extends G{constructor(e){super(),Y(this,e,We,Pe,J,{className:0,strokeWidth:1})}}const Xe=async n=>{let e=null;const a=await fetch(`${z}/memories/`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).catch(t=>(e=t.detail,console.log(t),null));if(e)throw e;return a},et=async(n,e)=>{let a=null;const t=await fetch(`${z}/memories/add`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(a=s.detail,console.log(s),null));if(a)throw a;return t},tt=async(n,e,a)=>{let t=null;const s=await fetch(`${z}/memories/${e}/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`},body:JSON.stringify({content:a})}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>(t=r.detail,console.log(r),null));if(t)throw t;return s},at=async(n,e)=>{let a=null;const t=await fetch(`${z}/memories/query`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`},body:JSON.stringify({content:e})}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).catch(s=>(a=s.detail,console.log(s),null));if(a)throw a;return t},st=async(n,e)=>{let a=null;const t=await fetch(`${z}/memories/${e}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`}}).then(async s=>{if(!s.ok)throw await s.json();return s.json()}).then(s=>s).catch(s=>(a=s.detail,console.log(s),null));if(a)throw a;return t},nt=async n=>{let e=null;const a=await fetch(`${z}/memories/delete/user`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).then(t=>t).catch(t=>(e=t.detail,console.log(t),null));if(e)throw e;return a};export{Qe as P,Ke as S,Fe as T,et as a,st as b,nt as d,Xe as g,at as q,tt as u};
//# sourceMappingURL=OuWPaBhF.js.map
