import{r as e,j as t}from"./react-BbQoyxJr.js";const n=["shift","alt","meta","mod","ctrl","control"],o={esc:"escape",return:"enter",left:"arrowleft",right:"arrowright",up:"arrowup",down:"arrowdown",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function r(e){return(o[e.trim()]||e.trim()).toLowerCase().replace(/key|digit|numpad/,"")}function i(e,t=","){return e.toLowerCase().split(t)}function l(e,t="+",o=!1,i){const l=e.toLocaleLowerCase().split(t).map((e=>r(e)));return{...{alt:l.includes("alt"),ctrl:l.includes("ctrl")||l.includes("control"),shift:l.includes("shift"),meta:l.includes("meta"),mod:l.includes("mod"),useKey:o},keys:l.filter((e=>!n.includes(e))),description:i}}typeof document<"u"&&(document.addEventListener("keydown",(e=>{void 0!==e.code&&s([r(e.code)])})),document.addEventListener("keyup",(e=>{void 0!==e.code&&a([r(e.code)])}))),typeof window<"u"&&window.addEventListener("blur",(()=>{u.clear()}));const u=new Set;function c(e){return Array.isArray(e)}function s(e){const t=Array.isArray(e)?e:[e];u.has("meta")&&u.forEach((e=>!function(e){return n.includes(e)}(e)&&u.delete(e.toLowerCase()))),t.forEach((e=>u.add(e.toLowerCase())))}function a(e){const t=Array.isArray(e)?e:[e];"meta"===e?u.clear():t.forEach((e=>u.delete(e.toLowerCase())))}function d(e,t=!1){const{target:n,composed:o}=e;let r;return r=function(e){return!!e.tagName&&!e.tagName.startsWith("-")&&e.tagName.includes("-")}(n)&&o?e.composedPath()[0]&&e.composedPath()[0].tagName:n&&n.tagName,c(t)?!!(r&&t&&t.some((e=>e.toLowerCase()===r.toLowerCase()))):!!(r&&t&&t)}const f=(e,t,n=!1)=>{const{alt:o,meta:i,mod:l,shift:s,ctrl:a,keys:d,useKey:f}=t,{code:v,key:y,ctrlKey:m,metaKey:p,shiftKey:h,altKey:k}=e,w=r(v);if(f&&1===(null==d?void 0:d.length)&&d.includes(y))return!0;if(!(null!=d&&d.includes(w)||["ctrl","control","unknown","meta","alt","shift","os"].includes(w)))return!1;if(!n){if(o!==k&&"alt"!==w||s!==h&&"shift"!==w)return!1;if(l){if(!p&&!m)return!1}else if(i!==p&&"meta"!==w&&"os"!==w||a!==m&&"ctrl"!==w&&"control"!==w)return!1}return!(!d||1!==d.length||!d.includes(w))||(d?function(e,t=","){return(c(e)?e:e.split(t)).every((e=>u.has(e.trim().toLowerCase())))}(d):!d)},v=e.createContext(void 0);function y({addHotkey:e,removeHotkey:n,children:o}){return t.jsx(v.Provider,{value:{addHotkey:e,removeHotkey:n},children:o})}function m(e,t){return e&&t&&"object"==typeof e&&"object"==typeof t?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(((n,o)=>n&&m(e[o],t[o])),!0):e===t}const p=e.createContext({hotkeys:[],activeScopes:[],toggleScope:()=>{},enableScope:()=>{},disableScope:()=>{}}),h=({initiallyActiveScopes:n=["*"],children:o})=>{const[r,i]=e.useState(n),[l,u]=e.useState([]),c=e.useCallback((e=>{i((t=>t.includes("*")?[e]:Array.from(new Set([...t,e]))))}),[]),s=e.useCallback((e=>{i((t=>t.filter((t=>t!==e))))}),[]),a=e.useCallback((e=>{i((t=>t.includes(e)?t.filter((t=>t!==e)):t.includes("*")?[e]:Array.from(new Set([...t,e]))))}),[]),d=e.useCallback((e=>{u((t=>[...t,e]))}),[]),f=e.useCallback((e=>{u((t=>t.filter((t=>!m(t,e)))))}),[]);return t.jsx(p.Provider,{value:{activeScopes:r,hotkeys:l,enableScope:c,disableScope:s,toggleScope:a},children:t.jsx(y,{addHotkey:d,removeHotkey:f,children:o})})};const k=e=>{e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},w=typeof window<"u"?e.useLayoutEffect:e.useEffect;function g(t,n,o,u){const y=e.useRef(null),h=e.useRef(!1),g=o instanceof Array?u instanceof Array?void 0:u:o,L=c(t)?t.join(null==g?void 0:g.delimiter):t,C=o instanceof Array?o:u instanceof Array?u:void 0,b=e.useCallback(n,C??[]),E=e.useRef(b);E.current=C?b:n;const S=function(t){const n=e.useRef(void 0);return m(n.current,t)||(n.current=t),n.current}(g),{activeScopes:A}=e.useContext(p),K=e.useContext(v);return w((()=>{if(!1===(null==S?void 0:S.enabled)||!function(e,t){return!(0!==e.length||!t)||!t||e.some((e=>t.includes(e)))||e.includes("*")}(A,null==S?void 0:S.scopes))return;const e=(e,t=!1)=>{var n;if(!function(e){return d(e,["input","textarea","select"])}(e)||d(e,null==S?void 0:S.enableOnFormTags)){if(null!==y.current){const t=y.current.getRootNode();if((t instanceof Document||t instanceof ShadowRoot)&&t.activeElement!==y.current&&!y.current.contains(t.activeElement))return void k(e)}null!=(n=e.target)&&n.isContentEditable&&(null==S||!S.enableOnContentEditable)||i(L,null==S?void 0:S.delimiter).forEach((n=>{var o,r;const i=l(n,null==S?void 0:S.splitKey,null==S?void 0:S.useKey,null==S?void 0:S.description);if(f(e,i,null==S?void 0:S.ignoreModifiers)||null!=(o=i.keys)&&o.includes("*")){if(null!=(r=null==S?void 0:S.ignoreEventWhen)&&r.call(S,e)||t&&h.current)return;if(function(e,t,n){("function"==typeof n&&n(e,t)||!0===n)&&e.preventDefault()}(e,i,null==S?void 0:S.preventDefault),!function(e,t,n){return"function"==typeof n?n(e,t):!0===n||void 0===n}(e,i,null==S?void 0:S.enabled))return void k(e);E.current(e,i),t||(h.current=!0)}}))}},t=t=>{void 0!==t.code&&(s(r(t.code)),(void 0===(null==S?void 0:S.keydown)&&!0!==(null==S?void 0:S.keyup)||null!=S&&S.keydown)&&e(t))},n=t=>{void 0!==t.code&&(a(r(t.code)),h.current=!1,null!=S&&S.keyup&&e(t,!0))},o=y.current||(null==g?void 0:g.document)||document;return o.addEventListener("keyup",n,null==g?void 0:g.eventListenerOptions),o.addEventListener("keydown",t,null==g?void 0:g.eventListenerOptions),K&&i(L,null==S?void 0:S.delimiter).forEach((e=>K.addHotkey(l(e,null==S?void 0:S.splitKey,null==S?void 0:S.useKey,null==S?void 0:S.description)))),()=>{o.removeEventListener("keyup",n,null==g?void 0:g.eventListenerOptions),o.removeEventListener("keydown",t,null==g?void 0:g.eventListenerOptions),K&&i(L,null==S?void 0:S.delimiter).forEach((e=>K.removeHotkey(l(e,null==S?void 0:S.splitKey,null==S?void 0:S.useKey,null==S?void 0:S.description))))}}),[L,S,A]),y}export{h as f,g as s};
