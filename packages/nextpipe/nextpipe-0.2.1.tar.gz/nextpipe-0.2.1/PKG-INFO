Metadata-Version: 2.4
Name: nextpipe
Version: 0.2.1
Summary: Framework for Decision Pipeline modeling and execution
Project-URL: Homepage, https://www.nextmv.io
Project-URL: Documentation, https://www.nextmv.io/docs
Project-URL: Repository, https://github.com/nextmv-io/nextpipe
Author-email: Nextmv <tech@nextmv.io>
Maintainer-email: Nextmv <tech@nextmv.io>
License: # LICENSE
        
        Business Source License 1.1
        
        Parameters
        
        Licensor:             nextmv.io inc
        Licensed Work:        nextpipe
        
        Change Date:          Four years from the date the Licensed Work is published.
        Change License:       GPLv3
        
        For information about alternative licensing arrangements for the Software,
        please email info@nextmv.io.
        
        Notice
        
        The Business Source License (this document, or the “License”) is not an Open
        Source license. However, the Licensed Work will eventually be made available
        under an Open Source License, as stated in this License.
        
        License text copyright © 2023 MariaDB plc, All Rights Reserved. “Business Source
        License” is a trademark of MariaDB plc.
        
        -----------------------------------------------------------------------------
        
        ## Terms
        
        The Licensor hereby grants you the right to copy, modify, create derivative
        works, redistribute, and make non-production use of the Licensed Work. The
        Licensor may make an Additional Use Grant, above, permitting limited production
        use.
        
        Effective on the Change Date, or the fourth anniversary of the first publicly
        available distribution of a specific version of the Licensed Work under this
        License, whichever comes first, the Licensor hereby grants you rights under the
        terms of the Change License, and the rights granted in the paragraph above
        terminate.
        
        If your use of the Licensed Work does not comply with the requirements currently
        in effect as described in this License, you must purchase a commercial license
        from the Licensor, its affiliated entities, or authorized resellers, or you must
        refrain from using the Licensed Work.
        
        All copies of the original and modified Licensed Work, and derivative works of
        the Licensed Work, are subject to this License. This License applies separately
        for each version of the Licensed Work and the Change Date may vary for each
        version of the Licensed Work released by Licensor.
        
        You must conspicuously display this License on each original or modified copy of
        the Licensed Work. If you receive the Licensed Work in original or modified form
        from a third party, the terms and conditions set forth in this License apply to
        your use of that work.
        
        Any use of the Licensed Work in violation of this License will automatically
        terminate your rights under this License for the current and all other versions
        of the Licensed Work.
        
        This License does not grant you any right in any trademark or logo of Licensor
        or its affiliates (provided that you may use a trademark or logo of Licensor as
        expressly required by this License).TO THE EXTENT PERMITTED BY APPLICABLE LAW,
        THE LICENSED WORK IS PROVIDED ON AN “AS IS” BASIS. LICENSOR HEREBY DISCLAIMS ALL
        WARRANTIES AND CONDITIONS, EXPRESS OR IMPLIED, INCLUDING (WITHOUT LIMITATION)
        WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
        NON-INFRINGEMENT, AND TITLE. MariaDB hereby grants you permission to use this
        License’s text to license your works, and to refer to it using the trademark
        “Business Source License”, as long as you comply with the Covenants of Licensor
        below.
        
        ## Covenants of Licensor
        
        In consideration of the right to use this License’s text and the “Business
        Source License” name and trademark, Licensor covenants to MariaDB, and to all
        other recipients of the licensed work to be provided by Licensor:
        
        To specify as the Change License the GPL Version 2.0 or any later version, or a
        license that is compatible with GPL Version 2.0 or a later version, where
        “compatible” means that software provided under the Change License can be
        included in a program with software provided under GPL Version 2.0 or a later
        version. Licensor may specify additional Change Licenses without limitation. To
        either: (a) specify an additional grant of rights to use that does not impose
        any additional restriction on the right granted in this License, as the
        Additional Use Grant; or (b) insert the text “None” to specify a Change Date.
        Not to modify this License in any other way.
        
        License text copyright © 2023 MariaDB plc, All Rights Reserved. “Business Source
        License” is a trademark of MariaDB plc.
License-File: LICENSE.md
Keywords: decision automation,decision engineering,decision pipelines,decision science,decision workflows,decisions,nextmv,operations research,optimization,pipelines,workflows
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Requires-Python: >=3.9
Requires-Dist: dataclasses-json>=0.6.7
Requires-Dist: nextmv>=0.25.0
Requires-Dist: requests>=2.31.0
Provides-Extra: dev
Requires-Dist: goldie>=0.1.7; extra == 'dev'
Requires-Dist: ruff>=0.11.6; extra == 'dev'
Description-Content-Type: text/markdown

# nextpipe

Framework for Decision Pipeline modeling and execution.

## Installation

```bash
pip install nextpipe
```

## Preview

Example of a pipeline utilizing multiple routing solvers, and picking the best result.

```mermaid
graph LR
  fetch_data(prepare_data)
  fetch_data --> run_nextroute
  fetch_data --> run_ortools
  fetch_data --> run_pyvroom
  run_nextroute{ }
  run_nextroute_join{ }
  run_nextroute_0(run_nextroute_0)
  run_nextroute --> run_nextroute_0
  run_nextroute_0 --> run_nextroute_join
  run_nextroute_1(run_nextroute_1)
  run_nextroute --> run_nextroute_1
  run_nextroute_1 --> run_nextroute_join
  run_nextroute_2(run_nextroute_2)
  run_nextroute --> run_nextroute_2
  run_nextroute_2 --> run_nextroute_join
  run_nextroute_join --> pick_best
  run_ortools(run_ortools)
  run_ortools --> pick_best
  run_pyvroom(run_pyvroom)
  run_pyvroom --> pick_best
  pick_best(pick_best)
```

## Modeling

Pipeline modeling is done by defining a flow as steps and decorating them.
The following example demonstrates a 3 step pipeline that makes use of dynamic fanout and joining of results.

```python
from nextpipe import AppOption, AppRunConfig, FlowSpec, app, foreach, join, needs, step


class Flow(FlowSpec):
    @foreach()  # Run the successor step for each item in the result list of this step
    @step
    def prepare(data: dict):
        """
        Creates 3 copies of the input and configures them for 3 different app parameters.
        """
        inputs = [copy.deepcopy(data) for _ in range(3)]
        run_configs = [AppRunConfig(input, [AppOption("param", i)]) for i, input in enumerate(inputs)]
        return run_configs

    @app(app_id="echo")
    @needs(predecessors=[prepare])
    @step
    def solve():
        """
        Imitates a solver app.
        """
        pass

    @needs(predecessors=[solve])
    @join()  # Collect the results from the previous 'foreach' step and combine them into a list passed as the arg
    @step
    def merge(results: list[dict]):
        """Merges the results."""
        return results
```

The pipeline can simply be executed from the main func of the app.

```python
# Run workflow
flow = Flow("DecisionFlow", input.data)
flow.run()

# Write out the result
print(json.dumps(flow.get_result(flow.merge)))
```

## Examples

You can find further examples of how to use `nextpipe` in the [examples](./examples) directory.
