%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[a4paper,12ptopenany,oneside,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage[english]{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{rHEALPixDGGS Documentation}
\date{Apr 10, 2025}
\release{0.5.4}
\author{Alexander Raichev}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxstepscope


\chapter{Introduction}
\label{\detokenize{introduction:introduction}}\label{\detokenize{introduction::doc}}
\sphinxAtStartPar
rHEALPixDGGS is a Python 3 package that implements the rHEALPix discrete global grid system (DGGS).
This documentation assumes you are familiar with the rHEALPix DGGS as described in \sphinxcite{introduction:grs2013} and familiar with basic Python 3.3 usage as described in \sphinxhref{http://docs.python.org/3/tutorial/}{The Python Tutorial}.


\section{Requirements}
\label{\detokenize{introduction:requirements}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{http://python.org/}{Python \textgreater{}=3.11}

\item {} 
\sphinxAtStartPar
\sphinxhref{http://www.numpy.org/}{NumPy \textgreater{}=1.25.2} Base N\sphinxhyphen{}dimensional array package

\item {} 
\sphinxAtStartPar
\sphinxhref{http://www.scipy.org/}{SciPy \textgreater{}=1.11.2} Fundamental library for scientific computing

\item {} 
\sphinxAtStartPar
\sphinxhref{http://matplotlib.org/}{Matplotlib \textgreater{}=3.7.2} Comprehensive 2D Plotting

\item {} 
\sphinxAtStartPar
\sphinxhref{http://code.google.com/p/pyproj/}{Pyproj \textgreater{}=3.6}
Python interface to the PROJ.4 cartographic library

\end{itemize}


\section{Installation}
\label{\detokenize{introduction:installation}}
\sphinxAtStartPar
The package is available on PyPI, the Package Index from where it can be installed as follows:

\sphinxAtStartPar
pip install rhealpixdggs

\sphinxAtStartPar
rHEALPixDGGS is also available for download from Landcare Research’s github repository \sphinxurl{https://github.com/manaakiwhenua/rhealpixdggs-py} from wher the latest version can be cloned.


\section{Usage}
\label{\detokenize{introduction:usage}}
\sphinxAtStartPar
To use rHEALPixDGGS after installing it, start a Python session in the directory where you downloaded the modules and import the modules.
Here are some examples.
For a list of all methods available, see the application programming interface (API) in the following chapters.


\subsection{Using the \sphinxstyleliteralintitle{\sphinxupquote{ellipsoids}} and \sphinxstyleliteralintitle{\sphinxupquote{projection\_wrapper}} Modules}
\label{\detokenize{introduction:using-the-ellipsoids-and-projection-wrapper-modules}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{ellipsoids}} module implements functions and constants dealing with ellipsoids of revolution (which include spheres but not general triaxial ellipsoids).
For brevity hereafter, the word ‘ellipsoid’ abbreviates ‘ellipsoid of revolution’.

\sphinxAtStartPar
The module \sphinxcode{\sphinxupquote{projection\_wrapper}} implements a wrapper for the map projections of ellipsoids defined in \sphinxcode{\sphinxupquote{pj\_healpix}}, \sphinxcode{\sphinxupquote{pj\_rhealpix}}, and Pyproj.

\sphinxAtStartPar
Currently \sphinxcode{\sphinxupquote{projection\_wrapper}} uses the HEALPix and rHEALPix projections
defined in \sphinxcode{\sphinxupquote{pj\_healpix}} and \sphinxcode{\sphinxupquote{pj\_rhealpix}} and \sphinxstyleemphasis{not} the buggy versions  defined in Pyproj 1.9.3 as \sphinxcode{\sphinxupquote{PJ\_healpix.c}}.
Alternatively, you can download a corrected version of \sphinxcode{\sphinxupquote{PJ\_healpix.c}} from
\sphinxhref{http://trac.osgeo.org/proj/changeset/2378}{trac.osgeo.org/proj/changeset/2378}, rebuild Pyproj with it, and use it in \sphinxcode{\sphinxupquote{dggs}} by editing the \sphinxcode{\sphinxupquote{HOMEMADE\_PROJECTIONS}} line in \sphinxcode{\sphinxupquote{projection\_wrapper}}.

\sphinxAtStartPar
Import all the classes, methods, and constants from the module:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{projection\PYGZus{}wrapper}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{ellipsoids}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{o}{*}
\end{sphinxVerbatim}

\sphinxAtStartPar
Create an ellipsoid, say, one with major radius 5 and eccentricity 0.8:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ellps\PYGZus{}1} \PYG{o}{=} \PYG{n}{Ellipsoid}\PYG{p}{(}\PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{e}\PYG{o}{=}\PYG{l+m+mf}{0.8}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{ellps\PYGZus{}1}\PYG{p}{)}
\PYG{g+go}{ellipsoid:}
\PYG{g+go}{    R\PYGZus{}A = 4.322001171188888}
\PYG{g+go}{    a = 5}
\PYG{g+go}{    b = 2.999999999999999}
\PYG{g+go}{    e = 0.8}
\PYG{g+go}{    f = 0.4}
\PYG{g+go}{    lat\PYGZus{}0 = 0}
\PYG{g+go}{    lon\PYGZus{}0 = 0}
\PYG{g+go}{    radians = False}
\PYG{g+go}{    sphere = False}
\end{sphinxVerbatim}

\sphinxAtStartPar
The names of the ellipsoid attributes agree with the names of the \sphinxhref{http://trac.osgeo.org/proj/wiki/GenParms}{PROJ.4 ellipsoid parameters}.
For example, \sphinxcode{\sphinxupquote{R\_A}} is the authalic radius of the ellipsoid, the radius of the sphere that has the same area as the ellipsoid.

\sphinxAtStartPar
By default, angles are measured in degrees.
If you prefer radians, then do:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ellps\PYGZus{}2} \PYG{o}{=} \PYG{n}{Ellipsoid}\PYG{p}{(}\PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{e}\PYG{o}{=}\PYG{l+m+mf}{0.8}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{ellps\PYGZus{}2}\PYG{p}{)}
\PYG{g+go}{ellipsoid:}
\PYG{g+go}{    R\PYGZus{}A = 4.322001171188888}
\PYG{g+go}{    a = 5}
\PYG{g+go}{    b = 2.999999999999999}
\PYG{g+go}{    e = 0.8}
\PYG{g+go}{    f = 0.4}
\PYG{g+go}{    lat\PYGZus{}0 = 0}
\PYG{g+go}{    lon\PYGZus{}0 = 0}
\PYG{g+go}{    radians = True}
\PYG{g+go}{    sphere = False}
\end{sphinxVerbatim}

\sphinxAtStartPar
Some common ellipsoids are predefined as constants.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{UNIT\PYGZus{}SPHERE}\PYG{p}{)}
\PYG{g+go}{ellipsoid:}
\PYG{g+go}{    R = 1}
\PYG{g+go}{    R\PYGZus{}A = 1}
\PYG{g+go}{    a = 1}
\PYG{g+go}{    b = 1}
\PYG{g+go}{    e = 0}
\PYG{g+go}{    f = 0}
\PYG{g+go}{    lat\PYGZus{}0 = 0}
\PYG{g+go}{    lon\PYGZus{}0 = 0}
\PYG{g+go}{    radians = False}
\PYG{g+go}{    sphere = True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{WGS84\PYGZus{}ELLIPSOID}\PYG{p}{)}
\PYG{g+go}{ellipsoid:}
\PYG{g+go}{    R\PYGZus{}A = 6371007.180918476}
\PYG{g+go}{    a = 6378137.0}
\PYG{g+go}{    b = 6356752.314245179}
\PYG{g+go}{    e = 0.081819190842621}
\PYG{g+go}{    f = 0.003352810664747}
\PYG{g+go}{    lat\PYGZus{}0 = 0}
\PYG{g+go}{    lon\PYGZus{}0 = 0}
\PYG{g+go}{    radians = False}
\PYG{g+go}{    sphere = False}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{WGS84\PYGZus{}ELLIPSOID\PYGZus{}RADIANS}\PYG{p}{)}
\PYG{g+go}{ellipsoid:}
\PYG{g+go}{    R\PYGZus{}A = 6371007.180918476}
\PYG{g+go}{    a = 6378137.0}
\PYG{g+go}{    b = 6356752.314245179}
\PYG{g+go}{    e = 0.081819190842621}
\PYG{g+go}{    f = 0.003352810664747}
\PYG{g+go}{    lat\PYGZus{}0 = 0}
\PYG{g+go}{    lon\PYGZus{}0 = 0}
\PYG{g+go}{    radians = True}
\PYG{g+go}{    sphere = False}
\end{sphinxVerbatim}

\sphinxAtStartPar
Ellipsoid instances are parametrized by geographic longitude and latitude with the central meridian at \sphinxcode{\sphinxupquote{lon\_0}} and the parallel of origin at \sphinxcode{\sphinxupquote{lat\_0}}.

\sphinxAtStartPar
Project some points of the ellipsoid using the HEALPix and rHEALPix projections:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{numpy}\PYG{n+nn}{.}\PYG{n+nn}{testing}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{assert\PYGZus{}allclose}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{h} \PYG{o}{=} \PYG{n}{Projection}\PYG{p}{(}\PYG{n}{ellps\PYGZus{}1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healpix}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rh} \PYG{o}{=} \PYG{n}{Projection}\PYG{p}{(}\PYG{n}{ellps\PYGZus{}1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rhealpix}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{north\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{south\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{assert\PYGZus{}allclose}\PYG{p}{(}\PYG{n}{h}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{60}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{3.35127855017803}\PYG{p}{)}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}14}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{==} \PYG{k+kc}{None}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{assert\PYGZus{}allclose}\PYG{p}{(}\PYG{n}{rh}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{60}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{3.35127855017803}\PYG{p}{)}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}14}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{==} \PYG{k+kc}{None}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{assert\PYGZus{}allclose}\PYG{p}{(}\PYG{n}{h}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{70}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mf}{0.864006732389895}\PYG{p}{,} \PYG{l+m+mf}{4.258498514443268}\PYG{p}{)}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}14}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{==} \PYG{k+kc}{None}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{assert\PYGZus{}allclose}\PYG{p}{(}\PYG{n}{rh}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{70}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.864006732389895}\PYG{p}{,} \PYG{l+m+mf}{4.258498514443268}\PYG{p}{)}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}14}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{==} \PYG{k+kc}{None}
\PYG{g+go}{True}
\end{sphinxVerbatim}


\subsection{Using the \sphinxstyleliteralintitle{\sphinxupquote{dggs}} Module}
\label{\detokenize{introduction:using-the-dggs-module}}
\sphinxAtStartPar
The module \sphinxcode{\sphinxupquote{dggs}} implements the rHEALPix DGGS and various operations thereupon.

\sphinxAtStartPar
Import all the classes, methods, and constants from the module

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{dggs}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{o}{*}
\end{sphinxVerbatim}

\sphinxAtStartPar
Create the (0, 0)\sphinxhyphen{}rHEALPix DGGS with N\_side=3 that is based upon the WGS84 ellipsoid:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{ellipsoids}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{WGS84\PYGZus{}ELLIPSOID}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{WGS84\PYGZus{}ELLIPSOID}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{n}{ellipsoid}\PYG{o}{=}\PYG{n}{E}\PYG{p}{,} \PYG{n}{north\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{south\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{N\PYGZus{}side}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{p}{)}
\PYG{g+go}{rHEALPix DGGS:}
\PYG{g+go}{    N\PYGZus{}side = 3}
\PYG{g+go}{    north\PYGZus{}square = 0}
\PYG{g+go}{    south\PYGZus{}square = 0}
\PYG{g+go}{    max\PYGZus{}areal\PYGZus{}resolution = 1}
\PYG{g+go}{    max\PYGZus{}resolution = 15}
\PYG{g+go}{    ellipsoid:}
\PYG{g+go}{        R\PYGZus{}A = 6371007.180918476}
\PYG{g+go}{        a = 6378137.0}
\PYG{g+go}{        b = 6356752.314245179}
\PYG{g+go}{        e = 0.08181919084262149}
\PYG{g+go}{        f = 0.0033528106647474805}
\PYG{g+go}{        lat\PYGZus{}0 = 0}
\PYG{g+go}{        lon\PYGZus{}0 = 0}
\PYG{g+go}{        radians = False}
\PYG{g+go}{        sphere = False}
\end{sphinxVerbatim}

\sphinxAtStartPar
Some common rHEALPix DGGSs are predefined as constants:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{UNIT\PYGZus{}003}\PYG{p}{)}
\PYG{g+go}{rHEALPix DGGS:}
\PYG{g+go}{    N\PYGZus{}side = 3}
\PYG{g+go}{    north\PYGZus{}square = 0}
\PYG{g+go}{    south\PYGZus{}square = 0}
\PYG{g+go}{    max\PYGZus{}areal\PYGZus{}resolution = 1}
\PYG{g+go}{    max\PYGZus{}resolution = 1}
\PYG{g+go}{    ellipsoid:}
\PYG{g+go}{        R = 1}
\PYG{g+go}{        R\PYGZus{}A = 1}
\PYG{g+go}{        a = 1}
\PYG{g+go}{        b = 1}
\PYG{g+go}{        e = 0}
\PYG{g+go}{        f = 0}
\PYG{g+go}{        lat\PYGZus{}0 = 0}
\PYG{g+go}{        lon\PYGZus{}0 = 0}
\PYG{g+go}{        radians = False}
\PYG{g+go}{        sphere = True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{WGS84\PYGZus{}003}\PYG{p}{)}
\PYG{g+go}{rHEALPix DGGS:}
\PYG{g+go}{    N\PYGZus{}side = 3}
\PYG{g+go}{    north\PYGZus{}square = 0}
\PYG{g+go}{    south\PYGZus{}square = 0}
\PYG{g+go}{    max\PYGZus{}areal\PYGZus{}resolution = 1}
\PYG{g+go}{    max\PYGZus{}resolution = 15}
\PYG{g+go}{    ellipsoid:}
\PYG{g+go}{        R\PYGZus{}A = 6371007.180918476}
\PYG{g+go}{        a = 6378137.0}
\PYG{g+go}{        b = 6356752.314245179}
\PYG{g+go}{        e = 0.08181919084262149}
\PYG{g+go}{        f = 0.0033528106647474805}
\PYG{g+go}{        lat\PYGZus{}0 = 0}
\PYG{g+go}{        lon\PYGZus{}0 = 0}
\PYG{g+go}{        radians = False}
\PYG{g+go}{        sphere = False}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{UNIT\PYGZus{}003\PYGZus{}RADIANS}\PYG{p}{)}
\PYG{g+go}{rHEALPix DGGS:}
\PYG{g+go}{    N\PYGZus{}side = 3}
\PYG{g+go}{    north\PYGZus{}square = 0}
\PYG{g+go}{    south\PYGZus{}square = 0}
\PYG{g+go}{    max\PYGZus{}areal\PYGZus{}resolution = 1}
\PYG{g+go}{    max\PYGZus{}resolution = 1}
\PYG{g+go}{    ellipsoid:}
\PYG{g+go}{        R = 1}
\PYG{g+go}{        R\PYGZus{}A = 1}
\PYG{g+go}{        a = 1}
\PYG{g+go}{        b = 1}
\PYG{g+go}{        e = 0}
\PYG{g+go}{        f = 0}
\PYG{g+go}{        lat\PYGZus{}0 = 0}
\PYG{g+go}{        lon\PYGZus{}0 = 0}
\PYG{g+go}{        radians = True}
\PYG{g+go}{        sphere = True}
\end{sphinxVerbatim}

\sphinxAtStartPar
Pick a (longitude\sphinxhyphen{}latitude) point on the ellipsoid and find the level 1 cell that contains it

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}from\PYGZus{}point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{p}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{;} \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)}
\PYG{g+go}{Q0}
\end{sphinxVerbatim}

\sphinxAtStartPar
Find the ellipsoidal (edge) neighbors of this cell

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)} \PYG{o+ow}{in} \PYG{n+nb}{sorted}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{neighbors}\PYG{p}{(}\PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)}
\PYG{g+go}{east Q1}
\PYG{g+go}{north N2}
\PYG{g+go}{south Q3}
\PYG{g+go}{west P2}
\end{sphinxVerbatim}

\sphinxAtStartPar
Find the planar (edge) neighbors of this cell

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)} \PYG{o+ow}{in} \PYG{n+nb}{sorted}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{neighbors}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{plane}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)}
\PYG{g+go}{down Q3}
\PYG{g+go}{left P2}
\PYG{g+go}{right Q1}
\PYG{g+go}{up N2}
\end{sphinxVerbatim}

\sphinxAtStartPar
Find all the level 1 cells intersecting the longitude\sphinxhyphen{}latitude aligned ellipsoidal quadrangle with given northwest and southeast corners

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{nw} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{45}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{se} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cells} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}region}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{nw}\PYG{p}{,} \PYG{n}{se}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{cells}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{row}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N2\PYGZsq{}, \PYGZsq{}N1\PYGZsq{}, \PYGZsq{}N0\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}Q0\PYGZsq{}, \PYGZsq{}Q1\PYGZsq{}, \PYGZsq{}Q2\PYGZsq{}, \PYGZsq{}R0\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}Q3\PYGZsq{}, \PYGZsq{}Q4\PYGZsq{}, \PYGZsq{}Q5\PYGZsq{}, \PYGZsq{}R3\PYGZsq{}]}
\end{sphinxVerbatim}

\sphinxAtStartPar
Compute the ellipsoidal shape and ellipsoidal nuclei of these cells

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{expected\PYGZus{}results} \PYG{o}{=} \PYG{p}{[}
\PYG{g+gp}{... }   \PYG{p}{[}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{58.52801748206219}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{44.999999999999964}\PYG{p}{,} \PYG{l+m+mf}{58.52801748206219}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{90.0}\PYG{p}{,} \PYG{l+m+mf}{58.52801748206219}\PYG{p}{)}
\PYG{g+gp}{... }   \PYG{p}{]}\PYG{p}{,} \PYG{p}{[}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{14.999999999999998}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{45.0}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{74.99999999999999}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{105.00000000000001}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}
\PYG{g+gp}{... }   \PYG{p}{]}\PYG{p}{,} \PYG{p}{[}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{14.999999999999998}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{45.0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{74.99999999999999}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{105.00000000000001}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{... }   \PYG{p}{]}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{k}{for} \PYG{n}{j}\PYG{p}{,} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{row}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{,} \PYG{n}{cell}\PYG{o}{.}\PYG{n}{ellipsoidal\PYGZus{}shape}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{assert\PYGZus{}allclose}\PYG{p}{(}\PYG{n}{cell}\PYG{o}{.}\PYG{n}{nucleus}\PYG{p}{(}\PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{,} \PYG{n}{expected\PYGZus{}results}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}15}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{==} \PYG{k+kc}{None}\PYG{p}{)}
\PYG{g+go}{N2 dart True}
\PYG{g+go}{N1 skew\PYGZus{}quad True}
\PYG{g+go}{N0 dart True}
\PYG{g+go}{Q0 quad True}
\PYG{g+go}{Q1 quad True}
\PYG{g+go}{Q2 quad True}
\PYG{g+go}{R0 quad True}
\PYG{g+go}{Q3 quad True}
\PYG{g+go}{Q4 quad True}
\PYG{g+go}{Q5 quad True}
\PYG{g+go}{R3 quad True}
\end{sphinxVerbatim}

\sphinxAtStartPar
Create the (0, 0)\sphinxhyphen{}rHEALPix DGGS with N\_side = 3 that is based on the WGS84 ellipsoid.
Orient the DGGS so that the planar origin (0, 0) is on Auckland, New Zealand:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{174}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{37}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Approximate Auckland lon\PYGZhy{}lat coordinates}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{projection\PYGZus{}wrapper}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{Ellipsoid}\PYG{p}{(}\PYG{n}{a}\PYG{o}{=}\PYG{n}{WGS84\PYGZus{}A}\PYG{p}{,} \PYG{n}{f}\PYG{o}{=}\PYG{n}{WGS84\PYGZus{}F}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{lon\PYGZus{}0}\PYG{o}{=}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{lat\PYGZus{}0}\PYG{o}{=}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{n}{E}\PYG{p}{,} \PYG{n}{N\PYGZus{}side}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{north\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{south\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{p}{)}
\PYG{g+go}{rHEALPix DGGS:}
\PYG{g+go}{    N\PYGZus{}side = 3}
\PYG{g+go}{    north\PYGZus{}square = 0}
\PYG{g+go}{    south\PYGZus{}square = 0}
\PYG{g+go}{    max\PYGZus{}areal\PYGZus{}resolution = 1}
\PYG{g+go}{    max\PYGZus{}resolution = 15}
\PYG{g+go}{    ellipsoid:}
\PYG{g+go}{        R\PYGZus{}A = 6371007.180918476}
\PYG{g+go}{        a = 6378137.0}
\PYG{g+go}{        b = 6356752.314245179}
\PYG{g+go}{        e = 0.08181919084262149}
\PYG{g+go}{        f = 0.0033528106647474805}
\PYG{g+go}{        lat\PYGZus{}0 = \PYGZhy{}37}
\PYG{g+go}{        lon\PYGZus{}0 = 174}
\PYG{g+go}{        radians = False}
\PYG{g+go}{        sphere = False}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}from\PYGZus{}point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{p}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{Q3}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{The utils Module}
\label{\detokenize{utils:module-rhealpixdggs.utils}}\label{\detokenize{utils:the-utils-module}}\label{\detokenize{utils::doc}}\index{module@\spxentry{module}!rhealpixdggs.utils@\spxentry{rhealpixdggs.utils}}\index{rhealpixdggs.utils@\spxentry{rhealpixdggs.utils}!module@\spxentry{module}}
\sphinxAtStartPar
This Python 3.11 module implements several helper functions for coding map projections.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Alexander Raichev (AR), 2012\sphinxhyphen{}01\sphinxhyphen{}26: Refactored code from release 0.3.

\end{itemize}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
All lengths are measured in meters and all angles are measured in radians
unless indicated otherwise.
\index{auth\_lat() (in module rhealpixdggs.utils)@\spxentry{auth\_lat()}\spxextra{in module rhealpixdggs.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils:rhealpixdggs.utils.auth_lat}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.utils.}}\sphinxbfcode{\sphinxupquote{auth\_lat}}}
{\sphinxparam{\DUrole{n}{phi}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{radians}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}}
{{ $\rightarrow$ float}}
\pysigstopsignatures
\sphinxAtStartPar
Given a point of geographic latitude \sphinxtitleref{phi} on an ellipse of
eccentricity \sphinxtitleref{e}, return the authalic latitude of the point.
If \sphinxtitleref{inverse} =True, then compute its inverse approximately.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{beta} \PYG{o}{=} \PYG{n}{auth\PYGZus{}lat}\PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mf}{0.08181919104281579}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{beta}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{1.045256493205824}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{auth\PYGZus{}lat}\PYG{p}{(}\PYG{n}{beta}\PYG{p}{,} \PYG{l+m+mf}{0.08181919104281579}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{1.047197551196598}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{1.047197551196598}
\end{sphinxVerbatim}

\sphinxAtStartPar
NOTES:

\sphinxAtStartPar
For small flattenings f (f \textless{} 1/150), when calculating
authalic from common latitude, power series approximation
(from \sphinxurl{https://doi.org/10.48550/arXiv.2212.05818}) gives
more accurate results than direct formula (for
double\sphinxhyphen{}precission accuracy). For the inverse, again power
series approximation is used, which is standard in
cartography for small flattenings. The one used in this
case is from \sphinxurl{https://doi.org/10.48550/arXiv.2212.05818}

\end{fulllineitems}

\index{auth\_rad() (in module rhealpixdggs.utils)@\spxentry{auth\_rad()}\spxextra{in module rhealpixdggs.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils:rhealpixdggs.utils.auth_rad}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.utils.}}\sphinxbfcode{\sphinxupquote{auth\_rad}}}
{\sphinxparam{\DUrole{n}{a}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}}
{{ $\rightarrow$ float}}
\pysigstopsignatures
\sphinxAtStartPar
Return the radius of the authalic sphere of the ellipsoid with major
radius \sphinxtitleref{a} and eccentricity \sphinxtitleref{e}.
If \sphinxtitleref{inverse} = True, then return the major radius of the ellipsoid
with authalic radius \sphinxtitleref{a} and eccentricity \sphinxtitleref{e}.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{auth\PYGZus{}rad}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+go}{1}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{11}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n}{e} \PYG{o}{=} \PYG{l+m+mf}{1.0}\PYG{o}{/}\PYG{n}{i}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{p}{(}\PYG{n}{e}\PYG{p}{,} \PYG{n}{auth\PYGZus{}rad}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{1.0}\PYG{o}{/}\PYG{n}{i}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.25, 0.989393259670095)}
\PYG{g+go}{(0.111111111111111, 0.997935147429943)}
\PYG{g+go}{(0.0625, 0.999348236455825)}
\PYG{g+go}{(0.04, 0.99973321235361)}
\PYG{g+go}{(0.027777777777778, 0.99987137105188)}
\PYG{g+go}{(0.020408163265306, 0.999930576285614)}
\PYG{g+go}{(0.015625, 0.999959307080847)}
\PYG{g+go}{(0.012345679012346, 0.999974596271211)}
\PYG{g+go}{(0.01, 0.999983332861089)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{my\_round() (in module rhealpixdggs.utils)@\spxentry{my\_round()}\spxextra{in module rhealpixdggs.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils:rhealpixdggs.utils.my_round}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.utils.}}\sphinxbfcode{\sphinxupquote{my\_round}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{Any}}\sphinxparamcomma \sphinxparam{\DUrole{n}{digits}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}}
{{ $\rightarrow$ Any}}
\pysigstopsignatures
\sphinxAtStartPar
Round the floating point number or list/tuple of floating point
numbers to \sphinxcode{\sphinxupquote{digits}} number of digits.
Calls Python’s \sphinxcode{\sphinxupquote{round()}} function.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{0.142857}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.333333, 0.142857)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{wrap\_latitude() (in module rhealpixdggs.utils)@\spxentry{wrap\_latitude()}\spxextra{in module rhealpixdggs.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils:rhealpixdggs.utils.wrap_latitude}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.utils.}}\sphinxbfcode{\sphinxupquote{wrap\_latitude}}}
{\sphinxparam{\DUrole{n}{phi}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{radians}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}}
{{ $\rightarrow$ float}}
\pysigstopsignatures
\sphinxAtStartPar
Given a point p on the unit circle at angle \sphinxtitleref{phi} from the positive x\sphinxhyphen{}axis,
if p lies in the right half of the circle, then return its angle that lies
in the interval {[}\sphinxhyphen{}pi/2, pi/2{]}.
If p lies in the left half of the circle, then reflect it through the
origin, and return the angle of the reflected point that lies in the
interval {[}\sphinxhyphen{}pi/2, pi/2{]}.
If \sphinxtitleref{radians} = True, then \sphinxtitleref{phi} and the output are given in radians.
Otherwise, they are given in degrees.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{wrap\PYGZus{}latitude}\PYG{p}{(}\PYG{l+m+mf}{45.0}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+go}{45.0}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{wrap\PYGZus{}latitude}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{45.0}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+go}{\PYGZhy{}45.0}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{wrap\PYGZus{}latitude}\PYG{p}{(}\PYG{l+m+mf}{90.0}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+go}{90.0}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{wrap\PYGZus{}latitude}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{90.0}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+go}{\PYGZhy{}90.0}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{wrap\PYGZus{}latitude}\PYG{p}{(}\PYG{l+m+mf}{135.0}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+go}{\PYGZhy{}45.0}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{wrap\PYGZus{}latitude}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{135.0}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+go}{45.0}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{wrap\_longitude() (in module rhealpixdggs.utils)@\spxentry{wrap\_longitude()}\spxextra{in module rhealpixdggs.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils:rhealpixdggs.utils.wrap_longitude}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.utils.}}\sphinxbfcode{\sphinxupquote{wrap\_longitude}}}
{\sphinxparam{\DUrole{n}{lam}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{radians}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}}
{{ $\rightarrow$ float}}
\pysigstopsignatures
\sphinxAtStartPar
Given a point p on the unit circle at angle \sphinxtitleref{lam} from the positive
x\sphinxhyphen{}axis, return its angle theta in the range \sphinxhyphen{}pi \textless{}= theta \textless{} pi.
If \sphinxtitleref{radians} = True, then \sphinxtitleref{lam} and the output are given in radians.
Otherwise, they are given in degrees.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{wrap\PYGZus{}longitude}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{pi}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{\PYGZhy{}3.141592653589793}
\end{sphinxVerbatim}

\end{fulllineitems}


\sphinxstepscope


\chapter{The pj\_healpix Module}
\label{\detokenize{pj_healpix:module-rhealpixdggs.pj_healpix}}\label{\detokenize{pj_healpix:the-pj-healpix-module}}\label{\detokenize{pj_healpix::doc}}\index{module@\spxentry{module}!rhealpixdggs.pj\_healpix@\spxentry{rhealpixdggs.pj\_healpix}}\index{rhealpixdggs.pj\_healpix@\spxentry{rhealpixdggs.pj\_healpix}!module@\spxentry{module}}
\sphinxAtStartPar
This Python 3.11 module implements the HEALPix map projection as described in \sphinxcite{pj_healpix:caro2007}.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Alexander Raichev (AR), 2013\sphinxhyphen{}01\sphinxhyphen{}26: Refactored code from release 0.3.

\end{itemize}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
All lengths are measured in meters and all angles are measured in radians
unless indicated otherwise.
By ‘ellipsoid’ below, I mean an oblate ellipsoid of revolution.
\index{healpix() (in module rhealpixdggs.pj\_healpix)@\spxentry{healpix()}\spxextra{in module rhealpixdggs.pj\_healpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_healpix:rhealpixdggs.pj_healpix.healpix}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_healpix.}}\sphinxbfcode{\sphinxupquote{healpix}}}
{\sphinxparam{\DUrole{n}{a}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}}
{{ $\rightarrow$ Callable\DUrole{p}{{[}}\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{,}\DUrole{w}{ }bool\DUrole{p}{,}\DUrole{w}{ }bool\DUrole{p}{{]}}\DUrole{p}{,}\DUrole{w}{ }tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Return a function object that wraps the HEALPix projection and its inverse
of an ellipsoid with major radius \sphinxtitleref{a} and eccentricity \sphinxtitleref{e}.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{f} \PYG{o}{=} \PYG{n}{healpix}\PYG{p}{(}\PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{e}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{f}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.574951359778215, 2.145747686573111)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{60}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{q} \PYG{o}{=} \PYG{n}{f}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{;} \PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{q}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.574951359778215, 2.145747686573111)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{f}\PYG{p}{(}\PYG{o}{*}\PYG{n}{q}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(6e\PYGZhy{}15, 59.999999999999986)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 60)}
\end{sphinxVerbatim}

\sphinxAtStartPar
OUTPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
A function object of the form f(u, v, radians=False, inverse=False).

\end{itemize}

\end{fulllineitems}

\index{healpix\_ellipsoid() (in module rhealpixdggs.pj\_healpix)@\spxentry{healpix\_ellipsoid()}\spxextra{in module rhealpixdggs.pj\_healpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_healpix:rhealpixdggs.pj_healpix.healpix_ellipsoid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_healpix.}}\sphinxbfcode{\sphinxupquote{healpix\_ellipsoid}}}
{\sphinxparam{\DUrole{n}{lam}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the signature functions of the HEALPix projection of an oblate
ellipsoid with eccentricity \sphinxtitleref{e} whose authalic sphere is the unit sphere.
Works when \sphinxtitleref{e} = 0 (spherical case) too.

\sphinxAtStartPar
INPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{lam, phi} \sphinxhyphen{} Geodetic longitude\sphinxhyphen{}latitude coordinates in radians.
Assume \sphinxhyphen{}pi \textless{}= \sphinxtitleref{lam} \textless{} pi and \sphinxhyphen{}pi/2 \textless{}= \sphinxtitleref{phi} \textless{}= pi/2.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{e} \sphinxhyphen{} Eccentricity of the oblate ellipsoid.

\end{itemize}

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x} \PYG{k}{if} \PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o+ow}{is} \PYG{n+nb}{int} \PYG{k}{else} \PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{healpix\PYGZus{}ellipsoid}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 0.511157237746422)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x} \PYG{k}{if} \PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o+ow}{is} \PYG{n+nb}{int} \PYG{k}{else} \PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{healpix\PYGZus{}ellipsoid}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{,} \PYG{n}{e}\PYG{o}{=}\PYG{l+m+mf}{0.8}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 0.268484450857837)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{healpix\_ellipsoid\_inverse() (in module rhealpixdggs.pj\_healpix)@\spxentry{healpix\_ellipsoid\_inverse()}\spxextra{in module rhealpixdggs.pj\_healpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_healpix:rhealpixdggs.pj_healpix.healpix_ellipsoid_inverse}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_healpix.}}\sphinxbfcode{\sphinxupquote{healpix\_ellipsoid\_inverse}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the inverse of healpix\_ellipsoid().

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{q} \PYG{o}{=} \PYG{n}{healpix\PYGZus{}ellipsoid}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x} \PYG{k}{if} \PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o+ow}{is} \PYG{n+nb}{int} \PYG{k}{else} \PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{healpix\PYGZus{}ellipsoid\PYGZus{}inverse}\PYG{p}{(}\PYG{o}{*}\PYG{n}{q}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 0.448798950512828)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 0.448798950512828)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{healpix\_sphere() (in module rhealpixdggs.pj\_healpix)@\spxentry{healpix\_sphere()}\spxextra{in module rhealpixdggs.pj\_healpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_healpix:rhealpixdggs.pj_healpix.healpix_sphere}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_healpix.}}\sphinxbfcode{\sphinxupquote{healpix\_sphere}}}
{\sphinxparam{\DUrole{n}{lam}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the signature function of the HEALPix
projection of the unit sphere.

\sphinxAtStartPar
INPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{lam, phi} \sphinxhyphen{} Geodetic longitude\sphinxhyphen{}latitude coordinates in radians.
Assume \sphinxhyphen{}pi \textless{}= \sphinxtitleref{lam} \textless{} pi and \sphinxhyphen{}pi/2 \textless{}= \sphinxtitleref{phi} \textless{}= pi/2.

\end{itemize}

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{healpix\PYGZus{}sphere}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{arcsin}\PYG{p}{(}\PYG{l+m+mf}{2.0}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)} \PYG{o}{==} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{True}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{healpix\_sphere\_inverse() (in module rhealpixdggs.pj\_healpix)@\spxentry{healpix\_sphere\_inverse()}\spxextra{in module rhealpixdggs.pj\_healpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_healpix:rhealpixdggs.pj_healpix.healpix_sphere_inverse}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_healpix.}}\sphinxbfcode{\sphinxupquote{healpix\_sphere\_inverse}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the inverse of the healpix\_sphere().

\sphinxAtStartPar
INPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{x, y} \sphinxhyphen{} Planar coordinates in meters in the image of the
HEALPix projection of the unit sphere.

\end{itemize}

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{healpix\PYGZus{}sphere\PYGZus{}inverse}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)} \PYG{o}{==} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{arcsin}\PYG{p}{(}\PYG{l+m+mf}{2.0}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{True}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{healpix\_vertices() (in module rhealpixdggs.pj\_healpix)@\spxentry{healpix\_vertices()}\spxextra{in module rhealpixdggs.pj\_healpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_healpix:rhealpixdggs.pj_healpix.healpix_vertices}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_healpix.}}\sphinxbfcode{\sphinxupquote{healpix\_vertices}}}
{}
{{ $\rightarrow$ list\DUrole{p}{{[}}tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of the planar vertices of the HEALPix projection of
the unit sphere.

\end{fulllineitems}

\index{in\_healpix\_image() (in module rhealpixdggs.pj\_healpix)@\spxentry{in\_healpix\_image()}\spxextra{in module rhealpixdggs.pj\_healpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_healpix:rhealpixdggs.pj_healpix.in_healpix_image}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_healpix.}}\sphinxbfcode{\sphinxupquote{in\_healpix\_image}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}}
{{ $\rightarrow$ bool}}
\pysigstopsignatures
\sphinxAtStartPar
Return True if and only if \sphinxtitleref{(x, y)} lies in the image of the HEALPix
projection of the unit sphere.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{eps} \PYG{o}{=} \PYG{l+m+mi}{0}     \PYG{c+c1}{\PYGZsh{} Test boundary points.}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{hp} \PYG{o}{=} \PYG{p}{[}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{g+gp}{... }\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{p} \PYG{o+ow}{in} \PYG{n}{hp}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{in\PYGZus{}healpix\PYGZus{}image}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fail}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{...}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{in\PYGZus{}healpix\PYGZus{}image}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{in\PYGZus{}healpix\PYGZus{}image}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{l+m+mf}{0.1}\PYG{p}{)}
\PYG{g+go}{False}
\end{sphinxVerbatim}

\end{fulllineitems}


\sphinxstepscope


\chapter{The pj\_rhealpix Module}
\label{\detokenize{pj_rhealpix:module-rhealpixdggs.pj_rhealpix}}\label{\detokenize{pj_rhealpix:the-pj-rhealpix-module}}\label{\detokenize{pj_rhealpix::doc}}\index{module@\spxentry{module}!rhealpixdggs.pj\_rhealpix@\spxentry{rhealpixdggs.pj\_rhealpix}}\index{rhealpixdggs.pj\_rhealpix@\spxentry{rhealpixdggs.pj\_rhealpix}!module@\spxentry{module}}
\sphinxAtStartPar
This Python 3.11 module implements the rHEALPix map projection.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Alexander Raichev (AR), 2013\sphinxhyphen{}01\sphinxhyphen{}26: Refactored code from release 0.3.

\end{itemize}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
All lengths are measured in meters and all angles are measured in radians
unless indicated otherwise.
By ‘ellipsoid’ below, I mean an oblate ellipsoid of revolution.
\index{combine\_triangles() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{combine\_triangles()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.combine_triangles}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{combine\_triangles}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Rearrange point \sphinxtitleref{(x, y)} in the HEALPix projection by
combining the polar triangles into two polar squares.
Put the north polar square in position \sphinxtitleref{north\_square} and
the south polar square in position \sphinxtitleref{south\_square}.
If \sphinxtitleref{inverse} = True, uncombine the polar triangles.

\sphinxAtStartPar
INPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{x, y} \sphinxhyphen{} Coordinates in the HEALPix projection of the unit sphere.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{north\_square, south\_square} \sphinxhyphen{} Integers between 0 and 3 indicating
the positions of the north\_square polar square and south\_square polar
square respectively.
See rhealpix\_sphere() docstring for a diagram.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{inverse} \sphinxhyphen{} (Optional; default = False) Boolean. If False, then compute
forward function. If True, then compute inverse function.

\end{itemize}

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u}\PYG{p}{,} \PYG{n}{v} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{x}\PYG{p}{,} \PYG{n}{y} \PYG{o}{=} \PYG{n}{combine\PYGZus{}triangles}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}1.832595714594046, 1.570796326794896)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{combine\PYGZus{}triangles}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}0.785398163397448, 1.047197551196598)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}0.785398163397448, 1.047197551196598)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{in\_rhealpix\_image() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{in\_rhealpix\_image()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.in_rhealpix_image}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{in\_rhealpix\_image}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}}
{{ $\rightarrow$ bool}}
\pysigstopsignatures
\sphinxAtStartPar
Return True if and only if the point \sphinxtitleref{(x, y)} lies in the image of
the rHEALPix projection of the unit sphere.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{eps} \PYG{o}{=} \PYG{l+m+mi}{0}     \PYG{c+c1}{\PYGZsh{} Test boundary points.}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{north\PYGZus{}square}\PYG{p}{,} \PYG{n}{south\PYGZus{}square} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rhp} \PYG{o}{=} \PYG{p}{[}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{north\PYGZus{}square}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{north\PYGZus{}square}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{p}{(}\PYG{n}{north\PYGZus{}square} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{p}{(}\PYG{n}{north\PYGZus{}square} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{p}{(}\PYG{n}{south\PYGZus{}square} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{p}{(}\PYG{n}{south\PYGZus{}square} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{south\PYGZus{}square}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{+} \PYG{n}{south\PYGZus{}square}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}}\PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{\PYGZhy{}} \PYG{n}{eps}\PYG{p}{)}
\PYG{g+gp}{... }\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{p} \PYG{o+ow}{in} \PYG{n}{rhp}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{in\PYGZus{}rhealpix\PYGZus{}image}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fail}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{...}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{in\PYGZus{}rhealpix\PYGZus{}image}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{in\PYGZus{}rhealpix\PYGZus{}image}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{l+m+mf}{0.1}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{False}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rhealpix() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{rhealpix()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.rhealpix}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{rhealpix}}}
{\sphinxparam{\DUrole{n}{a}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{region}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}none\textquotesingle{}}}}
{{ $\rightarrow$ Callable\DUrole{p}{{[}}\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{,}\DUrole{w}{ }bool\DUrole{p}{,}\DUrole{w}{ }bool\DUrole{p}{{]}}\DUrole{p}{,}\DUrole{w}{ }tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Return a function object that wraps the rHEALPix projection and its inverse
of an ellipsoid with major radius \sphinxtitleref{a} and eccentricity \sphinxtitleref{e}.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{f} \PYG{o}{=} \PYG{n}{rhealpix}\PYG{p}{(}\PYG{n}{a}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{e}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{north\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{south\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{f}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}0.574951359778215, 2.145747686573111)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{60}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{q} \PYG{o}{=} \PYG{n}{f}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{q}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}0.574951359778215, 2.145747686573111)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{f}\PYG{p}{(}\PYG{o}{*}\PYG{n}{q}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(6e\PYGZhy{}15, 59.999999999999986)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 60)}
\end{sphinxVerbatim}

\sphinxAtStartPar
OUTPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
A function object of the form f(u, v, radians=False, inverse=False).

\end{itemize}

\end{fulllineitems}

\index{rhealpix\_ellipsoid() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{rhealpix\_ellipsoid()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.rhealpix_ellipsoid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{rhealpix\_ellipsoid}}}
{\sphinxparam{\DUrole{n}{lam}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{region}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}none\textquotesingle{}}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the signature functions of the rHEALPix map
projection of an oblate ellipsoid with eccentricity \sphinxtitleref{e} whose
authalic sphere is the unit sphere.
The north polar square is put in position \sphinxtitleref{north\_square},
and the south polar square is put in position \sphinxtitleref{south\_square}.
Works when \sphinxtitleref{e} = 0 (spherical case) too.

\sphinxAtStartPar
INPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{lam, phi} \sphinxhyphen{} Geographic longitude\sphinxhyphen{}latitude coordinates in radian.
Assume \sphinxhyphen{}pi \textless{}= \sphinxtitleref{lam} \textless{} pi and \sphinxhyphen{}pi/2 \textless{}= \sphinxtitleref{phi} \textless{}= pi/2.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{e} \sphinxhyphen{} Eccentricity of the ellipsoid.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{north\_square, south\_square} \sphinxhyphen{} (Optional; defaults = 0, 0) Integers
between 0 and 3 indicating positions of north polar and
south polar squares, respectively.
See rhealpix\_sphere() docstring for a diagram.

\end{itemize}

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{numpy}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{arcsin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x} \PYG{k}{if} \PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o+ow}{is} \PYG{n+nb}{int} \PYG{k}{else} \PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rhealpix\PYGZus{}ellipsoid}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{arcsin}\PYG{p}{(}\PYG{l+m+mf}{2.0}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 0.785398163397448)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rhealpix\_ellipsoid\_inverse() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{rhealpix\_ellipsoid\_inverse()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.rhealpix_ellipsoid_inverse}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{rhealpix\_ellipsoid\_inverse}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{region}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}none\textquotesingle{}}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the inverse of rhealpix\_ellipsoid().

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{q} \PYG{o}{=} \PYG{n}{rhealpix\PYGZus{}ellipsoid}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rhealpix\PYGZus{}ellipsoid\PYGZus{}inverse}\PYG{p}{(}\PYG{o}{*}\PYG{n}{q}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.0, 0.785398163397448)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 0.785398163397448)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rhealpix\_sphere() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{rhealpix\_sphere()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.rhealpix_sphere}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{rhealpix\_sphere}}}
{\sphinxparam{\DUrole{n}{lam}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{region}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}none\textquotesingle{}}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the signature functions of the rHEALPix map projection of
the unit sphere.
The north polar square is put in position \sphinxtitleref{north\_square}, and the
south polar square is put in position \sphinxtitleref{south\_square}.

\sphinxAtStartPar
INPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{lam, phi} \sphinxhyphen{}Geographic longitude\sphinxhyphen{}latitude coordinates in radians.
Assume \sphinxhyphen{}pi \textless{}= \sphinxtitleref{lam} \textless{} pi and \sphinxhyphen{}pi/2 \textless{}= \sphinxtitleref{phi} \textless{}= pi/2.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{north\_square, south\_square} \sphinxhyphen{} (Optional; defaults = 0, 0) Integers
between 0 and 3 indicating positions of north polar and
south polar squares, respectively.

\end{itemize}

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rhealpix\PYGZus{}sphere}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}1.619978633413937, 2.307012183573304)}
\end{sphinxVerbatim}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
The polar squares are labeled 0, 1, 2, 3 from east to west like this:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{east}         \PYG{n}{west}
\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
\PYG{o}{|} \PYG{l+m+mi}{0} \PYG{o}{|} \PYG{l+m+mi}{1} \PYG{o}{|} \PYG{l+m+mi}{2} \PYG{o}{|} \PYG{l+m+mi}{3} \PYG{o}{|}
\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
\PYG{o}{|}   \PYG{o}{|}   \PYG{o}{|}   \PYG{o}{|}   \PYG{o}{|}
\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
\PYG{o}{|} \PYG{l+m+mi}{0} \PYG{o}{|} \PYG{l+m+mi}{1} \PYG{o}{|} \PYG{l+m+mi}{2} \PYG{o}{|} \PYG{l+m+mi}{3} \PYG{o}{|}
\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rhealpix\_sphere\_inverse() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{rhealpix\_sphere\_inverse()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.rhealpix_sphere_inverse}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{rhealpix\_sphere\_inverse}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{region}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}none\textquotesingle{}}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Compute the inverse of rhealpix\_sphere().

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{q} \PYG{o}{=} \PYG{n}{rhealpix\PYGZus{}sphere}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rhealpix\PYGZus{}sphere\PYGZus{}inverse}\PYG{p}{(}\PYG{o}{*}\PYG{n}{q}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.0, 0.785398163397448)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, 0.785398163397448)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rhealpix\_vertices() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{rhealpix\_vertices()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.rhealpix_vertices}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{rhealpix\_vertices}}}
{\sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}}
{{ $\rightarrow$ list\DUrole{p}{{[}}tuple\DUrole{p}{{[}}float\DUrole{p}{,}\DUrole{w}{ }float\DUrole{p}{{]}}\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of the planar vertices of the rHEALPix projection of
the unit sphere.

\end{fulllineitems}

\index{triangle() (in module rhealpixdggs.pj\_rhealpix)@\spxentry{triangle()}\spxextra{in module rhealpixdggs.pj\_rhealpix}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{pj_rhealpix:rhealpixdggs.pj_rhealpix.triangle}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{rhealpixdggs.pj\_rhealpix.}}\sphinxbfcode{\sphinxupquote{triangle}}}
{\sphinxparam{\DUrole{n}{x}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}}
{{ $\rightarrow$ tuple\DUrole{p}{{[}}int\DUrole{p}{,}\DUrole{w}{ }str\DUrole{p}{{]}}}}
\pysigstopsignatures
\sphinxAtStartPar
Return the number of the polar triangle and region that \sphinxtitleref{(x, y)} lies in.
If \sphinxtitleref{inverse} = False, then assume \sphinxtitleref{(x,y)} lies in the image of the HEALPix
projection of the unit sphere.
If \sphinxtitleref{inverse} = True, then assume \sphinxtitleref{(x,y)} lies in the image of the
\sphinxtitleref{(north\_square, south\_square)}\sphinxhyphen{}rHEALPix projection of the unit sphere.

\sphinxAtStartPar
INPUT:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{x, y} \sphinxhyphen{} Coordinates in the HEALPix or rHEALPix (if \sphinxtitleref{inverse} = True)
projection of the unit sphere.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{north\_square, south\_square} \sphinxhyphen{} Integers between 0 and 3 indicating the
positions of the north\_square pole square and south\_square pole square
respectively.
See rhealpix\_sphere() docstring for a diagram.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{inverse} \sphinxhyphen{} (Optional; default = False) Boolean. If False, then compute
forward function. If True, then compute inverse function.

\end{itemize}

\sphinxAtStartPar
OUTPUT:

\sphinxAtStartPar
The pair (triangle\_number, region).
Here region equals ‘north\_polar’ (polar), ‘south\_polar’ (polar), or
‘equatorial’, indicating where \sphinxtitleref{(x, y)} lies.
If region = ‘equatorial’, then triangle\_number = None.
Suppose now that region != ‘equatorial’.
If \sphinxtitleref{inverse} = False, then triangle\_number is the number (0, 1, 2, or 3) of
the HEALPix polar triangle Z that \sphinxtitleref{(x, y)} lies in.
If \sphinxtitleref{inverse} = True, then triangle\_number is the number (0, 1, 2, or 3) of
the HEALPix polar triangle that \sphinxtitleref{(x, y)} will get moved into.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{triangle}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{l+m+mf}{0.1}\PYG{p}{)}
\PYG{g+go}{(1, \PYGZsq{}north\PYGZus{}polar\PYGZsq{})}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{triangle}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4} \PYG{o}{+} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{(1, \PYGZsq{}north\PYGZus{}polar\PYGZsq{})}
\end{sphinxVerbatim}

\sphinxAtStartPar
NOTES:

\sphinxAtStartPar
In the HEALPix projection, the polar triangles are labeled 0\textendash{}3 from
east to west like this:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    \PYG{o}{*}       \PYG{o}{*}       \PYG{o}{*}       \PYG{o}{*}
  \PYG{o}{*} \PYG{l+m+mi}{0} \PYG{o}{*}   \PYG{o}{*} \PYG{l+m+mi}{1} \PYG{o}{*}   \PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{*}   \PYG{o}{*} \PYG{l+m+mi}{3} \PYG{o}{*}
\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
\PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}
\PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}
\PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}       \PYG{o}{|}
\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
  \PYG{o}{*} \PYG{l+m+mi}{0} \PYG{o}{*}   \PYG{o}{*} \PYG{l+m+mi}{1} \PYG{o}{*}   \PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{*}   \PYG{o}{*} \PYG{l+m+mi}{3} \PYG{o}{*}
    \PYG{o}{*}       \PYG{o}{*}       \PYG{o}{*}       \PYG{o}{*}
\end{sphinxVerbatim}

\sphinxAtStartPar
In the rHEALPix projection these polar triangles get rearranged
into a square with the triangles numbered \sphinxtitleref{north\_square} and \sphinxtitleref{south\_square}
remaining fixed.
For example, if \sphinxtitleref{north\_square} = 1 and \sphinxtitleref{south\_square} = 3,
then the triangles get rearranged this way:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{North} \PYG{n}{polar} \PYG{n}{square}\PYG{p}{:}     \PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
                        \PYG{o}{|} \PYG{o}{*} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{o}{|}
                        \PYG{o}{|} \PYG{l+m+mi}{0} \PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{|}
                        \PYG{o}{|} \PYG{o}{*} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{o}{|}
                    \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}

\PYG{n}{South} \PYG{n}{polar} \PYG{n}{square}\PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
                        \PYG{o}{|} \PYG{o}{*} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{o}{|}
                        \PYG{o}{|} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{l+m+mi}{0} \PYG{o}{|}
                        \PYG{o}{|} \PYG{o}{*} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{o}{|}
                        \PYG{o}{*}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{*}
\end{sphinxVerbatim}

\end{fulllineitems}


\sphinxstepscope


\chapter{The ellipsoids Module}
\label{\detokenize{ellipsoids:module-rhealpixdggs.ellipsoids}}\label{\detokenize{ellipsoids:the-ellipsoids-module}}\label{\detokenize{ellipsoids::doc}}\index{module@\spxentry{module}!rhealpixdggs.ellipsoids@\spxentry{rhealpixdggs.ellipsoids}}\index{rhealpixdggs.ellipsoids@\spxentry{rhealpixdggs.ellipsoids}!module@\spxentry{module}}
\sphinxAtStartPar
This Python 3.11 code implements ellipsoids of revolution.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Alexander Raichev (AR), 2012\sphinxhyphen{}01\sphinxhyphen{}26: Refactored code from release 0.3.

\end{itemize}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
All lengths are measured in meters and all angles are measured in radians
unless indicated otherwise.

\sphinxAtStartPar
By ‘ellipsoid’ throughout, I mean an ellipsoid of revolution and \sphinxstyleemphasis{not} a general (triaxial) ellipsoid.
Points lying on an ellipsoid are given in geodetic (longitude, latitude) coordinates.
\index{Ellipsoid (class in rhealpixdggs.ellipsoids)@\spxentry{Ellipsoid}\spxextra{class in rhealpixdggs.ellipsoids}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{rhealpixdggs.ellipsoids.}}\sphinxbfcode{\sphinxupquote{Ellipsoid}}}
{\sphinxparam{\DUrole{n}{R}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{a}\DUrole{o}{=}\DUrole{default_value}{6378137.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{b}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{e}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{f}\DUrole{o}{=}\DUrole{default_value}{0.0033528106647474805}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lon\_0}\DUrole{o}{=}\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lat\_0}\DUrole{o}{=}\DUrole{default_value}{0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{radians}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Represents an ellipsoid of revolution (possibly a sphere) with a
geodetic longitude\sphinxhyphen{}latitude coordinate frame.

\sphinxAtStartPar
INSTANCE ATTRIBUTES:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{sphere} \sphinxhyphen{} True if the ellipsoid is a sphere, and False otherwise.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{R} \sphinxhyphen{} The radius of the ellipsoid in meters, implying that it is a
sphere.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{a} \sphinxhyphen{} Major radius of the ellipsoid in meters.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{b} \sphinxhyphen{} Minor radius of the ellipsoid in meters.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{e} \sphinxhyphen{} Eccentricity of the ellipsoid.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{f} \sphinxhyphen{} Flattening of the ellipsoid.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{R\_A} \sphinxhyphen{} Authalic radius of the ellipsoid in meters.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{lon\_0} \sphinxhyphen{} Central meridian.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{lat\_0} \sphinxhyphen{} Latitude of origin.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{radians} \sphinxhyphen{} If True, use angles measured in radians for all calculations.
Use degrees otherwise.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{phi\_0} \sphinxhyphen{} The latitude separating the equatorial region and
the north polar region in the context of the (r)HEALPix projection.

\end{itemize}

\sphinxAtStartPar
Except for phi\_0, these attribute names match the names of the
\sphinxtitleref{PROJ ellipsoid parameters \textless{}https://proj.org/en/9.4/usage/ellipsoids.html\#ellipsoid\sphinxhyphen{}spherification\sphinxhyphen{}parameters\textgreater{}}
\index{get\_points() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{get\_points()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.get_points}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{get\_points}}}
{\sphinxparam{\DUrole{n}{filename}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of longitude\sphinxhyphen{}latitude points contained in
the file with filename \sphinxtitleref{filename}.
Assume the file is a text file containing at most one
longitude\sphinxhyphen{}latitude point per line with the coordinates separated by
whitespace and angles given in degrees.

\end{fulllineitems}

\index{graticule() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{graticule()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.graticule}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{graticule}}}
{\sphinxparam{\DUrole{n}{n}\DUrole{o}{=}\DUrole{default_value}{400}}\sphinxparamcomma \sphinxparam{\DUrole{n}{spacing}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of longitude\sphinxhyphen{}latitude points sampled from a
longitude\sphinxhyphen{}latitude graticule on this ellipsoid with the given
spacing between meridians and between parallels.
The number of points on longitude and latitude per pi radians is \sphinxtitleref{n}.
The spacing should be specified in the angle units used for this
ellipsoid.
If \sphinxtitleref{spacing=None}, then a default spacing of pi/16 radians will be set.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}SPHERE}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{E}\PYG{o}{.}\PYG{n}{graticule}\PYG{p}{(}\PYG{n}{n}\PYG{o}{=}\PYG{l+m+mi}{400}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{25600}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{lattice() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{lattice()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.lattice}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{lattice}}}
{\sphinxparam{\DUrole{n}{n}\DUrole{o}{=}\DUrole{default_value}{90}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a 2n x n square lattice of longitude\sphinxhyphen{}latitude points.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}SPHERE}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{p} \PYG{o+ow}{in} \PYG{n}{E}\PYG{o}{.}\PYG{n}{lattice}\PYG{p}{(}\PYG{n}{n}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{p}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}150.0, \PYGZhy{}60.0)}
\PYG{g+go}{(\PYGZhy{}150.0, 0.0)}
\PYG{g+go}{(\PYGZhy{}150.0, 60.0)}
\PYG{g+go}{(\PYGZhy{}90.0, \PYGZhy{}60.0)}
\PYG{g+go}{(\PYGZhy{}90.0, 0.0)}
\PYG{g+go}{(\PYGZhy{}90.0, 60.0)}
\PYG{g+go}{(\PYGZhy{}30.0, \PYGZhy{}60.0)}
\PYG{g+go}{(\PYGZhy{}30.0, 0.0)}
\PYG{g+go}{(\PYGZhy{}30.0, 60.0)}
\PYG{g+go}{(30.0, \PYGZhy{}60.0)}
\PYG{g+go}{(30.0, 0.0)}
\PYG{g+go}{(30.0, 60.0)}
\PYG{g+go}{(90.0, \PYGZhy{}60.0)}
\PYG{g+go}{(90.0, 0.0)}
\PYG{g+go}{(90.0, 60.0)}
\PYG{g+go}{(150.0, \PYGZhy{}60.0)}
\PYG{g+go}{(150.0, 0.0)}
\PYG{g+go}{(150.0, 60.0)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{meridian() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{meridian()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.meridian}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{meridian}}}
{\sphinxparam{\DUrole{n}{lam}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n}\DUrole{o}{=}\DUrole{default_value}{200}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of \sphinxtitleref{n} equispaced longitude\sphinxhyphen{}latitude
points lying along the meridian of longitude \sphinxtitleref{lam}.
Avoid the poles.

\end{fulllineitems}

\index{parallel() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{parallel()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.parallel}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{parallel}}}
{\sphinxparam{\DUrole{n}{phi}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n}\DUrole{o}{=}\DUrole{default_value}{200}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of \sphinxtitleref{2*n} equispaced longitude\sphinxhyphen{}latitude
points lying along the parallel of latitude \sphinxtitleref{phi}.

\end{fulllineitems}

\index{pi() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{pi()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.pi}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{pi}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return pi if \sphinxtitleref{self.radians} = True and 180 otherwise.

\end{fulllineitems}

\index{random\_point() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{random\_point()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.random_point}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{random\_point}}}
{\sphinxparam{\DUrole{n}{lam\_min}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lam\_max}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi\_min}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi\_max}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a point (given in geodetic coordinates) sampled uniformly at
random from the section of this ellipsoid with longitude in the range
\sphinxtitleref{lam\_min \textless{}= lam \textless{} lam\_max} and latitude in the range
\sphinxtitleref{phi\_min \textless{}= phi \textless{} phi\_max}.
But avoid the poles.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}SPHERE}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{E}\PYG{o}{.}\PYG{n}{random\PYGZus{}point}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)} 
\PYG{g+go}{(\PYGZhy{}1.0999574573422948, 0.21029104897701129)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{xyz() (rhealpixdggs.ellipsoids.Ellipsoid method)@\spxentry{xyz()}\spxextra{rhealpixdggs.ellipsoids.Ellipsoid method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ellipsoids:rhealpixdggs.ellipsoids.Ellipsoid.xyz}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{xyz}}}
{\sphinxparam{\DUrole{n}{lam}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Given a point on this ellipsoid with longitude\sphinxhyphen{}latitude coordinates
\sphinxtitleref{(lam, phi)}, return the point’s 3D rectangular coordinates.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}SPHERE}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{E}\PYG{o}{.}\PYG{n}{xyz}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.707106781186548, 0.0, 0.707106781186548)}
\end{sphinxVerbatim}

\end{fulllineitems}


\end{fulllineitems}


\sphinxstepscope


\chapter{The projection\_wrapper Module}
\label{\detokenize{projection_wrapper:module-rhealpixdggs.projection_wrapper}}\label{\detokenize{projection_wrapper:the-projection-wrapper-module}}\label{\detokenize{projection_wrapper::doc}}\index{module@\spxentry{module}!rhealpixdggs.projection\_wrapper@\spxentry{rhealpixdggs.projection\_wrapper}}\index{rhealpixdggs.projection\_wrapper@\spxentry{rhealpixdggs.projection\_wrapper}!module@\spxentry{module}}
\sphinxAtStartPar
This Python 3.11 module implements a wrapper for map projections.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Alexander Raichev (AR), 2013\sphinxhyphen{}01\sphinxhyphen{}25: Refactored code from release 0.3.

\end{itemize}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
All lengths are measured in meters and all angles are measured in radians
unless indicated otherwise.
By ‘ellipsoid’ below, I mean an oblate ellipsoid of revolution.
\index{Projection (class in rhealpixdggs.projection\_wrapper)@\spxentry{Projection}\spxextra{class in rhealpixdggs.projection\_wrapper}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{projection_wrapper:rhealpixdggs.projection_wrapper.Projection}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{rhealpixdggs.projection\_wrapper.}}\sphinxbfcode{\sphinxupquote{Projection}}}
{\sphinxparam{\DUrole{n}{ellipsoid=\textless{}rhealpixdggs.ellipsoids.Ellipsoid object\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{proj=None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{**kwargs}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Represents a map projection of a given ellipsoid.

\sphinxAtStartPar
INSTANCE ATTRIBUTES:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{ellipsoid} \sphinxhyphen{} An ellipsoid (Ellipsoid instance) to project.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{proj} \sphinxhyphen{} The name (string) of the map projection, either a valid PROJ.4
projection name or a valid homemade projection name.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{kwargs} \sphinxhyphen{} Keyword arguments (dictionary) needed for the projection’s
definition, but not for the definition of the ellipsoid.  For example,
these could be \{‘north\_square’:1, ‘south\_square’: 2\} for the rhealpix
projection.

\end{itemize}

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{ellipsoids}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{WGS84\PYGZus{}ELLIPSOID}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{f} \PYG{o}{=} \PYG{n}{Projection}\PYG{p}{(}\PYG{n}{ellipsoid}\PYG{o}{=}\PYG{n}{WGS84\PYGZus{}ELLIPSOID}\PYG{p}{,} \PYG{n}{proj}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rhealpix}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{north\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{south\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{f}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.0, 3740232.8933662786)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{f} \PYG{o}{=} \PYG{n}{Projection}\PYG{p}{(}\PYG{n}{ellipsoid}\PYG{o}{=}\PYG{n}{WGS84\PYGZus{}ELLIPSOID}\PYG{p}{,} \PYG{n}{proj}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cea}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{f}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.0, 3171259.315518537)}
\end{sphinxVerbatim}

\sphinxAtStartPar
NOTES:

\sphinxAtStartPar
When accessing a homemade map projection assume that it can be called via
a function g(a, e), where a is the major radius of the ellipsoid to be
projected and e is its eccentricity.
The output of g should be a function object of the form
f(u, v, radians=False, inverse=False).
For example, see the healpix() function in \sphinxcode{\sphinxupquote{pj\_healpix.py}}.

\end{fulllineitems}


\sphinxstepscope


\chapter{The dggs Module}
\label{\detokenize{dggs:module-rhealpixdggs.dggs}}\label{\detokenize{dggs:the-dggs-module}}\label{\detokenize{dggs::doc}}\index{module@\spxentry{module}!rhealpixdggs.dggs@\spxentry{rhealpixdggs.dggs}}\index{rhealpixdggs.dggs@\spxentry{rhealpixdggs.dggs}!module@\spxentry{module}}
\sphinxAtStartPar
This Python 3.11 module implements the rHEALPix discrete global grid system.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Alexander Raichev (AR), 2012\sphinxhyphen{}11\sphinxhyphen{}12: Initial version based upon grids.py.

\end{itemize}

\sphinxAtStartPar
NOTES:

\sphinxAtStartPar
All lengths are measured in meters and all angles are measured in radians
unless indicated otherwise.

\sphinxAtStartPar
By ‘ellipsoid’ throughout, I mean an ellipsoid of revolution and \sphinxstyleemphasis{not} a general (triaxial) ellipsoid.

\sphinxAtStartPar
Points lying on the plane are given in rectangular (horizontal, vertical) coordinates, and points lying on the ellipsoid are given in geodetic (longitude, latitude) coordinates unless indicated otherwise.

\sphinxAtStartPar
DGGS abbreviates ‘discrete global grid system’.

\sphinxAtStartPar
Except when manipulating positive integers, I avoid the modulo function ‘\%’
and insted write everything in terms of ‘floor()’.
This is because Python interprets the sign of ‘\%’ differently than
Java or C, and I don’t want to confuse people who are translating this code
to those languages.

\sphinxAtStartPar
EXAMPLES:

\sphinxAtStartPar
Create the (1, 2)\sphinxhyphen{}rHEALPix DGGS with N\_side = 3 that is based on the WGS84 ellipsoid. Use degrees instead of the default radians for angular measurements

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{ellipsoids}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{WGS84\PYGZus{}ELLIPSOID}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{WGS84\PYGZus{}ELLIPSOID}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{n}{ellipsoid}\PYG{o}{=}\PYG{n}{E}\PYG{p}{,} \PYG{n}{north\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{south\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{N\PYGZus{}side}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{p}{)}
\PYG{g+go}{rHEALPix DGGS:}
\PYG{g+go}{    N\PYGZus{}side = 3}
\PYG{g+go}{    north\PYGZus{}square = 1}
\PYG{g+go}{    south\PYGZus{}square = 2}
\PYG{g+go}{    max\PYGZus{}areal\PYGZus{}resolution = 1}
\PYG{g+go}{    max\PYGZus{}resolution = 15}
\PYG{g+go}{    ellipsoid:}
\PYG{g+go}{        R\PYGZus{}A = 6371007.180918476}
\PYG{g+go}{        a = 6378137.0}
\PYG{g+go}{        b = 6356752.314245179}
\PYG{g+go}{        e = 0.08181919084262149}
\PYG{g+go}{        f = 0.0033528106647474805}
\PYG{g+go}{        lat\PYGZus{}0 = 0}
\PYG{g+go}{        lon\PYGZus{}0 = 0}
\PYG{g+go}{        radians = False}
\PYG{g+go}{        sphere = False}
\end{sphinxVerbatim}

\sphinxAtStartPar
Pick a (longitude\sphinxhyphen{}latitude) point on the ellipsoid and find the resolution 1 cell that contains it

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{45}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}from\PYGZus{}point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{p}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{;} \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)}
\PYG{g+go}{N8}
\end{sphinxVerbatim}

\sphinxAtStartPar
Find the ellipsoidal (edge) neighbors of this cell

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)} \PYG{o+ow}{in} \PYG{n+nb}{sorted}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{neighbors}\PYG{p}{(}\PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)}
\PYG{g+go}{east N5}
\PYG{g+go}{south\PYGZus{}east Q0}
\PYG{g+go}{south\PYGZus{}west P2}
\PYG{g+go}{west N7}
\end{sphinxVerbatim}

\sphinxAtStartPar
Find the planar (edge) neighbors of this cell

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)} \PYG{o+ow}{in} \PYG{n+nb}{sorted}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{neighbors}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{plane}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{direction}\PYG{p}{,} \PYG{n}{cell}\PYG{p}{)}
\PYG{g+go}{down P2}
\PYG{g+go}{left N7}
\PYG{g+go}{right Q0}
\PYG{g+go}{up N5}
\end{sphinxVerbatim}

\sphinxAtStartPar
Find all the resolution 1 cells intersecting the longitude\sphinxhyphen{}latitude aligned ellipsoidal quadrangle with given northwest and southeast corners

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{nw} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{45}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{se} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cells} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}region}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{nw}\PYG{p}{,} \PYG{n}{se}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{cells}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{row}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N8\PYGZsq{}, \PYGZsq{}N5\PYGZsq{}, \PYGZsq{}N2\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}Q0\PYGZsq{}, \PYGZsq{}Q1\PYGZsq{}, \PYGZsq{}Q2\PYGZsq{}, \PYGZsq{}R0\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}Q3\PYGZsq{}, \PYGZsq{}Q4\PYGZsq{}, \PYGZsq{}Q5\PYGZsq{}, \PYGZsq{}R3\PYGZsq{}]}
\end{sphinxVerbatim}

\sphinxAtStartPar
Compute the ellipsoidal nuclei of these cells

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{expected\PYGZus{}results} \PYG{o}{=} \PYG{p}{[}
\PYG{g+gp}{... }   \PYG{p}{[}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{1.90833280887811e\PYGZhy{}14}\PYG{p}{,} \PYG{l+m+mf}{58.52801748206219}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{45.00000000000002}\PYG{p}{,} \PYG{l+m+mf}{58.52801748206219}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{89.99999999999997}\PYG{p}{,} \PYG{l+m+mf}{58.52801748206219}\PYG{p}{)}
\PYG{g+gp}{... }   \PYG{p}{]}\PYG{p}{,} \PYG{p}{[}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{14.999999999999998}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{45.0}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{74.99999999999999}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{105.00000000000001}\PYG{p}{,} \PYG{l+m+mf}{26.490118751439734}\PYG{p}{)}
\PYG{g+gp}{... }   \PYG{p}{]}\PYG{p}{,} \PYG{p}{[}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{14.999999999999998}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{45.0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{74.99999999999999}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gp}{... }       \PYG{p}{(}\PYG{l+m+mf}{105.00000000000001}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{... }   \PYG{p}{]}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{k}{for} \PYG{n}{j}\PYG{p}{,} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{row}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{,} \PYG{n}{assert\PYGZus{}allclose}\PYG{p}{(}\PYG{n}{cell}\PYG{o}{.}\PYG{n}{nucleus}\PYG{p}{(}\PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{,} \PYG{n}{expected\PYGZus{}results}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}15}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{==} \PYG{k+kc}{None}\PYG{p}{)}
\PYG{g+go}{N8 True}
\PYG{g+go}{N5 True}
\PYG{g+go}{N2 True}
\PYG{g+go}{Q0 True}
\PYG{g+go}{Q1 True}
\PYG{g+go}{Q2 True}
\PYG{g+go}{R0 True}
\PYG{g+go}{Q3 True}
\PYG{g+go}{Q4 True}
\PYG{g+go}{Q5 True}
\PYG{g+go}{R3 True}
\end{sphinxVerbatim}

\sphinxAtStartPar
Create a (0, 0)\sphinxhyphen{}rHEALPix DGGS with N\_side = 3 based on the WGS84 ellipsoid.
Use degrees instead of the default radians for angular measurements and
orient the DGGS so that the planar origin (0, 0) is on Auckland, New Zealand

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{174}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{37}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Approximate Auckland lon\PYGZhy{}lat coordinates}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{rhealpixdggs}\PYG{n+nn}{.}\PYG{n+nn}{ellipsoids}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{E} \PYG{o}{=} \PYG{n}{Ellipsoid}\PYG{p}{(}\PYG{n}{a}\PYG{o}{=}\PYG{n}{WGS84\PYGZus{}A}\PYG{p}{,} \PYG{n}{f}\PYG{o}{=}\PYG{n}{WGS84\PYGZus{}F}\PYG{p}{,} \PYG{n}{radians}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{lon\PYGZus{}0}\PYG{o}{=}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{lat\PYGZus{}0}\PYG{o}{=}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{n}{E}\PYG{p}{,} \PYG{n}{N\PYGZus{}side}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{north\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{south\PYGZus{}square}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{p}{)}
\PYG{g+go}{rHEALPix DGGS:}
\PYG{g+go}{    N\PYGZus{}side = 3}
\PYG{g+go}{    north\PYGZus{}square = 0}
\PYG{g+go}{    south\PYGZus{}square = 0}
\PYG{g+go}{    max\PYGZus{}areal\PYGZus{}resolution = 1}
\PYG{g+go}{    max\PYGZus{}resolution = 15}
\PYG{g+go}{    ellipsoid:}
\PYG{g+go}{        R\PYGZus{}A = 6371007.180918476}
\PYG{g+go}{        a = 6378137.0}
\PYG{g+go}{        b = 6356752.314245179}
\PYG{g+go}{        e = 0.08181919084262149}
\PYG{g+go}{        f = 0.0033528106647474805}
\PYG{g+go}{        lat\PYGZus{}0 = \PYGZhy{}37}
\PYG{g+go}{        lon\PYGZus{}0 = 174}
\PYG{g+go}{        radians = False}
\PYG{g+go}{        sphere = False}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}from\PYGZus{}point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{p}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{Q3}
\end{sphinxVerbatim}
\index{RHEALPixDGGS (class in rhealpixdggs.dggs)@\spxentry{RHEALPixDGGS}\spxextra{class in rhealpixdggs.dggs}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{rhealpixdggs.dggs.}}\sphinxbfcode{\sphinxupquote{RHEALPixDGGS}}}
{\sphinxparam{\DUrole{n}{ellipsoid=\textless{}rhealpixdggs.ellipsoids.Ellipsoid object\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{N\_side=3}}\sphinxparamcomma \sphinxparam{\DUrole{n}{north\_square=0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{south\_square=0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_areal\_resolution=1}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Represents an rHEALPix DGGS on a given ellipsoid.

\sphinxAtStartPar
INSTANCE ATTRIBUTES:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{ellipsoid} \sphinxhyphen{} The underlying ellipsoid (Ellipsoid instance).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{N\_side} \sphinxhyphen{} An integer of size at least 2.
Each planar cell has N\_side x N\_side child cells.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{(north\_square, south\_square)} \sphinxhyphen{} Integers between 0 and 3 indicating
the positions of north polar and south polar squares, respectively,
of the rHEALPix projection used.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{max\_areal\_resolution} \sphinxhyphen{} An area measured in square meters that
upper bounds the area of the smallest ellipsoidal grid cells.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{max\_resolution} \sphinxhyphen{} A nonnegative integer that is the maximum grid
resolution needed to have ellipsoidal cells of area at most
\sphinxtitleref{max\_areal\_resolution}.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{child\_order} \sphinxhyphen{} A dictionary of the ordering (Morton order) of child
cells of a cell in terms of the row\sphinxhyphen{}column coordinates in the matrix
of child cells.  Child cell are numbered 0 to \sphinxtitleref{N\_side**2 \sphinxhyphen{}1} from
left to right and top to bottom.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{ul\_vertex} \sphinxhyphen{} A dictionary with key\sphinxhyphen{}value pairs (c, (x, y)), where
c is an element of \sphinxtitleref{CELLS0} and (x, y) is the upper left corner point
of the resolution 0 planar cell c.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{atomic\_neighbors} \sphinxhyphen{} A dictionary with key\sphinxhyphen{}value pairs
(n, \{‘up’: a, ‘down’: b, ‘left’: c, ‘right’: d\}),
where n, a, b, c, and d are elements of \sphinxtitleref{CELLS0} or
\{0, 1, …, \sphinxtitleref{N\_side**2 \sphinxhyphen{}1}\}.
Describes the planar (edge) neighbors of cell0 letter / child cell number
n.

\end{itemize}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
Several RHEALPixDGGS methods have the keyword argument ‘plane’.
Setting it to True indicates that all input and output points and cells are
interpreted as lying in the planar DGGS.
Setting it to False indicates that they are interpreted as lying in
the ellipsoidal DGGS.
\index{cell() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cell()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cell}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cell}}}
{\sphinxparam{\DUrole{n}{suid}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{level\_order\_index}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{post\_order\_index}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a cell (Cell instance) of this DGGS either from its ID or
from its resolution and index.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n}{c}\PYG{p}{,} \PYG{n}{Cell}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)}
\PYG{g+go}{N45}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cell\_area() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cell\_area()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cell_area}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cell\_area}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the area of a planar or ellipsoidal cell at the given
resolution.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{a} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}area}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{a} \PYG{o}{==} \PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}area}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{8}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{pi}\PYG{p}{)}\PYG{o}{*}\PYG{n}{a}\PYG{p}{)}
\PYG{g+go}{True}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cell\_from\_point() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cell\_from\_point()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cell_from_point}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cell\_from\_point}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{p}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the resolution \sphinxtitleref{resolution} cell that contains the point \sphinxtitleref{p}.
If \sphinxtitleref{plane} = True, then \sphinxtitleref{p} and the output cell lie in the
planar DGGS.
Otherwise, \sphinxtitleref{p} and the output cell lie in the ellipsoidal DGGS.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}from\PYGZus{}point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{p}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)}
\PYG{g+go}{Q3}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{n}{N\PYGZus{}side}\PYG{o}{=}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{80}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}from\PYGZus{}point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{p}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)}
\PYG{g+go}{(Q, 178)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cell\_from\_region() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cell\_from\_region()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cell_from_region}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cell\_from\_region}}}
{\sphinxparam{\DUrole{n}{ul}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dr}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the smallest planar or ellipsoidal cell wholly containing
the region bounded by the axis\sphinxhyphen{}aligned rectangle with upper left
and lower right vertices given by the the points \sphinxtitleref{ul} and \sphinxtitleref{dr},
respectively.
If such as cell does not exist, then return None.
If \sphinxtitleref{plane} = True, then \sphinxtitleref{ul} and \sphinxtitleref{dr} and the returned cell
lie in the planar DGGS.
Otherwise, \sphinxtitleref{ul} and \sphinxtitleref{dr} and the returned cell lie in the ellipsoidal
DGGS.

\sphinxAtStartPar
To specify an ellipsoidal cap region, set \sphinxtitleref{ul} = (\sphinxhyphen{}pi, pi/2) and
\sphinxtitleref{dr} = (\sphinxhyphen{}pi, phi) for a northern cap from latitudes pi/2 to phi, or
set \sphinxtitleref{ul} = (\sphinxhyphen{}pi, phi) and \sphinxtitleref{dr} = (\sphinxhyphen{}pi, \sphinxhyphen{}pi/2) for a southern cap from
latitudes phi to \sphinxhyphen{}pi/2.
(As usual, if \sphinxtitleref{self.ellipsoid.radians} = False,
then use degrees instead of radians when specifying ul and dr.)

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{12}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{q} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{6} \PYG{o}{\PYGZhy{}} \PYG{l+m+mf}{1e\PYGZhy{}6}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}from\PYGZus{}region}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{q}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)}
\PYG{g+go}{Q3}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cell\_latitudes() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cell\_latitudes()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cell_latitudes}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cell\_latitudes}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi\_min}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi\_max}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nucleus}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of every latitude phi whose parallel intersects
a resolution \sphinxtitleref{resolution} cell nucleus and satisfies
\sphinxtitleref{phi\_min} \textless{} phi \textless{} \sphinxtitleref{phi\_max}.
If \sphinxtitleref{plane} = True, then use rHEALPix y\sphinxhyphen{}coordinates for \sphinxtitleref{phi\_min},
\sphinxtitleref{phi\_max}, and the result. Return the list in increasing order.
If \sphinxtitleref{nucleus} = False, then return a list of every latitude phi whose
parallel intersects the north or south boundary of a resolution
\sphinxtitleref{resolution} cell and that satisfies \sphinxtitleref{phi\_min} \textless{} phi \textless{} \sphinxtitleref{phi\_max}.

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
By convention, the pole latitudes pi/2 and \sphinxhyphen{}pi/2 (or their
corresponding rHEALPix y\sphinxhyphen{}coordinates) will be excluded.

\sphinxAtStartPar
There are 2*self.N\_side**resolution \sphinxhyphen{} 1 nuclei
latitudes between the poles if self.N\_side is odd and
2*self.N\_side**resolution if self.N\_side is even.
Consequently, there are 2*self.N\_side**resolution
boundary latitudes between the poles if self.N\_side is odd and
2*self.N\_side**resolution \sphinxhyphen{} 1 boundary latitudes if self.N\_side is
even.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{WGS84\PYGZus{}003\PYGZus{}RADIANS}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{phi} \PYG{o+ow}{in} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}latitudes}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{phi}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{\PYGZhy{}1.02150660972679}
\PYG{g+go}{\PYGZhy{}0.46233979145691}
\PYG{g+go}{0.0}
\PYG{g+go}{0.46233979145691}
\PYG{g+go}{1.02150660972679}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{phi} \PYG{o+ow}{in} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}latitudes}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{nucleus}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{phi}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{\PYGZhy{}1.29894395947616}
\PYG{g+go}{\PYGZhy{}0.73195363195267}
\PYG{g+go}{\PYGZhy{}0.22506566919844}
\PYG{g+go}{0.22506566919844}
\PYG{g+go}{0.73195363195267}
\PYG{g+go}{1.29894395947616}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cell\_width() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cell\_width()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cell_width}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cell\_width}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the width of a planar cell at the given resolution.
If \sphinxtitleref{plane} = False, then return None,
because the ellipsoidal cells don’t have constant width.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}width}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{==} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{g+go}{True}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell\PYGZus{}width}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{==} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{p}{)}
\PYG{g+go}{True}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cells\_from\_meridian() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cells\_from\_meridian()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cells_from_meridian}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cells\_from\_meridian}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lam}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi\_min}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi\_max}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of the resolution \sphinxtitleref{resolution} cells that intersect
the meridian segment of longitude \sphinxtitleref{lam} whose least latitude is
\sphinxtitleref{phi\_min} and whose greatest latitude is \sphinxtitleref{phi\_max}.
Sort the cells from north to south and west to east in case
two cells with the same nucleus latitude intersect the
meridian.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{WGS84\PYGZus{}003\PYGZus{}RADIANS}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cells} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}meridian}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{cells}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N4\PYGZsq{}, \PYGZsq{}N2\PYGZsq{}, \PYGZsq{}N1\PYGZsq{}, \PYGZsq{}Q0\PYGZsq{}, \PYGZsq{}Q3\PYGZsq{}, \PYGZsq{}Q6\PYGZsq{}, \PYGZsq{}S8\PYGZsq{}, \PYGZsq{}S7\PYGZsq{}, \PYGZsq{}S4\PYGZsq{}]}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cells\_from\_parallel() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cells\_from\_parallel()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cells_from_parallel}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cells\_from\_parallel}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{phi}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lam\_min}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lam\_max}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a list of the resolution \sphinxtitleref{resolution} cells that intersect
the parallel segment of latitude \sphinxtitleref{phi} whose least longitude is
\sphinxtitleref{lam\_min} and whose greatest longitude is \sphinxtitleref{lam\_max}.
Sort the list from west to east.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{WGS84\PYGZus{}003\PYGZus{}RADIANS}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cells} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}parallel}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{p}{,} \PYG{n}{pi}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{cells}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N6\PYGZsq{}, \PYGZsq{}N7\PYGZsq{}, \PYGZsq{}N8\PYGZsq{}, \PYGZsq{}N5\PYGZsq{}, \PYGZsq{}N2\PYGZsq{}, \PYGZsq{}N1\PYGZsq{}, \PYGZsq{}N0\PYGZsq{}, \PYGZsq{}N3\PYGZsq{}]}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cells\_from\_region() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{cells\_from\_region()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.cells_from_region}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cells\_from\_region}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ul}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dr}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
If \sphinxtitleref{plane} = True, then return a list of lists of resolution
\sphinxtitleref{resolution} cells that cover the axis\sphinxhyphen{}aligned rectangle whose
upper left and lower right vertices are the points \sphinxtitleref{ul} and \sphinxtitleref{dr},
respectively.
In the output, sort each sublist of cells from left to right (in the
planar DGGS) and sort the sublists from top to bottom.

\sphinxAtStartPar
If \sphinxtitleref{plane} = False, then return a list of lists of resolution
\sphinxtitleref{resolution}
cells that cover the longitude\sphinxhyphen{}latitude aligned ellipsoidal quadrangle
whose northwest and southeast vertices are the points \sphinxtitleref{ul} and \sphinxtitleref{dr},
respectively. Defunct quads with \sphinxtitleref{ul} = (stuff, pi/2) or
\sphinxtitleref{dr} = (stuff, \sphinxhyphen{}pi/2) also work
(and rely on the fact that the north and south pole can both
be specified by infinitely many longitudes).

\sphinxAtStartPar
To specify an ellipsoidal cap region, set \sphinxtitleref{ul} = (\sphinxhyphen{}pi, pi/2) and
\sphinxtitleref{dr} = (\sphinxhyphen{}pi, phi) for a northern cap from latitudes pi/2 to phi, or
set \sphinxtitleref{ul} = (\sphinxhyphen{}pi, phi) and \sphinxtitleref{dr} = (\sphinxhyphen{}pi, \sphinxhyphen{}pi/2) for a southern cap from
latitudes phi to \sphinxhyphen{}pi/2. (As usual, if \sphinxtitleref{self.ellipsoid.radians} = False,
then use degrees instead of radians when specifying ul and dr.)

\sphinxAtStartPar
In the output, sort each sublist of cells from west to east (in the
ellipsoidal DGGS) and sort the sublists from north to south.

\sphinxAtStartPar
Return the empty list if if \sphinxtitleref{ul{[}0{]} \textgreater{} dr{[}0{]}} or \sphinxtitleref{ul{[}1{]} \textless{} dr{[}1{]}}.

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
If \sphinxtitleref{plane} = True, then the resulting list is a matrix, that is,
each sublist has the same length.  This is not necessarily so if
\sphinxtitleref{plane} = False; see the examples below.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{WGS84\PYGZus{}003\PYGZus{}RADIANS}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{R\PYGZus{}A} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{ellipsoid}\PYG{o}{.}\PYG{n}{R\PYGZus{}A}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ul} \PYG{o}{=} \PYG{n}{R\PYGZus{}A}\PYG{o}{*}\PYG{n}{array}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dr} \PYG{o}{=} \PYG{n}{R\PYGZus{}A}\PYG{o}{*}\PYG{n}{array}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Rectangle}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{M} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}region}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{ul}\PYG{p}{,} \PYG{n}{dr}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{M}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{row}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}P2\PYGZsq{}, \PYGZsq{}Q0\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}P5\PYGZsq{}, \PYGZsq{}Q3\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}P8\PYGZsq{}, \PYGZsq{}Q6\PYGZsq{}]}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ul} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dr} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Quad}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{M} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}region}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{ul}\PYG{p}{,} \PYG{n}{dr}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{M}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{row}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N2\PYGZsq{}, \PYGZsq{}N1\PYGZsq{}, \PYGZsq{}N0\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}Q0\PYGZsq{}, \PYGZsq{}Q1\PYGZsq{}, \PYGZsq{}Q2\PYGZsq{}, \PYGZsq{}R0\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}Q3\PYGZsq{}, \PYGZsq{}Q4\PYGZsq{}, \PYGZsq{}Q5\PYGZsq{}, \PYGZsq{}R3\PYGZsq{}]}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ul} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dr} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Defunct quad / lune segment}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{M} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}region}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{ul}\PYG{p}{,} \PYG{n}{dr}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{M}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{row}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}Q6\PYGZsq{}, \PYGZsq{}Q7\PYGZsq{}, \PYGZsq{}Q8\PYGZsq{}, \PYGZsq{}R6\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}S8\PYGZsq{}, \PYGZsq{}S7\PYGZsq{}, \PYGZsq{}S6\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}S4\PYGZsq{}]}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ul} \PYG{o}{=} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{dr} \PYG{o}{=} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Cap}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{M} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cells\PYGZus{}from\PYGZus{}region}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{ul}\PYG{p}{,} \PYG{n}{dr}\PYG{p}{,} \PYG{n}{plane}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{M}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cell}\PYG{p}{)} \PYG{k}{for} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n}{row}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}O6\PYGZsq{}, \PYGZsq{}O7\PYGZsq{}, \PYGZsq{}O8\PYGZsq{}, \PYGZsq{}P6\PYGZsq{}, \PYGZsq{}P7\PYGZsq{}, \PYGZsq{}P8\PYGZsq{}, \PYGZsq{}Q6\PYGZsq{}, \PYGZsq{}Q7\PYGZsq{}, \PYGZsq{}Q8\PYGZsq{}, \PYGZsq{}R6\PYGZsq{}, \PYGZsq{}R7\PYGZsq{}, \PYGZsq{}R8\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}S0\PYGZsq{}, \PYGZsq{}S1\PYGZsq{}, \PYGZsq{}S2\PYGZsq{}, \PYGZsq{}S5\PYGZsq{}, \PYGZsq{}S8\PYGZsq{}, \PYGZsq{}S7\PYGZsq{}, \PYGZsq{}S6\PYGZsq{}, \PYGZsq{}S3\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}S4\PYGZsq{}]}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{combine\_triangles() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{combine\_triangles()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.combine_triangles}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{combine\_triangles}}}
{\sphinxparam{\DUrole{n}{u}}\sphinxparamcomma \sphinxparam{\DUrole{n}{v}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{region}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}none\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the combine\_triangles() transformation of the point \sphinxtitleref{(u, v)}
(or its inverse if \sphinxtitleref{inverse} = True) appropriate to the underlying
ellipsoid.
It maps the HEALPix projection to the rHEALPix projection.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{q} \PYG{o}{=} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{combine\PYGZus{}triangles}\PYG{p}{(}\PYG{o}{*}\PYG{n}{p}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.0, 0.0)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{combine\PYGZus{}triangles}\PYG{p}{(}\PYG{o}{*}\PYG{n}{q}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}2.35619449019234, 1.5707963267949)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{grid() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{grid()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.grid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{grid}}}
{\sphinxparam{\DUrole{n}{resolution}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generator function for all the cells at resolution \sphinxtitleref{resolution}.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{grid0} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{grid0}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N\PYGZsq{}, \PYGZsq{}O\PYGZsq{}, \PYGZsq{}P\PYGZsq{}, \PYGZsq{}Q\PYGZsq{}, \PYGZsq{}R\PYGZsq{}, \PYGZsq{}S\PYGZsq{}]}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{healpix() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{healpix()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.healpix}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{healpix}}}
{\sphinxparam{\DUrole{n}{u}}\sphinxparamcomma \sphinxparam{\DUrole{n}{v}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the HEALPix projection of point \sphinxtitleref{(u, v)} (or its inverse if
\sphinxtitleref{inverse} = True) appropriate to this rHEALPix DGGS.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003\PYGZus{}RADIANS}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{healpix}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{pi}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}2.35619449019234, 1.5707963267949)}
\end{sphinxVerbatim}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
Uses \sphinxcode{\sphinxupquote{pj\_healpix}} instead of the PROJ.4 version of HEALPix.

\end{fulllineitems}

\index{interval() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{interval()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.interval}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{interval}}}
{\sphinxparam{\DUrole{n}{a}}\sphinxparamcomma \sphinxparam{\DUrole{n}{b}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generator function for all the resolution
\sphinxtitleref{max(a.resolution, b.resolution)} cells between cell
\sphinxtitleref{a} and cell \sphinxtitleref{b} (inclusive and with respect to the
postorder ordering on cells).
Note that \sphinxtitleref{a} and \sphinxtitleref{b} don’t have to lie at the same resolution.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{a} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{b} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)} \PYG{k}{for} \PYG{n}{c} \PYG{o+ow}{in} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{interval}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N1\PYGZsq{}, \PYGZsq{}N2\PYGZsq{}, \PYGZsq{}N3\PYGZsq{}, \PYGZsq{}N4\PYGZsq{}, \PYGZsq{}N5\PYGZsq{}, \PYGZsq{}N6\PYGZsq{}, \PYGZsq{}N7\PYGZsq{}, \PYGZsq{}N8\PYGZsq{}]}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{minimal\_cover() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{minimal\_cover()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.minimal_cover}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{minimal\_cover}}}
{\sphinxparam{\DUrole{n}{resolution}}\sphinxparamcomma \sphinxparam{\DUrole{n}{points}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Find the minimal set of resolution \sphinxtitleref{resolution} cells that covers
the list of points \sphinxtitleref{points}.
If \sphinxtitleref{plane} = True, then assume \sphinxtitleref{points} is a list of x\sphinxhyphen{}y
coordinates in the planar DGGS.
If \sphinxtitleref{plane} = False, then assume \sphinxtitleref{points} is a list of
longitude\sphinxhyphen{}latitude coordinates in the ellipsoidal DGGS.
This method will be made redundant by standard GIS rasterization
tools that implement the rHEALPix projection.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c1} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c2} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{points} \PYG{o}{=} \PYG{p}{[}\PYG{n}{c}\PYG{o}{.}\PYG{n}{nucleus}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{c} \PYG{o+ow}{in} \PYG{p}{[}\PYG{n}{c1}\PYG{p}{,} \PYG{n}{c2}\PYG{p}{]}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{for} \PYG{n}{r} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n}{cover} \PYG{o}{=} \PYG{n+nb}{sorted}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{minimal\PYGZus{}cover}\PYG{p}{(}\PYG{n}{r}\PYG{p}{,} \PYG{n}{points}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)} \PYG{k}{for} \PYG{n}{c} \PYG{o+ow}{in} \PYG{n}{cover}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}N\PYGZsq{}, \PYGZsq{}P\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}N0\PYGZsq{}, \PYGZsq{}P7\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}N02\PYGZsq{}, \PYGZsq{}P73\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}N021\PYGZsq{}, \PYGZsq{}P733\PYGZsq{}]}
\PYG{g+go}{[\PYGZsq{}N0214\PYGZsq{}, \PYGZsq{}P7334\PYGZsq{}]}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{num\_cells() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{num\_cells()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.num_cells}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{num\_cells}}}
{\sphinxparam{\DUrole{n}{res\_1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{res\_2}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{subcells}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the number of cells of resolutions \sphinxtitleref{res\_1} to \sphinxtitleref{res\_2}
(inclusive).
Assume \sphinxtitleref{res\_1 \textless{}= res\_2}.
If \sphinxtitleref{subcells} = True, then return the number of subcells at resolutions
\sphinxtitleref{res\_1} to \sphinxtitleref{res\_2} (inclusive) of a cell at resolution \sphinxtitleref{res\_1}.
If \sphinxtitleref{res\_2=None} and \sphinxtitleref{subcells=False, then return the number of
cells at resolution \textasciigrave{}res\_1}.
If \sphinxtitleref{res\_2=None} and \sphinxtitleref{subcells} = True, then return the number of
subcells from resolution \sphinxtitleref{res\_1} to resolution \sphinxtitleref{self.max\_resolution}.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{num\PYGZus{}cells}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+go}{6}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{num\PYGZus{}cells}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{g+go}{60}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{num\PYGZus{}cells}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{subcells}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{231627523606480}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{num\PYGZus{}cells}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{subcells}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{10}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{num\PYGZus{}cells}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{subcells}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{10}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{random\_cell() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{random\_cell()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.random_cell}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{random\_cell}}}
{\sphinxparam{\DUrole{n}{resolution}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a cell of the given resolution chosen uniformly at random
from all cells at that resolution.
If \sphinxtitleref{resolution=None}, then the cell resolution is first chosen
uniformly at random from {[}0,..,self.max\_resolution{]}.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{random\PYGZus{}cell}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)} 
\PYG{g+go}{S480586367780080}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{random\_point() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{random\_point()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.random_point}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{random\_point}}}
{\sphinxparam{\DUrole{n}{plane}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return a point in this DGGS sampled uniformly at
random from the plane or from the ellipsoid.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{E}\PYG{o}{.}\PYG{n}{random\PYGZus{}point}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)} 
\PYG{g+go}{(\PYGZhy{}1.0999574573422948, 0.21029104897701129)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rhealpix() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{rhealpix()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.rhealpix}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{rhealpix}}}
{\sphinxparam{\DUrole{n}{u}}\sphinxparamcomma \sphinxparam{\DUrole{n}{v}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{region}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}none\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the rHEALPix projection of the point \sphinxtitleref{(u, v)} (or its inverse if
\sphinxtitleref{inverse} = True) appropriate to this rHEALPix DGGS.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003\PYGZus{}RADIANS}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{rhealpix}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(\PYGZhy{}1.858272006684, 2.06871881030324)}
\end{sphinxVerbatim}

\sphinxAtStartPar
NOTE:

\sphinxAtStartPar
Uses \sphinxcode{\sphinxupquote{pj\_rhealpix}} instead of the PROJ.4 version of rHEALPix.

\end{fulllineitems}

\index{triangle() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{triangle()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.triangle}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{triangle}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{inverse}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
If \sphinxtitleref{inverse} = False, then assume \sphinxtitleref{(x,y)} lies in the image of the
HEALPix projection that comes with this DGGS, and
return the number of the HEALPix polar triangle (0, 1, 2, 3, or None)
and the region (‘north\_polar’, ‘south\_polar’, or ‘equatorial’) that
\sphinxtitleref{(x, y)} lies in.
If \sphinxtitleref{inverse} = True, then assume \sphinxtitleref{(x, y)} lies in the image of
the rHEALPix projection that comes with this DGGS, map \sphinxtitleref{(x, y)}
to its HEALPix image (x’, y’), and return the number of the HEALPix
polar triangle and the region that (x’, y’) lies in.
If \sphinxtitleref{(x, y)} lies in the equatorial region, then the triangle number
returned is None.

\sphinxAtStartPar
OUTPUT:

\sphinxAtStartPar
The pair (triangle\_number, region).

\sphinxAtStartPar
NOTES:

\sphinxAtStartPar
This is a wrapper for pjr.triangle().

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{RHEALPixDGGS}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{triangle}\PYG{p}{(}\PYG{o}{*}\PYG{n}{c}\PYG{o}{.}\PYG{n}{nucleus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0, \PYGZsq{}north\PYGZus{}polar\PYGZsq{})}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{triangle}\PYG{p}{(}\PYG{o}{*}\PYG{n}{c}\PYG{o}{.}\PYG{n}{nucleus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(3, \PYGZsq{}north\PYGZus{}polar\PYGZsq{})}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{P}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{triangle}\PYG{p}{(}\PYG{o}{*}\PYG{n}{c}\PYG{o}{.}\PYG{n}{nucleus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(None, \PYGZsq{}equatorial\PYGZsq{})}

\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{cell}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{triangle}\PYG{p}{(}\PYG{o}{*}\PYG{n}{c}\PYG{o}{.}\PYG{n}{nucleus}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{inverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(1, \PYGZsq{}south\PYGZus{}polar\PYGZsq{})}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{xyz() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{xyz()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.xyz}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{xyz}}}
{\sphinxparam{\DUrole{n}{u}}\sphinxparamcomma \sphinxparam{\DUrole{n}{v}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lonlat}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Given a point \sphinxtitleref{(u, v)} in the planar image of the rHEALPix projection,
project it back to the ellipsoid and return its 3D rectangular
coordinates.
If \sphinxtitleref{lonlat} = True, then assume \sphinxtitleref{(u, v)} is a longitude\sphinxhyphen{}latitude
point.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003\PYGZus{}RADIANS}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{xyz}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{lonlat}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.70710678118655, 0.0, 0.70710678118655)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{xyz\_cube() (rhealpixdggs.dggs.RHEALPixDGGS method)@\spxentry{xyz\_cube()}\spxextra{rhealpixdggs.dggs.RHEALPixDGGS method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RHEALPixDGGS.xyz_cube}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{xyz\_cube}}}
{\sphinxparam{\DUrole{n}{u}}\sphinxparamcomma \sphinxparam{\DUrole{n}{v}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lonlat}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Given a point \sphinxtitleref{(u, v)} in the planar version of this rHEALPix DGGS,
fold the rHEALPix image into a cube centered at the origin,
and return the resulting point’s 3D rectangular coordinates.
If \sphinxtitleref{lonlat} = True, then assume \sphinxtitleref{(u, v)} is a longitude\sphinxhyphen{}latitude
point.

\sphinxAtStartPar
EXAMPLES:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{rdggs} \PYG{o}{=} \PYG{n}{UNIT\PYGZus{}003}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{my\PYGZus{}round}\PYG{p}{(}\PYG{n}{rdggs}\PYG{o}{.}\PYG{n}{xyz\PYGZus{}cube}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{(0.78539816339745, 0.0, \PYGZhy{}0.78539816339745)}
\end{sphinxVerbatim}

\end{fulllineitems}


\end{fulllineitems}

\index{RhealPolygon (class in rhealpixdggs.dggs)@\spxentry{RhealPolygon}\spxextra{class in rhealpixdggs.dggs}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{dggs:rhealpixdggs.dggs.RhealPolygon}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{rhealpixdggs.dggs.}}\sphinxbfcode{\sphinxupquote{RhealPolygon}}}
{\sphinxparam{\DUrole{n}{rdggs=\textless{}rhealpixdggs.dggs.RHEALPixDGGS object\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{suid\_list=None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\DUrole{xref}{\DUrole{std}{\DUrole{std-ref}{genindex}}}

\item {} 
\sphinxAtStartPar
\DUrole{xref}{\DUrole{std}{\DUrole{std-ref}{modindex}}}

\item {} 
\sphinxAtStartPar
\DUrole{xref}{\DUrole{std}{\DUrole{std-ref}{search}}}

\end{itemize}

\begin{sphinxthebibliography}{CaRo2007}
\bibitem[GRS2013]{introduction:grs2013}
\sphinxAtStartPar
Robert Gibb, Alexander Raichev, Michael Speth, \sphinxhref{https://github.com/manaakiwhenua/rhealpixdggs-2013-gibb-raichev-speth/blob/master/rhealpix\_dggs\_preprint.pdf}{The rHEALPix discrete global grid system}, in preparation, 2013.
\bibitem[CaRo2007]{pj_healpix:caro2007}
\sphinxAtStartPar
Mark R. Calabretta and Boudewijn F. Roukema, Mapping on the healpix grid, Monthly Notices of the Royal Astronomical Society 381 (2007), no. 2, 865\textendash{}872.
\end{sphinxthebibliography}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{r}
\item\relax\sphinxstyleindexentry{rhealpixdggs.dggs}\sphinxstyleindexpageref{dggs:\detokenize{module-rhealpixdggs.dggs}}
\item\relax\sphinxstyleindexentry{rhealpixdggs.ellipsoids}\sphinxstyleindexpageref{ellipsoids:\detokenize{module-rhealpixdggs.ellipsoids}}
\item\relax\sphinxstyleindexentry{rhealpixdggs.pj\_healpix}\sphinxstyleindexpageref{pj_healpix:\detokenize{module-rhealpixdggs.pj_healpix}}
\item\relax\sphinxstyleindexentry{rhealpixdggs.pj\_rhealpix}\sphinxstyleindexpageref{pj_rhealpix:\detokenize{module-rhealpixdggs.pj_rhealpix}}
\item\relax\sphinxstyleindexentry{rhealpixdggs.projection\_wrapper}\sphinxstyleindexpageref{projection_wrapper:\detokenize{module-rhealpixdggs.projection_wrapper}}
\item\relax\sphinxstyleindexentry{rhealpixdggs.utils}\sphinxstyleindexpageref{utils:\detokenize{module-rhealpixdggs.utils}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}