import{P as ne,c as Kt}from"../chunks/BBLiiV7J.js";import{s as _t,H as Nt,l as Ct,j as zt,I as jt,g as qt,d as oe,J as bt,K as Pt,L as ie,N as se,O as Ot,T as At,Q as Mt,e as vt,c as gt,u as re,k as Gt,b as le,f as ce,h as ue}from"../chunks/BQEJVgPf.js";import{p as et,c as z,r as b,t as tt,a as at,f as ct,n as Bt,aB as de,s as I,aC as St,y as Ut,v as Q,q as it,aD as he,j as r,l as q,A as me,e as Vt,x as st}from"../chunks/Cj1lW-Gn.js";import{t as C,a as T,c as Ht,e as Tt,s as nt,b as fe}from"../chunks/CYqQTk2G.js";import{s as Lt,r as Rt,i as ut,a as ot,d as pt,c as Jt,p as ve,b as Wt}from"../chunks/ljGkMZWX.js";import{S as Qt,a as yt,T as ge,f as xt,A as pe}from"../chunks/BeFiKZji.js";import{i as _e}from"../chunks/DvURYSWS.js";import{p as lt}from"../chunks/OoM2i83e.js";import{r as ht}from"../chunks/Cbydd1_z.js";import{a as ye,g as xe}from"../chunks/eiVfNh6z.js";import{S as we}from"../chunks/D-YNTJ6i.js";import{a as be}from"../chunks/IZXhtOqv.js";import{a as Yt}from"../chunks/CD_eMhOw.js";function Se(a){const t=new Map;return a.forEach(o=>{const l=o.annotation_label.annotation_label_name;l&&t.set(l,(t.get(l)||0)+1)}),t}var ze=C("<div><!></div>");function $t(a,t){et(t,!0);var o=ze(),l=z(o);_t(l,()=>t.children),b(o),tt(v=>zt(o,1,v),[()=>Nt(Ct("rounded-lg border border-gray-800 bg-black",t.className))]),T(a,o),at()}var ke=C("<div><!></div>");function te(a,t){et(t,!0);var o=ke(),l=z(o);_t(l,()=>t.children),b(o),tt(v=>zt(o,1,v),[()=>Nt(Ct("p-4",t.className))]),T(a,o),at()}function Ae(a,t){et(t,!0);let o=Rt(t,["$$slots","$$events","$$legacy"]);jt(a,Lt({name:"move-left"},()=>o,{iconNode:[["path",{d:"M6 8L2 12L6 16"}],["path",{d:"M2 12H22"}]],children:(v,f)=>{var u=Ht(),y=ct(u);_t(y,()=>t.children??Bt),T(v,u)},$$slots:{default:!0}})),at()}function Me(a,t){et(t,!0);let o=Rt(t,["$$slots","$$events","$$legacy"]);jt(a,Lt({name:"zoom-in"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(v,f)=>{var u=Ht(),y=ct(u);_t(y,()=>t.children??Bt),T(v,u)},$$slots:{default:!0}})),at()}function Te(a,t){et(t,!0);let o=Rt(t,["$$slots","$$events","$$legacy"]);jt(a,Lt({name:"zoom-out"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(v,f)=>{var u=Ht(),y=ct(u);_t(y,()=>t.children??Bt),T(v,u)},$$slots:{default:!0}})),at()}var Ee=C('<button class="absolute left-4 top-1/2 z-30 -translate-y-1/2 rounded-full bg-black/30 p-2 text-white opacity-50 transition-opacity hover:opacity-100" aria-label="Previous sample"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg></button>'),Pe=C('<button class="absolute right-4 top-1/2 z-30 -translate-y-1/2 rounded-full bg-black/30 p-2 text-white opacity-50 transition-opacity hover:opacity-100" aria-label="Next sample"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"></path></svg></button>'),Ie=C("<!> <!>",1);function De(a,t){et(t,!1);const o=()=>{lt.data.sampleAdjacents.next&&St(ht.toSample(lt.data.sampleAdjacents.next.sample_id))},l=()=>{lt.data.sampleAdjacents.previous&&St(ht.toSample(lt.data.sampleAdjacents.previous.sample_id))},v=w=>{switch(w.key){case"ArrowRight":o();break;case"ArrowLeft":l();break}},f=!!lt.data.sampleAdjacents.previous,u=!!lt.data.sampleAdjacents.next;_e();var y=Ie();Tt("keydown",de,v);var g=ct(y);{var x=w=>{var A=Ee();Tt("click",A,l),T(w,A)};ut(g,w=>{f&&w(x)})}var S=I(g,2);{var B=w=>{var A=Pe();Tt("click",A,o),T(w,A)};ut(S,w=>{u&&w(B)})}T(a,y),at()}var Ne=C('<div class="h-full w-full overflow-hidden"><div class="sample relative h-full w-full"><div class="absolute right-4 top-2 z-30"><!></div> <!> <!></div></div>'),Ce=C('<div class="flex h-full w-full flex-col space-y-4"><div class="flex w-full items-center space-x-4"><!> <h2 data-testid="sample-filename" class="text-xl font-semibold tracking-tight"> </h2></div> <!> <div class="flex min-h-0 flex-1 gap-4"><div class="flex-1"><!></div> <div class="relative w-[375px]"><!></div></div></div>');function je(a,t){et(t,!0);const[o,l]=Jt(),v=()=>pt(x,"$lastGridType",o),f=()=>pt(A,"$selectedSampleAnnotationCropIds",o),u=()=>pt(S,"$selectedSampleIds",o),y=()=>pt(H,"$isHidden",o),g=q(()=>{const c=lt.data.annotationId;if(c)return t.sample.annotations.find(_=>_.annotation_id===c)}),{lastGridType:x,selectedSampleIds:S,toggleSampleSelection:B,toggleSampleAnnotationCropSelection:w,selectedSampleAnnotationCropIds:A,getDatasetVersion:Z}=qt(),{isHidden:H,handleKeyEvent:E}=ye(),{getKeyboardShortcuts:h}=oe();let D=it(""),N=it(!0);const V=()=>{var c;(c=t.sample)!=null&&c.dataset_id?St(v()==="samples"?ht.toSamples(t.sample.dataset_id):ht.toAnnotations(t.sample.dataset_id)):St("/")},L=c=>{switch(c.key){case h.go_back:V();break;case" ":c.preventDefault(),r(G)&&r(g)?w(r(g).annotation_id):B(t.sample.sample_id);break}E(c)};Ut(async()=>{var c;(c=t.sample)!=null&&c.dataset_id&&Q(D,ot(await Z(t.sample.dataset_id))),window.addEventListener("keydown",L),window.addEventListener("keyup",E)}),he(()=>{window.removeEventListener("keydown",L),window.removeEventListener("keyup",E)});const R=()=>{Q(N,!r(N))},G=q(()=>!!r(g));var p=Ce(),j=z(p),k=z(j);const U=q(()=>v()==="samples"?ht.toSamples(t.sample.dataset_id):ht.toAnnotations(t.sample.dataset_id));bt(k,{variant:"outline",get href(){return r(U)},children:(c,_)=>{Ae(c,{})},$$slots:{default:!0}});var F=I(k,2),O=z(F);b(F),b(j);var e=I(j,2);Qt(e,{class:"mb-4 bg-border-hard"});var i=I(e,2),n=z(i),s=z(n);$t(s,{className:"h-full",children:(c,_)=>{te(c,{className:"h-full",children:(M,W)=>{var P=Ne(),Y=z(P),X=z(Y),K=z(X);{var J=dt=>{const kt=q(()=>f().has(r(g).annotation_id));Yt(dt,{onSelect:()=>w(r(g).annotation_id),get isSelected(){return r(kt)}})},mt=dt=>{const kt=q(()=>u().has(t.sample.sample_id));Yt(dt,{onSelect:()=>B(t.sample.sample_id),get isSelected(){return r(kt)}})};ut(K,dt=>{r(G)&&r(g)?dt(J):dt(mt,!1)})}b(X);var Zt=I(X,2);De(Zt,{});var ee=I(Zt,2);const ae=q(()=>`${ne+t.sample.file_path_abs}${r(D)?`?v=${r(D)}`:""}`);ea(ee,{get imageURL(){return r(ae)},get annotations(){return t.sample.annotations},get imageWidth(){return t.sample.width},get imageHeight(){return t.sample.height},get showOnlySelectedAnnotation(){return r(N)},get selectedAnnotation(){return r(g)},get hideAnnotations(){return y()}}),b(Y),b(P),T(M,P)},$$slots:{default:!0}})},$$slots:{default:!0}}),b(n);var d=I(n,2),m=z(d);da(m,{get sample(){return t.sample},get selectedAnnotation(){return r(g)},get showOnlySelectedAnnotation(){return r(N)},toggleShowOnlySelectedAnnotation:R}),b(d),b(i),b(p),tt(()=>nt(O,`Filename: "${t.sample.file_name??""}"`)),T(a,p),at(),l()}function $(a){return typeof a=="string"?new Pt([[document.querySelector(a)]],[document.documentElement]):new Pt([[a]],ie)}function Oe(a){let t;for(;t=a.sourceEvent;)a=t;return a}function rt(a,t){if(a=Oe(a),t===void 0&&(t=a.currentTarget),t){var o=t.ownerSVGElement||t;if(o.createSVGPoint){var l=o.createSVGPoint();return l.x=a.clientX,l.y=a.clientY,l=l.matrixTransform(t.getScreenCTM().inverse()),[l.x,l.y]}if(t.getBoundingClientRect){var v=t.getBoundingClientRect();return[a.clientX-v.left-t.clientLeft,a.clientY-v.top-t.clientTop]}}return[a.pageX,a.pageY]}function Be(a){return new Pt([document.querySelectorAll(a)],[document.documentElement])}const It={capture:!0,passive:!1};function Dt(a){a.preventDefault(),a.stopImmediatePropagation()}function He(a){var t=a.document.documentElement,o=$(a).on("dragstart.drag",Dt,It);"onselectstart"in t?o.on("selectstart.drag",Dt,It):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Le(a,t){var o=a.document.documentElement,l=$(a).on("dragstart.drag",null);t&&(l.on("click.drag",Dt,It),setTimeout(function(){l.on("click.drag",null)},0)),"onselectstart"in o?l.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}var Re=1e-12;function Ft(a){return((a=Math.exp(a))+1/a)/2}function Ze(a){return((a=Math.exp(a))-1/a)/2}function Ge(a){return((a=Math.exp(2*a))-1)/(a+1)}const Ve=function a(t,o,l){function v(f,u){var y=f[0],g=f[1],x=f[2],S=u[0],B=u[1],w=u[2],A=S-y,Z=B-g,H=A*A+Z*Z,E,h;if(H<Re)h=Math.log(w/x)/t,E=function(G){return[y+G*A,g+G*Z,x*Math.exp(t*G*h)]};else{var D=Math.sqrt(H),N=(w*w-x*x+l*H)/(2*x*o*D),V=(w*w-x*x-l*H)/(2*w*o*D),L=Math.log(Math.sqrt(N*N+1)-N),R=Math.log(Math.sqrt(V*V+1)-V);h=(R-L)/t,E=function(G){var p=G*h,j=Ft(L),k=x/(o*D)*(j*Ge(t*p+L)-Ze(L));return[y+k*A,g+k*Z,x*j/Ft(t*p+L)]}}return E.duration=h*1e3*t/Math.SQRT2,E}return v.rho=function(f){var u=Math.max(.001,+f),y=u*u,g=y*y;return a(u,y,g)},v}(Math.SQRT2,2,4),wt=a=>()=>a;function We(a,{sourceEvent:t,target:o,transform:l,dispatch:v}){Object.defineProperties(this,{type:{value:a,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:l,enumerable:!0,configurable:!0},_:{value:v}})}function Et(a){a.stopImmediatePropagation()}function ft(a){a.preventDefault(),a.stopImmediatePropagation()}function Ye(a){return(!a.ctrlKey||a.type==="wheel")&&!a.button}function Fe(){var a=this;return a instanceof SVGElement?(a=a.ownerSVGElement||a,a.hasAttribute("viewBox")?(a=a.viewBox.baseVal,[[a.x,a.y],[a.x+a.width,a.y+a.height]]):[[0,0],[a.width.baseVal.value,a.height.baseVal.value]]):[[0,0],[a.clientWidth,a.clientHeight]]}function Xt(){return this.__zoom||Ot}function Xe(a){return-a.deltaY*(a.deltaMode===1?.05:a.deltaMode?1:.002)*(a.ctrlKey?10:1)}function Ke(){return navigator.maxTouchPoints||"ontouchstart"in this}function qe(a,t,o){var l=a.invertX(t[0][0])-o[0][0],v=a.invertX(t[1][0])-o[1][0],f=a.invertY(t[0][1])-o[0][1],u=a.invertY(t[1][1])-o[1][1];return a.translate(v>l?(l+v)/2:Math.min(0,l)||Math.max(0,v),u>f?(f+u)/2:Math.min(0,f)||Math.max(0,u))}function Ue(){var a=Ye,t=Fe,o=qe,l=Xe,v=Ke,f=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],y=250,g=Ve,x=se("start","zoom","end"),S,B,w,A=500,Z=150,H=0,E=10;function h(e){e.property("__zoom",Xt).on("wheel.zoom",p,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",k).filter(v).on("touchstart.zoom",U).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(e,i,n,s){var d=e.selection?e.selection():e;d.property("__zoom",Xt),e!==d?L(e,i,n,s):d.interrupt().each(function(){R(this,arguments).event(s).start().zoom(null,typeof i=="function"?i.apply(this,arguments):i).end()})},h.scaleBy=function(e,i,n,s){h.scaleTo(e,function(){var d=this.__zoom.k,m=typeof i=="function"?i.apply(this,arguments):i;return d*m},n,s)},h.scaleTo=function(e,i,n,s){h.transform(e,function(){var d=t.apply(this,arguments),m=this.__zoom,c=n==null?V(d):typeof n=="function"?n.apply(this,arguments):n,_=m.invert(c),M=typeof i=="function"?i.apply(this,arguments):i;return o(N(D(m,M),c,_),d,u)},n,s)},h.translateBy=function(e,i,n,s){h.transform(e,function(){return o(this.__zoom.translate(typeof i=="function"?i.apply(this,arguments):i,typeof n=="function"?n.apply(this,arguments):n),t.apply(this,arguments),u)},null,s)},h.translateTo=function(e,i,n,s,d){h.transform(e,function(){var m=t.apply(this,arguments),c=this.__zoom,_=s==null?V(m):typeof s=="function"?s.apply(this,arguments):s;return o(Ot.translate(_[0],_[1]).scale(c.k).translate(typeof i=="function"?-i.apply(this,arguments):-i,typeof n=="function"?-n.apply(this,arguments):-n),m,u)},s,d)};function D(e,i){return i=Math.max(f[0],Math.min(f[1],i)),i===e.k?e:new At(i,e.x,e.y)}function N(e,i,n){var s=i[0]-n[0]*e.k,d=i[1]-n[1]*e.k;return s===e.x&&d===e.y?e:new At(e.k,s,d)}function V(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function L(e,i,n,s){e.on("start.zoom",function(){R(this,arguments).event(s).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(s).end()}).tween("zoom",function(){var d=this,m=arguments,c=R(d,m).event(s),_=t.apply(d,m),M=n==null?V(_):typeof n=="function"?n.apply(d,m):n,W=Math.max(_[1][0]-_[0][0],_[1][1]-_[0][1]),P=d.__zoom,Y=typeof i=="function"?i.apply(d,m):i,X=g(P.invert(M).concat(W/P.k),Y.invert(M).concat(W/Y.k));return function(K){if(K===1)K=Y;else{var J=X(K),mt=W/J[2];K=new At(mt,M[0]-J[0]*mt,M[1]-J[1]*mt)}c.zoom(null,K)}})}function R(e,i,n){return!n&&e.__zooming||new G(e,i)}function G(e,i){this.that=e,this.args=i,this.active=0,this.sourceEvent=null,this.extent=t.apply(e,i),this.taps=0}G.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,i){return this.mouse&&e!=="mouse"&&(this.mouse[1]=i.invert(this.mouse[0])),this.touch0&&e!=="touch"&&(this.touch0[1]=i.invert(this.touch0[0])),this.touch1&&e!=="touch"&&(this.touch1[1]=i.invert(this.touch1[0])),this.that.__zoom=i,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var i=$(this.that).datum();x.call(e,this.that,new We(e,{sourceEvent:this.sourceEvent,target:h,transform:this.that.__zoom,dispatch:x}),i)}};function p(e,...i){if(!a.apply(this,arguments))return;var n=R(this,i).event(e),s=this.__zoom,d=Math.max(f[0],Math.min(f[1],s.k*Math.pow(2,l.apply(this,arguments)))),m=rt(e);if(n.wheel)(n.mouse[0][0]!==m[0]||n.mouse[0][1]!==m[1])&&(n.mouse[1]=s.invert(n.mouse[0]=m)),clearTimeout(n.wheel);else{if(s.k===d)return;n.mouse=[m,s.invert(m)],Mt(this),n.start()}ft(e),n.wheel=setTimeout(c,Z),n.zoom("mouse",o(N(D(s,d),n.mouse[0],n.mouse[1]),n.extent,u));function c(){n.wheel=null,n.end()}}function j(e,...i){if(w||!a.apply(this,arguments))return;var n=e.currentTarget,s=R(this,i,!0).event(e),d=$(e.view).on("mousemove.zoom",M,!0).on("mouseup.zoom",W,!0),m=rt(e,n),c=e.clientX,_=e.clientY;He(e.view),Et(e),s.mouse=[m,this.__zoom.invert(m)],Mt(this),s.start();function M(P){if(ft(P),!s.moved){var Y=P.clientX-c,X=P.clientY-_;s.moved=Y*Y+X*X>H}s.event(P).zoom("mouse",o(N(s.that.__zoom,s.mouse[0]=rt(P,n),s.mouse[1]),s.extent,u))}function W(P){d.on("mousemove.zoom mouseup.zoom",null),Le(P.view,s.moved),ft(P),s.event(P).end()}}function k(e,...i){if(a.apply(this,arguments)){var n=this.__zoom,s=rt(e.changedTouches?e.changedTouches[0]:e,this),d=n.invert(s),m=n.k*(e.shiftKey?.5:2),c=o(N(D(n,m),s,d),t.apply(this,i),u);ft(e),y>0?$(this).transition().duration(y).call(L,c,s,e):$(this).call(h.transform,c,s,e)}}function U(e,...i){if(a.apply(this,arguments)){var n=e.touches,s=n.length,d=R(this,i,e.changedTouches.length===s).event(e),m,c,_,M;for(Et(e),c=0;c<s;++c)_=n[c],M=rt(_,this),M=[M,this.__zoom.invert(M),_.identifier],d.touch0?!d.touch1&&d.touch0[2]!==M[2]&&(d.touch1=M,d.taps=0):(d.touch0=M,m=!0,d.taps=1+!!S);S&&(S=clearTimeout(S)),m&&(d.taps<2&&(B=M[0],S=setTimeout(function(){S=null},A)),Mt(this),d.start())}}function F(e,...i){if(this.__zooming){var n=R(this,i).event(e),s=e.changedTouches,d=s.length,m,c,_,M;for(ft(e),m=0;m<d;++m)c=s[m],_=rt(c,this),n.touch0&&n.touch0[2]===c.identifier?n.touch0[0]=_:n.touch1&&n.touch1[2]===c.identifier&&(n.touch1[0]=_);if(c=n.that.__zoom,n.touch1){var W=n.touch0[0],P=n.touch0[1],Y=n.touch1[0],X=n.touch1[1],K=(K=Y[0]-W[0])*K+(K=Y[1]-W[1])*K,J=(J=X[0]-P[0])*J+(J=X[1]-P[1])*J;c=D(c,Math.sqrt(K/J)),_=[(W[0]+Y[0])/2,(W[1]+Y[1])/2],M=[(P[0]+X[0])/2,(P[1]+X[1])/2]}else if(n.touch0)_=n.touch0[0],M=n.touch0[1];else return;n.zoom("touch",o(N(c,_,M),n.extent,u))}}function O(e,...i){if(this.__zooming){var n=R(this,i).event(e),s=e.changedTouches,d=s.length,m,c;for(Et(e),w&&clearTimeout(w),w=setTimeout(function(){w=null},A),m=0;m<d;++m)c=s[m],n.touch0&&n.touch0[2]===c.identifier?delete n.touch0:n.touch1&&n.touch1[2]===c.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(c=rt(c,this),Math.hypot(B[0]-c[0],B[1]-c[1])<E)){var _=$(this).on("dblclick.zoom");_&&_.apply(this,arguments)}}}return h.wheelDelta=function(e){return arguments.length?(l=typeof e=="function"?e:wt(+e),h):l},h.filter=function(e){return arguments.length?(a=typeof e=="function"?e:wt(!!e),h):a},h.touchable=function(e){return arguments.length?(v=typeof e=="function"?e:wt(!!e),h):v},h.extent=function(e){return arguments.length?(t=typeof e=="function"?e:wt([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),h):t},h.scaleExtent=function(e){return arguments.length?(f[0]=+e[0],f[1]=+e[1],h):[f[0],f[1]]},h.translateExtent=function(e){return arguments.length?(u[0][0]=+e[0][0],u[1][0]=+e[1][0],u[0][1]=+e[0][1],u[1][1]=+e[1][1],h):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},h.constrain=function(e){return arguments.length?(o=e,h):o},h.duration=function(e){return arguments.length?(y=+e,h):y},h.interpolate=function(e){return arguments.length?(g=e,h):g},h.on=function(){var e=x.on.apply(x,arguments);return e===x?h:e},h.clickDistance=function(e){return arguments.length?(H=(e=+e)*e,h):Math.sqrt(H)},h.tapDistance=function(e){return arguments.length?(E=+e,h):E},h}function Je(a,t){let o=a.scaleIndependentXForm;o||(o=a.scaleIndependentXForm=t.createSVGTransform(),a.transform.baseVal.appendItem(o));const l=a.parentNode;if(l){const v=l.getScreenCTM();if(v){const f=v.inverse().multiply(t.getScreenCTM());f.e=f.f=0,o.setMatrix(f)}}}var Qe=C('<div class="pointer-events-auto absolute bottom-0 left-1 z-20 flex select-none items-center gap-1 rounded-lg bg-muted bg-opacity-80 shadow-md backdrop-blur-sm"><!> <div class="h-6 w-px bg-white bg-opacity-20"></div> <!> <div class="w-[32px] text-center text-sm text-muted-foreground" data-testid="zoom-level"> </div> <!></div>');function $e(a,t){var o=Qe(),l=z(o);bt(l,{variant:"ghost","data-testid":"zoom-reset",size:"sm",get onclick(){return t.onZoomReset},get disabled(){return t.isResetDisabled},children:(g,x)=>{me();var S=fe("Reset");T(g,S)},$$slots:{default:!0}});var v=I(l,4);bt(v,{title:"zoom out",variant:"ghost",size:"icon","data-testid":"zoom-out",get onclick(){return t.onZoomOut},get disabled(){return t.isZoominDisabled},children:(g,x)=>{Te(g,{class:"h-4 w-4"})},$$slots:{default:!0}});var f=I(v,2),u=z(f);b(f);var y=I(f,2);bt(y,{title:"zoom in",variant:"ghost",size:"icon","data-testid":"zoom-in",get onclick(){return t.onZoomIn},get disabled(){return t.isZoomoutDisabled},children:(g,x)=>{Me(g,{class:"h-4 w-4"})},$$slots:{default:!0}}),b(o),tt(g=>nt(u,`${g??""}%`),[()=>Math.round(t.scale*100)]),T(a,o)}var ta=C('<div class="relative flex h-full w-full select-none items-center justify-center"><!> <svg class="z-10 h-full w-full cursor-grab" preserveAspectRatio="xMidYMid meet"><g><image></image><g></g></g></svg> <svg class="pointer-events-none absolute inset-0" preserveAspectRatio="xMidYMid meet"></svg></div>');function ea(a,t){et(t,!0);let o=it(null),l=it(null);const v=ve(t,"hideAnnotations",3,!1);let f=it(800),u=it(600);Vt(()=>{if(!r(o))return;Q(f,ot(r(o).clientWidth)),Q(u,ot(r(o).clientHeight));const p=new ResizeObserver(()=>{r(o)&&(Q(f,ot(r(o).clientWidth)),Q(u,ot(r(o).clientHeight)))});return p.observe(r(o)),()=>p.disconnect()});const y=q(()=>t.selectedAnnotation&&t.showOnlySelectedAnnotation?[t.selectedAnnotation]:t.annotations),g=10,x=q(()=>{const p={x:0,y:0,width:t.imageWidth,height:t.imageHeight};if(t.selectedAnnotation){const{x:j,y:k,width:U,height:F}=t.selectedAnnotation;return{x:Math.round(Math.max(0,j-g)),y:Math.round(Math.max(0,k-g)),width:Math.round(Math.min(t.imageWidth-j,U+g*2)),height:Math.round(Math.min(t.imageHeight-k,F+g*2))}}return p});let S=it(ot({k:1,x:0,y:0}));const B=q(()=>{if(!r(o))return 1;const p=r(f)/t.imageWidth,j=r(u)/t.imageHeight,k=Math.min(p,j);return r(S).k*k});let w=it(null);const A=()=>{r(o)&&(Q(w,ot(Ue().on("zoom",p=>{Q(S,ot(p.transform))}).filter(p=>(!p.ctrlKey||p.type==="wheel")&&!p.button&&!(p.type==="mousedown"&&p.button===2)).wheelDelta(p=>-p.deltaY*.002))),$(r(o)).call(r(w)).on("dblclick.zoom",null))},Z=p=>{if(!r(o)||!r(w))return;const j=p?1.5:.75;$(r(o)).transition().duration(300).call(r(w).scaleBy,j)},H=()=>{!r(o)||!r(w)||$(r(o)).transition().duration(300).call(r(w).transform,Ot)};Ut(()=>{A()}),Vt(()=>{r(S).k,Be(".unscaled").each(function(){Je(this,r(l))})});var E=ta(),h=z(E);$e(h,{get scale(){return r(B)},onZoomIn:()=>Z(!0),onZoomOut:()=>Z(!1),onZoomReset:H});var D=I(h,2),N=z(D),V=z(N),L=I(V);let R;vt(L,21,()=>r(y),p=>p.annotation_id,(p,j)=>{we(p,{get annotation(){return r(j)},showLabel:!0,get imageWidth(){return t.imageWidth}})}),b(L),b(N),b(D),Wt(D,p=>Q(o,p),()=>r(o));var G=I(D,2);gt(G,"viewBox","0 0 1024 768"),Wt(G,p=>Q(l,p),()=>r(l)),b(E),tt(p=>{gt(D,"viewBox",`${r(x).x} ${r(x).y} ${r(x).width} ${r(x).height}`),gt(N,"transform",`translate(${r(S).x}, ${r(S).y}) scale(${r(S).k})`),gt(V,"href",t.imageURL),R=zt(L,0,"svelte-10ogmpt",null,R,p)},[()=>({"annotations-hidden":v()})]),T(a,E),at()}var aa=C('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),na=C('<div class="flex flex-col gap-4"><!> <div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div></div>'),oa=C("<div> </div>"),ia=C('<div class="flex gap-1"></div>'),sa=C('<div class="flex items-center justify-between gap-2 rounded-sm bg-card px-5 py-2"><div class="text-sm"> </div> <div class="text-sm"> </div></div>'),ra=C('<div class="flex flex-col gap-2"></div>'),la=C('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),ca=C('<div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div>'),ua=C('<div class="flex-none"><div class="mb-2.5 text-lg font-semibold">Sample details</div> <!></div> <div class="flex h-full min-h-0 flex-col space-y-2 overflow-y-auto dark:[color-scheme:dark]"><!> <!> <!> <!></div>',1);function da(a,t){et(t,!0);const[o,l]=Jt(),v=()=>pt(f,"$taskMap",o),{taskMap:f}=re(),u=t.sample.tags,y=q(()=>Se(t.sample.annotations)),g=q(()=>t.selectedAnnotation&&t.selectedAnnotation.annotation_task_id&&v().has(t.selectedAnnotation.annotation_task_id)?v().get(t.selectedAnnotation.annotation_task_id).is_prediction:!1),x=q(()=>[{label:"Height:",value:xt(t.sample.height)+"px"},{label:"Width:",value:xt(t.sample.width)+"px"},{label:"Filename:",value:t.sample.file_name},{label:"Filepath:",value:t.sample.file_path_abs}]),S=q(()=>t.selectedAnnotation?[{label:"Height:",value:xt(Math.round(t.selectedAnnotation.height))+"px"},{label:"Width:",value:xt(Math.round(t.selectedAnnotation.width))+"px"},{label:"Annotation:",value:t.selectedAnnotation.annotation_label.annotation_label_name},{label:"Type:",value:"Bounding box"},{label:"Status:",value:r(g)?"Prediction":"Ground Truth"}]:[]);$t(a,{className:"h-full",children:(B,w)=>{te(B,{className:"h-full flex flex-col",children:(A,Z)=>{var H=ua(),E=ct(H),h=I(z(E),2);Qt(h,{class:"mb-4 bg-border-hard"}),b(E);var D=I(E,2),N=z(D);{var V=k=>{yt(k,{title:"Selected annotation",children:(U,F)=>{var O=na(),e=z(O);be(e,{name:"show-all",label:"Show only selected annotation",get isChecked(){return t.showOnlySelectedAnnotation},helperText:"Hides other annotations for clarity.",get onCheckedChange(){return t.toggleShowOnlySelectedAnnotation}});var i=I(e,2);vt(i,21,()=>r(S),({label:n,value:s})=>n,(n,s)=>{let d=()=>r(s).label,m=()=>r(s).value;var c=aa(),_=ct(c),M=z(_,!0);b(_);var W=I(_,2),P=z(W,!0);b(W),tt(()=>{nt(M,d()),nt(P,m())}),T(n,c)}),b(i),b(O),T(U,O)}})};ut(N,k=>{t.selectedAnnotation&&k(V)})}var L=I(N,2);{var R=k=>{yt(k,{title:"Tags",icon:ge,children:(U,F)=>{var O=ia();vt(O,21,()=>u,Gt,(e,i)=>{var n=oa(),s=z(n,!0);b(n),tt(d=>{zt(n,1,d),nt(s,r(i).name)},[()=>Nt(Ct("inline rounded-lg bg-card px-2 py-2 text-xs"))]),T(e,n)}),b(O),T(U,O)}})};ut(L,k=>{u.length>0&&k(R)})}var G=I(L,2);{var p=k=>{yt(k,{title:"Annotations",children:(U,F)=>{var O=ra();vt(O,21,()=>r(y),Gt,(e,i)=>{var n=sa(),s=z(n),d=z(s,!0);b(s);var m=I(s,2),c=z(m);b(m),b(n),tt(_=>{nt(d,r(i)[0]),le(m,`color: ${_??""};`),nt(c,`(${r(i)[1]??""})`)},[()=>xe(r(i)[0]).color]),T(e,n)}),b(O),T(U,O)}})};ut(G,k=>{r(y).size>0&&k(p)})}var j=I(G,2);yt(j,{title:"Metadata",children:(k,U)=>{var F=ca();vt(F,21,()=>r(x),({label:O,value:e})=>O,(O,e)=>{let i=()=>r(e).label,n=()=>r(e).value;var s=la(),d=ct(s),m=z(d,!0);b(d);var c=I(d,2),_=z(c,!0);b(c),tt(()=>{nt(m,i()),nt(_,n())}),T(O,s)}),b(F),T(k,F)}}),b(D),T(A,H)},$$slots:{default:!0}})},$$slots:{default:!0}}),at(),l()}const ha=async({sample_id:a})=>{const t={data:void 0,error:void 0};try{const o=await Kt.GET("/api/samples/{sample_id}",{params:{path:{sample_id:a}}});if(o.error)throw new Error(JSON.stringify(o.error,null,2));if(!o.data)throw new Error("No data");t.data=o.data}catch(o){t.error="Error loading sample: "+String(o)}return t},ma=async({sample_id:a,body:t})=>{const o={data:void 0,error:void 0};try{const l=await Kt.POST("/api/samples/{sample_id}/adjacent",{params:{path:{sample_id:a}},body:t});if(l.error)throw new Error(JSON.stringify(l.error,null,2));if(!l.data)throw new Error("No data");o.data=l.data}catch(l){o.error="Error loading sample adjacents: "+String(l)}return o},fa=async({params:a,url:t})=>{var A,Z,H,E;const{sample_id:o}=a,{data:l,error:v}=await ha({sample_id:o}),{selectedAnnotationFilterIds:f,textEmbedding:u,dimensions:y}=qt(),{tagsSelected:g}=ce({dataset_id:l==null?void 0:l.dataset_id,kind:["sample"]}),x=st(u),{data:S,error:B}=await ma({sample_id:o,body:{filters:{annotation_labels_ids:Array.from(st(f)),tag_ids:Array.from(st(g)),width:{min:(A=st(y))==null?void 0:A.min_width,max:(Z=st(y))==null?void 0:Z.max_width},height:{min:(H=st(y))==null?void 0:H.min_height,max:(E=st(y))==null?void 0:E.max_height}},text_embedding:x==null?void 0:x.embedding}});return{sample:l,annotationId:t.searchParams.get("annotationId"),error:v||B,sampleAdjacents:S}},Ia=Object.freeze(Object.defineProperty({__proto__:null,load:fa},Symbol.toStringTag,{value:"Module"}));var va=C("<a>Go home</a>"),ga=C('<div class="flex h-full w-full space-x-4 px-4 pb-4"><div class="h-full w-full space-y-6 rounded-[1vw] bg-card p-4"><!></div></div>');function Da(a,t){et(t,!0);const o=ue(),[l,v]=o;var f=ga(),u=z(f),y=z(u);{var g=S=>{je(S,{get sample(){return t.data.sample}})},x=S=>{pe(S,{title:"Sample not found",children:(B,w)=>{var A=va();tt(Z=>gt(A,"href",Z),[()=>l("/",void 0)]),T(B,A)}})};ut(y,S=>{t.data.sample?S(g):S(x,!1)})}b(u),b(f),T(a,f),at()}export{Da as component,Ia as universal};
