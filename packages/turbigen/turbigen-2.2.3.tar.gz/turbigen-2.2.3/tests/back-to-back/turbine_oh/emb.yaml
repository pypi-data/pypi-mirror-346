# A 2D turbine cascade with prescribed flow angles

# All files relating to the case are held in a working directory
workdir: tests/back-to-back/turbine_oh/emb/0081
 
inlet:
  Po: 1e5
  To: 300.
  cp: 1005.
  gamma: 1.4

mean_line:
  type: turbine_cascade
  span: [0.01, 0.011]
  Alpha: [-40., 65.0]
  Ma2: 0.6
  Yh: 0.029
  htr: 0.9

# Annulus shape using meridional aspect ratios
annulus:
  AR_gap: [1.0, 1.0]  # Span to inlet/exit boundary distance
  AR_chord: 2.0  # Span to chord

# Computational mesh generation
mesh:
  type: oh  # Mesh topology
  yplus: 20.0  # Non-dimensional wall distance
  resolution_factor: 0.5  # Non-dimensional wall distance
  nsmooth: 500
  nsmooth_multigrid: 200
  remote_host: gp-111
  remote_workdir: /mnt/data/jb753/meshing/
  ni_outlet: 97
  blade_streamwise_weight: 5.0

# Blade shapes
blades:
  - Co: 0.7
    Re_surf: 4e5
    sections:
      - spf: 0.5
        q_thick: [0.03, 0.08, 0.3, 0., 0.00, 0.18]
        qstar_camber: [-10., 2., 1.0, 1.0, 0.0]

# CFD solver
solver:
  type: embsolve
  n_step: 5000
  n_step_avg: 1000
  nstep_damp: -1
  # CFL: 0.4
  # smooth4: 0.02

post_process:
  plot_convergence:
  # contour:
  #   coord: m
  #   value: 2.05
  #   variable: Ys
  #   N_passage: 2
  #   step: 0.05
  #   lim: [0., 0.50]
  contour:
    coord: spf
    value: .51
    variable: Cp
    N_passage: 2
    show_mesh: true
  plot_pressure_distributions:
    row_spf: [[0.5,],]
    write_raw: true
    compare: tests/back-to-back/turbine/ts3/post/pressure_distributions_raw.npz
    offset: 0
