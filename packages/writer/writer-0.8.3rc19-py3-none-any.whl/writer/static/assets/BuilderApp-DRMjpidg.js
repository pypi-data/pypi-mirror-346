function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./SharedMoreDropdown-0NR9l-1t.js","./index-C7odhkMa.js","./index-Cqy1XuJG.css","./SharedMoreDropdown-BWKlox8E.css","./BuilderEmbeddedCodeEditor-BVavrMYM.js","./BuilderEmbeddedCodeEditor-DiDqfWdt.css","./BuilderSettings-nTe4nU5k.js","./instancePath-BsbOTTI8.js","./useComponentDescription-X_W6P_20.js","./marked.esm-273vDTCT.js","./BuilderSettings-Bpazx1AJ.css","./BuilderSidebar-BJNYcXaH.js","./BuilderSidebar-BLAsr7hk.css","./ComponentRenderer-BBAYt90m.js","./ComponentRenderer-B76bKRZO.css","./BuilderInstanceTracker-CukPzdXf.js","./BuilderInstanceTracker-BECcXNnW.css","./BuilderInsertionOverlay-NcmpqbiH.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-CUz_42eK.js","./BuilderInsertionLabel-_YS5WPfq.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as R,i as V,a as N,r as j,u as re,c as b,o as n,e as p,f as a,y as U,C as z,_ as O,s as I,N as g,O as ge,P as Be,Q as He,R as dt,w as $e,n as de,S as he,T as Ze,U as Ge,x,W as Z,b as A,t as L,V as Ue,X as S,Y as Te,l as Le,q as Ie,v as Oe,H as ze,I as fe,Z as ut,$ as ve,a0 as Ve,a1 as J,a2 as Se,a3 as se,a4 as me,a5 as Re,a6 as ct,a7 as pt,a8 as Ne,G as ae,z as H,A as ie,a9 as vt,aa as mt,ab as ft,ac as Ye,ad as _t,ae as ee,M as te,af as De,ag as yt,ah as gt,ai as ht,aj as bt,ak as wt,al as kt,D as Ct,am as Bt,an as $t,ao as Ke}from"./index-C7odhkMa.js";import{marked as St}from"./marked.esm-273vDTCT.js";const Dt={class:"BuilderSwitcher"},Tt=R({__name:"BuilderSwitcher",setup(e){const i=V(N.core),t=V(N.builderManager);let d=j(null);const r=re(i),_=f=>{const c=t.getMode();if(c!=f){switch(d.value=f,f){case"ui":r.track("nav_ui_opened");break;case"preview":r.track("nav_preview_opened");break;case"blueprints":r.track("nav_blueprints_opened");break}t.setMode(f),(f=="preview"||c=="blueprints"||f=="blueprints")&&t.setSelection(null)}},h=b(()=>t.getMode());return(f,c)=>(n(),p("div",Dt,[a("button",{"data-automation-action":"set-mode-ui",class:z({active:h.value=="ui"}),type:"button",onClick:c[0]||(c[0]=y=>_("ui"))},c[3]||(c[3]=[a("i",{class:"icon material-symbols-outlined"}," brush ",-1),U(" UI ")]),2),a("button",{"data-automation-action":"set-mode-blueprints",class:z({active:h.value=="blueprints"}),type:"button",onClick:c[1]||(c[1]=y=>_("blueprints"))},c[4]||(c[4]=[a("i",{class:"icon material-symbols-outlined"},"linked_services",-1),U(" Blueprints ")]),2),a("button",{class:z({active:h.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:c[2]||(c[2]=y=>_("preview"))},c[5]||(c[5]=[a("i",{class:"icon material-symbols-outlined"}," preview ",-1),U(" Preview ")]),2)]))}}),Lt=O(Tt,[["__scopeId","data-v-60f9fbac"]]),It={class:"BuilderStateExplorer"},Pt=R({__name:"BuilderStateExplorer",setup(e){const i=V(N.core);return(t,d)=>(n(),p("div",It,[I(ge,{data:g(i).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),xt=O(Pt,[["__scopeId","data-v-eafb7b97"]]),At=R({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){return(i,t)=>(n(),p("div",{class:z(["WdsStateDotState",`WdsStateDotState--${e.state}`])},null,2))}}),Je=O(At,[["__scopeId","data-v-4eacfc04"]]),ye=Be([]);function Pe(){function e(t){ye.value=ye.value.filter(d=>d.id!==t)}function i(t){const d=new Date().getTime();ye.value=[...ye.value,{...t,id:d}],t.closable||setTimeout(()=>e(d),t.delayMs??3e3)}return{pushToast:i,removeToast:e,toasts:He(ye)}}function Ft(e){const i=new AbortController,t=re(e),d=Ze(),{pushToast:r}=Pe(),{writerApi:_,apiBaseUrl:h}=dt({signal:i.signal}),f=j(!1),c=Be(),y=Be(),B=b(()=>e.writerApplication.value!==void 0),C=b(()=>{var w;return Number((w=e.writerApplication.value)==null?void 0:w.organizationId)||void 0}),o=b(()=>{var w;return(w=e.writerApplication.value)==null?void 0:w.id}),s=b(()=>{var M,W;const w=(W=(M=y.value.writer)==null?void 0:M.teamIds)==null?void 0:W[0];if(!w)return;const q=`/organization/${C.value}/team/${w}/framework/${o.value}`;return new URL(q,h)}),v=b(()=>{if(!(!C.value||!o.value))return new URL(`/aistudio/organization/${C.value}/agent/${o.value}/deploy`,h)}),u=b(()=>y.value.lastDeployedAt?new Date(y.value.lastDeployedAt):void 0),m=b(()=>!!(B.value&&y.value)),l=b(()=>{var w;return((w=y.value)==null?void 0:w.status)==="deployed"});$e(e.writerApplication,k,{immediate:!0}),de(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await k()},{signal:i.signal})});async function k(){if(e.writerApplication.value)try{y.value=await _.fetchApplicationDeployment(C.value,o.value)}catch(w){d.error("Failed to fetch deployment information",w),y.value=void 0}}async function $(){if(e.writerApplication.value){if(!l.value){const w=`/aistudio/organization/${C.value}/agent/${o.value}/deploy`,q=new URL(w,h);window.open(q,"_blank");return}f.value=!0,c.value=void 0;try{await _.publishApplication(C.value,o.value,{applicationVersionId:y.value.applicationVersion.id,applicationVersionDataId:y.value.applicationVersionData.id}),await k();const w=s.value?{label:"See it live",func:()=>window.open(s.value,"_blank"),icon:"open_in_new"}:void 0;r({type:"success",message:"agent deployed",action:w}),t.track("deployment_succeeded")}catch(w){t.track("deployment_failed",{error:String(w)}),c.value=w,d.error("Deploy failed",w),r({type:"error",message:"deploy failed"})}finally{f.value=!1}}}return he(()=>i.abort()),{isCloudApp:B,canDeploy:m,writerDeployUrl:v,hasBeenPublished:l,publishApplication:$,isDeploying:He(f),lastDeployedAt:u}}const Et={class:"BuilderHeader"},Mt=["href"],Rt={key:1,src:Ge,alt:"Writer Framework logo"},Ut={class:"BuilderHeader__toolbar"},Wt=R({__name:"BuilderHeader",setup(e){const i=V(N.core),t=V(N.builderManager),d=j(!1),r=re(i),{undo:_,redo:h,getUndoRedoSnapshot:f}=Te(i,t),{canDeploy:c,isDeploying:y,publishApplication:B,hasBeenPublished:C,lastDeployedAt:o,writerDeployUrl:s}=Ft(i),v=b(()=>f()),u=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function m(){r.track("nav_deploy_clicked"),C.value?l.value=!0:await B()}const l=j(!1),k=[{desc:"Cancel",fn:()=>l.value=!1},{desc:"Yes, deploy changes",fn:async()=>{l.value=!1,await B()}}],$=b(()=>o.value?`Editor Last saved ${u.format(o.value)}`:void 0),w=b(()=>C.value===!0?"Deploy changes":(C.value===!1,"Configure deployment")),q=b(()=>{let F="";switch(i.syncHealth.value){case"offline":F+="Offline. Not syncing.";break;case"connected":F+="Online. Syncing...";break;case"idle":F+="Sync not initialised.";break;case"suspended":F+="Sync suspended.";break}return i.featureFlags.value.length>0&&(F+=` Feature flags: ${i.featureFlags.value.join(", ")}`),F}),M=b(()=>{switch(i.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});function W(){r.track("nav_state_explorer_opened"),d.value=!0}return(F,P)=>(n(),p("div",Et,[g(s)?(n(),p("a",{key:0,href:g(s).toString(),target:"_blank",class:"BuilderHeader__goBack"},P[3]||(P[3]=[a("img",{src:Ge,alt:"Writer Framework logo"},null,-1)]),8,Mt)):(n(),p("img",Rt)),I(Lt),P[8]||(P[8]=a("div",{class:"gap"},null,-1)),a("div",Ut,[I(Z,{variant:"secondary",size:"smallIcon","data-automation-key":"undo","data-writer-tooltip":v.value.isUndoAvailable?`Undo: ${v.value.undoDesc}`:"Nothing to undo",disabled:!v.value.isUndoAvailable,"data-writer-tooltip-placement":"bottom",onClick:P[0]||(P[0]=Q=>g(_)())},{default:x(()=>P[4]||(P[4]=[a("i",{class:"material-symbols-outlined"},"undo",-1)])),_:1},8,["data-writer-tooltip","disabled"]),I(Z,{variant:"secondary",size:"smallIcon","data-automation-key":"redo","data-writer-tooltip":v.value.isRedoAvailable?`Redo: ${v.value.redoDesc}`:"Nothing to redo",disabled:!v.value.isRedoAvailable,"data-writer-tooltip-placement":"bottom",onClick:P[1]||(P[1]=Q=>g(h)())},{default:x(()=>P[5]||(P[5]=[a("i",{class:"material-symbols-outlined"},"redo",-1)])),_:1},8,["data-writer-tooltip","disabled"]),I(Z,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:W},{default:x(()=>P[6]||(P[6]=[a("i",{class:"material-symbols-outlined"},"mystery",-1)])),_:1}),g(c)?(n(),A(Z,{key:0,size:"small",loading:g(y),"data-writer-tooltip":$.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:m},{default:x(()=>[U(L(w.value)+" ",1),l.value?(n(),A(Ue,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:k},{default:x(()=>P[7]||(P[7]=[a("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):S("",!0)]),_:1},8,["loading","data-writer-tooltip"])):S("",!0),I(Je,{state:M.value,"data-writer-tooltip":q.value,"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),d.value?(n(),A(Ue,{key:1,title:"State Explorer","display-close-button":"",onClose:P[2]||(P[2]=Q=>d.value=!1)},{default:x(()=>[I(xt)]),_:1})):S("",!0)])]))}}),Ot=O(Wt,[["__scopeId","data-v-4be84bba"]]),zt={class:"text"},qt=200,Vt=4,Nt=R({__name:"BuilderTooltip",setup(e){const i=Le("rootEl"),t=j(!1),d=j(null);let r=null,_=null;const h=j("top"),f=j({top:0,left:0});async function c(){if(!r||(d.value=r.dataset.writerTooltip,!d.value))return;const s=r.dataset.writerTooltipGap?parseInt(r.dataset.writerTooltipGap):Vt;if(t.value=y(r),!t.value)return;await fe();const{x:v,y:u,width:m,height:l}=r.getBoundingClientRect(),{width:k,height:$}=i.value.getBoundingClientRect();switch(h.value){case"top":f.value.top=u-$-s,f.value.left=v+m/2-k/2;break;case"right":f.value.top=u+l/2-$/2,f.value.left=v+m+s;break;case"left":f.value.left=v-k-s,f.value.top=u+l/2-$/2;break;case"bottom":f.value.top=u+l+s,f.value.left=v+m/2-k/2;break}}function y(s){return s.getAttribute("data-writer-tooltip-strategy")==="overflow"?s.scrollWidth>s.clientWidth:!0}function B(s){const u=s.target.closest("[data-writer-tooltip]");if(u)r!==u&&(t.value=!1);else{t.value=!1,r=null;return}r=u,h.value=r.dataset.writerTooltipPlacement??"top",setTimeout(()=>C(u),qt)}async function C(s){s===r&&(_==null||_.disconnect(),_=new MutationObserver(c),_.observe(r,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),c())}const o=b(()=>{const{top:s,left:v}=f.value;return{top:`${s}px`,left:`${v}px`}});return de(()=>{document.documentElement.addEventListener("mouseover",B)}),he(()=>{document.documentElement.removeEventListener("mouseover",B),_==null||_.disconnect()}),(s,v)=>Ie((n(),p("div",{ref_key:"rootEl",ref:i,class:"BuilderTooltip",style:ze(o.value)},[a("div",{class:z(["arrow",h.value])},null,2),a("div",zt,L(d.value),1)],4)),[[Oe,t.value]])}}),Kt=O(Nt,[["__scopeId","data-v-7ba01c7c"]]),jt={class:"BuilderAsyncLoader"},Ht=R({__name:"BuilderAsyncLoader",setup(e){return(i,t)=>(n(),p("div",jt,[I(ut)]))}}),le=O(Ht,[["__scopeId","data-v-bb820549"]]),Zt=""+new URL("art-paper-WsD9P5Lu.svg",import.meta.url).href,Gt="data:image/svg+xml,%3csvg%20width='120'%20height='160'%20viewBox='0%200%20120%20160'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='16.0273'%20y='89.9375'%20width='80.1422'%20height='55.209'%20rx='7.12375'%20fill='%23A95EF8'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M47.9297%20135.352H13.3542C9.41988%20135.352%206.23047%20138.541%206.23047%20142.475V152.27C6.23047%20156.205%209.41987%20159.394%2013.3542%20159.394H97.9487C101.883%20159.394%20105.072%20156.205%20105.072%20152.27V142.475C105.072%20138.541%20101.883%20135.352%2097.9487%20135.352H63.3737C63.3737%20136.103%2063.174%20136.848%2062.7859%20137.542C62.3979%20138.237%2061.8291%20138.868%2061.112%20139.399C60.395%20139.931%2059.5437%20140.352%2058.6068%20140.64C57.6699%20140.928%2056.6658%20141.076%2055.6517%20141.076C54.6376%20141.076%2053.6335%20140.928%2052.6966%20140.64C51.7597%20140.352%2050.9085%20139.931%2050.1914%20139.399C49.4744%20138.868%2048.9056%20138.237%2048.5175%20137.542C48.1295%20136.848%2047.9297%20136.103%2047.9297%20135.352Z'%20fill='%23721CC9'/%3e%3crect%20x='27.6055'%20y='103.295'%20width='56.99'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='38.293'%20y='112.199'%20width='35.6187'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='46.3047'%20y='121.104'%20width='19.5903'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20y='10.3691'%20width='40.0647'%20height='30.0485'%20rx='7.12375'%20transform='rotate(-15%200%2010.3691)'%20fill='%23EDE2FF'/%3e%3cpath%20d='M15.0475%2021.5308C15.2249%2020.8687%2016.0526%2020.6469%2016.5373%2021.1316L21.9902%2026.5846C22.475%2027.0693%2022.2532%2027.897%2021.5911%2028.0744L14.1421%2030.0703C13.48%2030.2477%2012.8741%2029.6418%2013.0515%2028.9797L15.0475%2021.5308Z'%20fill='%23D4B2F7'/%3e%3cpath%20d='M25.3727%2010.4659C25.5501%209.80376%2026.3777%209.58199%2026.8624%2010.0667L34.9516%2018.1559C35.4363%2018.6406%2035.2145%2019.4682%2034.5524%2019.6456L23.5024%2022.6065C22.8403%2022.7839%2022.2344%2022.178%2022.4118%2021.5159L25.3727%2010.4659Z'%20fill='%23D4B2F7'/%3e%3crect%20x='68.2383'%20y='23.1523'%20width='54.3186'%20height='40.0711'%20rx='7.12375'%20transform='rotate(17.6282%2068.2383%2023.1523)'%20fill='%23D4B2F7'/%3e%3cpath%20d='M72.1976%2052.7145C71.7609%2052.9406%2071.5902%2053.4779%2071.8163%2053.9146C72.0424%2054.3514%2072.5797%2054.5221%2073.0164%2054.296L72.1976%2052.7145ZM82.1128%2048.5839L82.8321%2048.059L82.3818%2047.4419L81.7034%2047.7931L82.1128%2048.5839ZM86.9945%2055.274L86.2752%2055.7989L86.71%2056.3948L87.3764%2056.0784L86.9945%2055.274ZM104.339%2047.7366C104.504%2047.2733%20104.262%2046.764%20103.798%2046.599L96.2487%2043.9102C95.7854%2043.7452%2095.2761%2043.987%2095.1111%2044.4503C94.9461%2044.9136%2095.1879%2045.4229%2095.6512%2045.5879L102.362%2047.9779L99.972%2054.6888C99.807%2055.1521%20100.049%2055.6614%20100.512%2055.8264C100.975%2055.9914%20101.485%2055.7496%20101.65%2055.2863L104.339%2047.7366ZM73.0164%2054.296L82.5222%2049.3746L81.7034%2047.7931L72.1976%2052.7145L73.0164%2054.296ZM81.3935%2049.1087L86.2752%2055.7989L87.7138%2054.7491L82.8321%2048.059L81.3935%2049.1087ZM87.3764%2056.0784L103.882%2048.2423L103.118%2046.6334L86.6126%2054.4696L87.3764%2056.0784Z'%20fill='%23F6EFFD'/%3e%3c/svg%3e",We=150;function Yt(e){const i=j(structuredClone(ve(e.sourceFiles.value)));$e(e.sourceFiles,(l,k)=>{let $=!1,w=structuredClone(ve(i.value));const q=h(k).map(t);for(const M of Ve(l)){const W=J(M,k),F=J(M,l);if(me(F))continue;if(W===void 0||Se(F)){w=Re(M,w,structuredClone(ve(F))),$=!0;continue}if(!se(W))continue;const P=!W.complete&&F.complete,Q=W.complete&&F.complete;if(!P&&!Q)continue;const ue=t(M);if(q.includes(ue))continue;const ne=J(M,w);se(ne)&&($=!0,ne.complete=!0,ne.content=F.content)}for(const M of ct(w))J(M,l)===void 0&&(w=pt(M,w),$=!0);$&&(i.value=w)});function t(l){return l.join("/")}const d=Be(),r=b(()=>Array.from(Ve(i.value))),_=b(()=>h(e.sourceFiles.value));function h(l){return r.value.filter(k=>{const $=J(k,i.value);if(Se($))return!1;if(!se($))return!0;const w=J(k,l);return se(w)?!$.complete||!w.complete?!1:$.content!==w.content:!0})}const f=b(()=>{if(d.value!==void 0)return J(d.value,i.value)}),c=b({get(){return se(f.value)?f.value.content:""},set(l){if(d.value===void 0)return;const k=J(d.value,i.value);se(k)&&(k.content=l)}});function y(l=1){const k=`new-file-${l}.txt`;return J([k],i.value)?y(l+1):k}async function B(){const l=y();i.value=Re([l],ve(i.value)),s([l]),await e.sendCreateSourceFileRequest([l])}const C=b(()=>{var k;return(k=d.value)!=null&&k.length?d.value.at(-1).split(".").at(-1):""}),o=b(()=>{switch(C.value){case"py":return"python";case"md":case"markdown":return"markdown";default:return C.value}});function s(l){d.value=l,se(f.value)&&!f.value.complete&&e.requestSourceFileLoading(l)}async function v(l){if(!(!d.value||!f.value)&&(f.value.type==="file"&&await e.sendCodeSaveRequest(c.value,d.value),l)){const k=[...ve(d.value)];d.value=void 0;try{await e.sendRenameSourceFileRequest(k,l)}catch($){throw d.value=k,$}s(l)}}function u(l){return new Promise((k,$)=>{const w=new FileReader;w.addEventListener("loadend",q=>{const M=q.target.result;if(M instanceof ArrayBuffer){const W=String.fromCharCode.apply(null,new Uint8Array(M));return k(W)}k(M.split(",")[1])}),w.addEventListener("error",()=>{$()}),w.readAsDataURL(l)})}async function m(l){const k=We*1024*1024;if(l.size>k)throw Error(`Cannot upload file bigger than ${We}mb`);const $=[l.name];if(J($,e.sourceFiles.value))throw Error(`The file ${l.name} already exists`);i.value=Re($,ve(i.value),{type:"binary",uploading:!0});const w=await u(l);await e.sendFileUploadRequest($,w)}return{code:c,sourceFileDraft:i,fileOpen:f,filepathOpen:d,pathsUnsaved:_,openedFileLanguage:o,save:v,upload:m,openFile:s,openNewFile:B,getNewFilename:y}}const Jt={class:"BuilderDropFileZone"},Xt=R({__name:"BuilderDropFileZone",setup(e){return(i,t)=>(n(),p("div",Jt,[t[0]||(t[0]=a("img",{src:Gt,alt:"Drop file illustration"},null,-1)),t[1]||(t[1]=a("h2",null,"Upload files",-1)),a("p",null,"Files can be up to "+L(g(We))+"mb",1)]))}}),Qt=O(Xt,[["__scopeId","data-v-92e0a561"]]),ea={class:"BuilderPanel__collapser"},ta={class:"material-symbols-outlined"},aa={class:"BuilderPanel__title"},na={class:"BuilderPanel__titleCompanion"},oa=["data-order"],sa={key:0,class:"BuilderPanel__contents__leftPanel"},la={class:"BuilderPanel__actions"},ia={class:"BuilderPanel__actionsCompanion"},ra={class:"material-symbols-outlined"},da={class:"BuilderPanel__mainContents"},ua=R({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=V(N.builderManager),d=["code","log"],r=e,_=i,h=b(()=>r.enableDropFile&&f.value),f=j(!1);function c(u,m){r.enableDropFile&&(u.preventDefault(),f.value=m)}function y(u){if(f.value=!1,!r.enableDropFile)return;u.preventDefault();const m=[];if(u.dataTransfer.items)for(const l of u.dataTransfer.items){if(l.kind!=="file")continue;const k=l.getAsFile();k&&m.push(k)}else for(const l of u.dataTransfer.files)m.push(l);m.length>0&&_("filesDrop",m)}const B=b(()=>!t.openPanels.value.has(r.panelId)),C=b(()=>d.indexOf(r.panelId));function o(u){if(t.openPanels.value.has(u)){t.openPanels.value.delete(u),_("openned",!1);return}t.openPanels.value.add(u),_("openned",!0)}function s(u){const m=mt(u);if(m&&u.key==r.keyboardShortcutKey.toLowerCase()){u.preventDefault(),o(r.panelId);return}r.actions.forEach(l=>{if(!l.keyboardShortcut)return;const{key:k,modifierKey:$}=l.keyboardShortcut;k.toLowerCase()==u.key&&(!m&&$||(u.preventDefault(),l.callback()))})}function v(u){if(!u)return"";let m=" (";return u.modifierKey&&(m+=Ne()),m+=u.key,m+=")",m}return de(async()=>{document.addEventListener("keydown",s)}),he(()=>{document.removeEventListener("keydown",s)}),(u,m)=>(n(),p("div",{class:z(["BuilderPanel",{collapsed:B.value}])},[a("div",ea,[I(Z,{variant:"neutral",size:"smallIcon","data-automation-action":"toggle-panel","data-automation-key":u.panelId,"data-writer-tooltip":`Toggle ${u.name} (${g(Ne)()}${u.keyboardShortcutKey})`,onClick:m[0]||(m[0]=l=>o(u.panelId))},{default:x(()=>[a("i",ta,L(B.value?"expand_less":"expand_more"),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),a("div",aa,L(u.name),1),a("div",na,[ae(u.$slots,"titleCompanion",{},void 0,!0)]),B.value?S("",!0):(n(),A(vt,{key:0,to:u.contentsTeleportEl},[a("div",{style:ze({order:C.value}),"data-order":C.value,class:z(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":u.enableLeftPanel,"BuilderPanel__contents--dropingFile":h.value}]),onDrop:y,onDragover:m[1]||(m[1]=l=>c(l,!0)),onDragleave:m[2]||(m[2]=l=>c(l,!1))},[h.value?(n(),A(Qt,{key:0})):(n(),p(H,{key:1},[u.enableLeftPanel?(n(),p("div",sa,[ae(u.$slots,"leftPanel",{},void 0,!0)])):S("",!0),a("div",la,[a("div",ia,[ae(u.$slots,"actionsCompanion",{},void 0,!0)]),(n(!0),p(H,null,ie(u.actions,(l,k)=>(n(),A(Z,{key:k,"data-writer-tooltip":l.name+v(l.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:l.isDisabled,onClick:l.callback},{default:x(()=>[a("i",ra,L(l.icon),1)]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),a("div",da,[ae(u.$slots,"default",{},void 0,!0)])],64))],46,oa)],8,["to"]))],2))}}),Xe=O(ua,[["__scopeId","data-v-a30a0b3d"]]),ca={class:"BuilderTree"},pa=["draggable","data-automation-key","aria-expanded"],va={class:"material-symbols-outlined"},ma=["data-writer-tooltip"],fa={key:1,class:"BuilderTree__main__dropdown"},_a={class:"BuilderTree__children"},ya=R({__name:"BuilderTree",props:{name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0}},emits:{expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},setup(e,{expose:i,emit:t}){const d=ee(()=>te(()=>import("./SharedMoreDropdown-0NR9l-1t.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),r=e,_=t;i({expand:B,toggleCollapse:C});const h=j(!1),f=j(!1),c=b(()=>!r.matched),y=b(()=>!r.hasChildren);function B(){h.value=!1,_("expandBranch")}function C(o){o??(o=!h.value),o!==h.value&&(h.value=o)}return(o,s)=>(n(),p("div",ca,[a("div",{class:z(["BuilderTree__main",{selected:e.selected,notMatched:c.value,childless:y.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!h.value,onMouseenter:s[2]||(s[2]=v=>f.value=!0),onMouseleave:s[3]||(s[3]=v=>f.value=!1),onClick:s[4]||(s[4]=v=>o.$emit("select",v)),onKeydown:s[5]||(s[5]=Ye(v=>o.$emit("select",v),["enter"])),onDragover:s[6]||(s[6]=v=>o.$emit("dragover",v)),onDragstart:s[7]||(s[7]=v=>o.$emit("dragstart",v)),onDragend:s[8]||(s[8]=v=>o.$emit("dragend",v)),onDrop:s[9]||(s[9]=v=>o.$emit("drop",v))},[e.hasChildren?(n(),A(Z,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:s[0]||(s[0]=ft(v=>C(void 0),["stop"]))},{default:x(()=>[a("i",va,L(h.value?"expand_more":"expand_less"),1)]),_:1},8,["disabled"])):S("",!0),ae(o.$slots,"nameLeft",{},void 0,!0),a("span",{class:z(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},L(e.name),11,ma),ae(o.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&f.value?(n(),p("div",fa,[I(g(d),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:s[1]||(s[1]=v=>o.$emit("dropdownSelect",v))},null,8,["options"])])):S("",!0)],42,pa),I(_t,null,{default:x(()=>[Ie(a("div",_a,[ae(o.$slots,"children",{},void 0,!0)],512),[[Oe,!h.value&&e.hasChildren]])]),_:3})]))}}),ga=O(ya,[["__scopeId","data-v-fca510f3"]]),ha=["width","height","viewBox","aria-valuenow"],ba=["r","cx","cy","stroke","stroke-width"],wa=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],ka=R({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const i=e,t=b(()=>i.sizePx/2),d=b(()=>i.sizePx/2-i.strokeWidth/2),r=b(()=>2*Math.PI*d.value),_=b(()=>r.value*((100-i.progress)/100)),h=b(()=>`0 0 ${i.sizePx} ${i.sizePx}`);return(f,c)=>(n(),p("svg",{width:e.sizePx,height:e.sizePx,viewBox:h.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[a("circle",{r:d.value,cx:t.value,cy:t.value,fill:"transparent",stroke:g(De).Blue1,"stroke-width":e.strokeWidth},null,8,ba),a("circle",{r:d.value,cx:t.value,cy:t.value,fill:"transparent",stroke:g(De).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":r.value,"stroke-dashoffset":_.value},null,8,wa)],8,ha))}}),Ca=R({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const i=e,t=j(0);return de(()=>{let d;const r=_=>{d||(d=_);const h=_-d;t.value=Math.min(h/i.timeMs*100,100),t.value<100&&requestAnimationFrame(r)};requestAnimationFrame(r)}),(d,r)=>(n(),A(ka,{class:"BuilderCodePanelFileUploading",progress:t.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),Ba=O(Ca,[["__scopeId","data-v-449f2dac"]]),je=[{label:"Delete",value:"delete",icon:"delete"}],$a=R({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:i}){const t=e,d=i;function r(s){return s.join("/")}const _=b(()=>r(t.pathActive)),h=b(()=>t.pathsUnsaved.map(r)),f=b(()=>me(t.sourceFiles)?Object.entries(t.sourceFiles.children).sort((s,v)=>s[0].localeCompare(v[0])):[]);function c(s){const v=J([...t.path,s],t.sourceFiles);return Se(v)&&v.uploading}function y(s){const v=r([...t.path,s]);return h.value.includes(v)}function B(s){return r([...t.path,s])===_.value}function C(s){if(!me(t.sourceFiles)||c(s))return;const v=t.sourceFiles.children[s];me(v)||d("select",[...t.path,s])}function o(s,v){s==="delete"&&d("delete",[...t.path,v])}return(s,v)=>(n(),p("div",null,[(n(!0),p(H,null,ie(f.value,([u,m])=>(n(),A(ga,{key:u,name:u,matched:"","has-children":g(me)(m),selected:B(u),disabled:c(u),"right-click-options":je,"dropdown-options":g(me)(m)||g(Se)(m)?je:void 0,onSelect:l=>C(u),onDropdownSelect:l=>o(l,u)},yt({children:x(()=>[I(Qe,{"source-files":m,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,u],onSelect:v[0]||(v[0]=l=>s.$emit("select",l)),onDelete:v[1]||(v[1]=l=>s.$emit("delete",l))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[c(u)||y(u)?{name:"nameLeft",fn:x(()=>[c(u)?(n(),A(Ba,{key:0,"time-ms":2e3})):y(u)?(n(),A(Je,{key:1,state:"newDraft"})):S("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),Qe=O($a,[["__scopeId","data-v-42a4456e"]]),Sa=["disabled"],Da={key:0,class:"material-symbols-outlined"},Ta={class:"WdsButtonLink__text"},La={key:1,class:"material-symbols-outlined"},Ia=R({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disbaled:{type:Boolean}},setup(e){const i=e,t=b(()=>[`WdsButtonLink--variant-${i.variant}`,`WdsButtonLink--weight-${i.weight}`]);return(d,r)=>(n(),p("button",{class:z(["WdsButtonLink",t.value]),disabled:e.disbaled,role:"button"},[e.leftIcon?(n(),p("i",Da,L(e.leftIcon),1)):S("",!0),a("span",Ta,L(e.text),1),e.rightIcon?(n(),p("i",La,L(e.rightIcon),1)):S("",!0)],10,Sa))}}),et=O(Ia,[["__scopeId","data-v-27c92b97"]]),Pa={class:"BuilderCodePanelFileUploadBtn"},xa=R({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=Le("input"),d=i;function r(){var _;(_=t.value.files)!=null&&_.length&&d("selected",t.value.files)}return(_,h)=>(n(),p("form",Pa,[Ie(a("input",{ref_key:"input",ref:t,type:"file",multiple:"true",onChange:r},null,544),[[Oe,!1]]),I(et,{"left-icon":"upload",text:"Upload",onClick:h[0]||(h[0]=f=>g(t).click())})]))}}),Aa={class:"BuilderCodePanel__tree"},Fa={class:"BuilderCodePanel__tree__actions"},Ea={key:1,class:"BuilderCodePanel__noPreview"},Ma={class:"BuilderCodePanel__actionsCompanion"},Ra=R({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const i=ee(()=>te(()=>import("./SharedMoreDropdown-0NR9l-1t.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),t=ee({loader:()=>te(()=>import("./BuilderEmbeddedCodeEditor-BVavrMYM.js").then(T=>T.a),__vite__mapDeps([4,1,2,5]),import.meta.url),loadingComponent:le}),d=V(N.core),r=[{label:"Rename file",value:"rename",icon:"edit"},{label:"Delete file",value:"delete",icon:"delete"}],_=re(d),{sourceFileDraft:h,openFile:f,upload:c,openNewFile:y,code:B,openedFileLanguage:C,filepathOpen:o,fileOpen:s,pathsUnsaved:v,save:u}=Yt(d);async function m(T){await Promise.all([...T].map(l))}async function l(T){try{await c(T),$({type:"success",message:`File ${T.name} uploaded`})}catch(K){$({type:"error",message:K.message})}}const k=b(()=>{var T;return(T=s.value)==null?void 0:T.type}),{pushToast:$}=Pe(),w=Ze();function q(T){const K=new AbortController;de(()=>{document.addEventListener("keydown",async G=>{const Fe=G.metaKey||G.ctrlKey,Ee=G.key==="s"||G.key==="S";!Fe||!Ee||(G.preventDefault(),await T())},{signal:K.signal})}),he(()=>K.abort())}q(_e);const M=Le("filenameEl"),W=j(""),F=j(!1),P=b(()=>{var T;return((T=o.value)==null?void 0:T.join("/"))??""}),Q=b(()=>P.value!=="main.py"),ue=b(()=>P.value!==W.value),ne=b(()=>F.value||P.value==="main.py"),be=b(()=>ue.value?!1:o.value===void 0?!0:!v.value.map(T=>T.join("/")).includes(P.value));$e(o,()=>{var T;W.value=((T=o.value)==null?void 0:T.join("/"))??""}),$e(d.sessionTimestamp,()=>{F.value=!1});function xe(T){T&&(_.track("nav_code_opened"),o.value===void 0&&f(["main.py"]))}async function we(){var T;P.value!=="main.py"&&(await fe(),(T=M.value)==null||T.focus())}async function Ae(T){switch(T){case"rename":return we();case"delete":await Ce(o.value)}}async function ke(){await y(),we()}async function Ce(T){await d.sendDeleteSourceFileRequest(T),$({type:"success",message:"The file was deleted"}),o.value.join("/").startsWith(T.join("/"))&&f(["main.py"])}async function _e(){if(o.value===void 0)return $({type:"error",message:"There is no file open"});if(be.value)return $({type:"info",message:"There are not file changes to save"});F.value=!0;try{await u(ue.value?W.value.split("/"):void 0),$({type:"success",message:"The file was saved"}),_.track("nav_code_file_updated",{path:o.value})}catch(T){w.error("The file hasn't been saved.",T),$({type:"error",message:"The file hasn't been saved"});return}finally{F.value=!1}}return(T,K)=>(n(),A(Xe,{"panel-id":"code",name:"Code","contents-teleport-el":T.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"",onFilesDrop:m,onOpenned:xe},{leftPanel:x(()=>[a("div",Aa,[I(Qe,{"path-active":g(o),"paths-unsaved":g(v),"source-files":g(h),onAddFile:ke,onSelect:g(f),onDelete:Ce},null,8,["path-active","paths-unsaved","source-files","onSelect"]),a("div",Fa,[I(et,{"left-icon":"add",text:"Add file",onClick:ke}),I(xa,{onSelected:m})])])]),actionsCompanion:x(()=>[a("div",Ma,[I(gt,{ref_key:"filenameEl",ref:M,modelValue:W.value,"onUpdate:modelValue":K[1]||(K[1]=G=>W.value=G),disabled:!Q.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:Ye(_e,["enter"])},null,8,["modelValue","disabled"]),I(Z,{variant:"primary",size:"small",disabled:F.value||be.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:_e},{default:x(()=>K[3]||(K[3]=[a("i",{class:"material-symbols-outlined"},"keyboard_backspace",-1),U(" Save file ")])),_:1},8,["disabled"]),I(g(i),{disabled:ne.value,options:r,onSelect:Ae},null,8,["disabled"])])]),default:x(()=>[k.value==="file"?(n(),A(g(t),{key:0,modelValue:g(B),"onUpdate:modelValue":K[0]||(K[0]=G=>ht(B)?B.value=G:null),variant:"full",language:g(C),disabled:F.value},null,8,["modelValue","language","disabled"])):S("",!0),k.value==="binary"?(n(),p("div",Ea,K[2]||(K[2]=[a("img",{class:"BuilderCodePanel__noPreview__img",src:Zt},null,-1),a("p",{class:"BuilderCodePanel__noPreview__title"},"Can’t Preview File",-1),a("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):S("",!0)]),_:1},8,["contents-teleport-el"]))}}),Ua=O(Ra,[["__scopeId","data-v-59d54f01"]]),Wa={class:"BuiderLogBlueprintExecutionTrace"},Oa={key:0,class:"trace"},za={class:"type"},qa={key:0},Va={key:1},Na={class:"main"},Ka={key:0},ja={key:1},Ha={key:2},Za={key:3},Ga={class:"details"},Ya={class:"data","data-automation-key":"result"},Ja={key:1,class:"nothing"},Xa={class:"data","data-automation-key":"return-value"},Qa={class:"environment"},en={class:"data"},tn={key:1,class:"nothing"},an={class:"callStack"},nn={class:"eyebrow"},on=R({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:i}){const t=V(N.core),d=V(N.builderManager),r=re(t),_=i,{goToComponentParentPage:h}=Te(t,d),f=e,c=b(()=>{var o;const C=((o=f.executionItem.executionEnvironment)==null?void 0:o.call_stack)??[];return Object.fromEntries(C.map(s=>[s,t.getComponentById(s)]))}),y=b(()=>{var C;return((C=f.executionItem.executionEnvironment)==null?void 0:C.trace)??[]});de(()=>{r.track("blueprints_logs_trace_opened")});async function B(C){_("closeModal"),d.setMode("blueprints"),await fe(),h(C),await fe(),d.setSelection(C,void 0,"log")}return(C,o)=>{var s,v,u;return n(),p("div",Wa,[y.value.length>0?(n(),p("div",Oa,[(n(!0),p(H,null,ie(y.value,(m,l)=>(n(),p("div",{key:l,class:"traceEntry"},[a("div",za,[m.type=="functionCall"?(n(),p("span",qa,"⚡️")):S("",!0),m.type=="reasoning"?(n(),p("span",Va,"🧠")):S("",!0)]),a("div",Na,[m.thought?(n(),p("div",Ka,[o[0]||(o[0]=a("strong",null,"Thought.",-1)),U(" "+L(m.thought),1)])):S("",!0),m.action?(n(),p("div",ja,[o[1]||(o[1]=a("strong",null,"Action.",-1)),U(" "+L(m.action),1)])):S("",!0),m.name?(n(),p("div",Ha,L(m.name),1)):S("",!0),m.parameters?(n(),p("div",Za,[I(ge,{"hide-root":!0,data:m.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):S("",!0)])]))),128))])):S("",!0),a("div",Ga,[a("div",null,[o[2]||(o[2]=a("h3",null,"Result",-1)),o[3]||(o[3]=a("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),a("div",Ya,[(s=C.executionItem)!=null&&s.result?(n(),A(ge,{key:0,data:C.executionItem.result,"initial-depth":1,class:"data"},null,8,["data"])):(n(),p("div",Ja,"No result."))])]),a("div",null,[o[4]||(o[4]=a("h3",null,"Return value",-1)),o[5]||(o[5]=a("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),a("div",Xa,[(v=C.executionItem)!=null&&v.returnValue?(n(),A(ge,{key:0,data:C.executionItem.returnValue,"initial-depth":1,class:"data"},null,8,["data"])):(n(),p(H,{key:1},[U(" No return value. ")],64))])])]),a("div",Qa,[o[6]||(o[6]=a("h3",null,"Execution environment",-1)),o[7]||(o[7]=a("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),a("div",en,[(u=C.executionItem)!=null&&u.executionEnvironment?(n(),A(ge,{key:0,data:C.executionItem.executionEnvironment,"initial-depth":1,class:"data"},null,8,["data"])):(n(),p("div",tn,"Empty execution environment."))])]),a("div",an,[o[9]||(o[9]=a("h3",null,"Call stack",-1)),(n(!0),p(H,null,ie(c.value,(m,l)=>{var k,$,w;return n(),p("div",{key:l,class:z(["component",{active:l==C.executionItem.componentId}])},[a("div",null,[a("div",nn,[l==C.executionItem.componentId?(n(),p(H,{key:0},[U(" This block · ")],64)):S("",!0),U(" "+L(((k=g(t).getComponentDefinition(m==null?void 0:m.type))==null?void 0:k.name)??"Unavailable component")+" · Id: "+L(l),1)]),U(" "+L((($=m==null?void 0:m.content)==null?void 0:$.alias)??((w=g(t).getComponentDefinition(m==null?void 0:m.type))==null?void 0:w.name)??"Unavailable component"),1)]),m?(n(),A(Z,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:q=>B(l)},{default:x(()=>o[8]||(o[8]=[a("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):S("",!0)],2)}),128))])])}}}),sn=O(on,[["__scopeId","data-v-6ee8bb1e"]]),ln={class:"BuilderListItem"},rn=["viewBox"],dn=["d","stroke"],un=["d","stroke"],cn={class:"BuilderListItem__content"},pn=R({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:De.Blue2},colorLast:{type:String,required:!1,default:De.Blue2}},setup(e){const i=e,t=b(()=>i.height/2),d=b(()=>`0 0 17 ${i.height}`),r=b(()=>["M1 0",`V${t.value-8}`,`C1 ${t.value-4}.4183 4.58172 ${t.value} 9 ${t.value}`,"H17"].join(" ")),_=b(()=>[`M1 ${t.value-8}`,`V${i.height}`].join(" "));return(h,f)=>(n(),p("div",ln,[(n(),p("svg",{viewBox:d.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?S("",!0):(n(),p("path",{key:0,d:_.value,stroke:e.colorLast,"stroke-width":"1"},null,8,dn)),a("path",{d:r.value,stroke:e.color,"stroke-width":"1"},null,8,un)],8,rn)),a("div",cn,[ae(h.$slots,"default",{},void 0,!0)])]))}}),vn=O(pn,[["__scopeId","data-v-33f3edcd"]]),mn={class:"BuilderLogBlueprintExecution"},fn={class:"name"},_n={key:0},yn={class:"eyebrow"},gn={class:"outcome"},hn={class:"result"},bn={class:"time"},wn={key:0,class:"message markdown"},kn=R({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const i=V(N.core),t=V(N.builderManager),{goToComponentParentPage:d}=Te(i,t),r=e,_=j(null),h=b(()=>({summary:[...r.executionLog.summary.filter(B=>!!B.outcome).map(B=>({...B,component:i.getComponentById(B.componentId),componentDef:i.getComponentById(B.componentId)?i.getComponentDefinition(i.getComponentById(B.componentId).type):void 0}))]}));async function f(y){t.setMode("blueprints"),await fe(),d(y),await fe(),t.setSelection(y,void 0,"log")}function c(y){return y<0?"N/A":y<.1?"< 0.1s":`${y.toFixed(2)}s`}return(y,B)=>{const C=bt("dompurify-html");return n(),p("div",mn,[(n(!0),p(H,null,ie(h.value.summary,(o,s)=>(n(),A(vn,{key:s,"is-last":s+1===h.value.summary.length},{default:x(()=>{var v,u,m,l,k,$,w,q,M,W,F,P;return[a("div",{class:z(["itemWrapper",{"itemWrapper--first":s===0,"itemWrapper--last":s+1===h.value.summary.length}])},[a("div",{class:z(["item",{selected:g(t).isComponentIdSelected(o.componentId)}])},[a("div",fn,[(u=(v=o.component)==null?void 0:v.content)!=null&&u.alias?(n(),p("div",_n,[a("div",yn,L(((m=o.componentDef)==null?void 0:m.name)??"Unavailable component"),1),U(" "+L((k=(l=o.component)==null?void 0:l.content)==null?void 0:k.alias),1)])):(n(),p(H,{key:1},[U(L((($=o.componentDef)==null?void 0:$.name)??"Unavailable component"),1)],64)),o.component?(n(),A(Z,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:Q=>f(o.componentId)},{default:x(()=>B[1]||(B[1]=[a("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):S("",!0)]),a("div",gn,[o.outcome!=="in_progress"?(n(),p(H,{key:0},[a("div",{class:z(["ball",(M=(q=(w=o.componentDef)==null?void 0:w.outs)==null?void 0:q[o.outcome])==null?void 0:M.style])},null,2),U(" "+L(((P=(F=(W=o.componentDef)==null?void 0:W.outs)==null?void 0:F[o.outcome])==null?void 0:P.name)??o.outcome),1)],64)):(n(),p(H,{key:1},[B[2]||(B[2]=a("div",{class:"ballContainer"},[a("div",{class:"ball inProgress"})],-1)),B[3]||(B[3]=U(" In progress... "))],64))]),a("div",hn,[_.value==s?(n(),A(Ue,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>_.value=null}]},{default:x(()=>[I(sn,{"execution-item":o,onCloseModal:B[0]||(B[0]=()=>_.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):S("",!0),o.result||o.returnValue||o.executionEnvironment?(n(),A(Z,{key:1,variant:"special",size:"small",onClick:()=>_.value=s},{default:x(()=>B[4]||(B[4]=[a("i",{class:"material-symbols-outlined"},"find_in_page",-1),U(" Trace ")])),_:2},1032,["onClick"])):S("",!0)]),a("div",bn,L(c(o.executionTimeInSeconds)),1),o.message?Ie((n(),p("div",wn,null,512)),[[C,g(St).parse(o.message)]]):S("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),Cn=O(kn,[["__scopeId","data-v-d778122d"]]),Bn={class:"BuilderLogIndicator"},$n={key:0,class:"number error"},Sn={key:1,class:"number info"},Dn=R({__name:"BuilderLogIndicator",setup(e){const i=V(N.builderManager),t=b(()=>i.getLogEntries().reduce((d,r)=>(r.type in d||(d[r.type]=0),d[r.type]++,d),{}));return(d,r)=>(n(),p("div",Bn,[t.value.error>0?(n(),p("div",$n,[r[0]||(r[0]=a("div",{class:"icon"},[a("i",{class:"material-symbols-outlined"},"error")],-1)),U(" "+L(t.value.error??0),1)])):S("",!0),t.value.info>0?(n(),p("div",Sn,[r[1]||(r[1]=a("div",{class:"icon"},[a("i",{class:"material-symbols-outlined"},"info")],-1)),U(" "+L(t.value.info??0),1)])):S("",!0)]))}}),Tn=O(Dn,[["__scopeId","data-v-34a7a9ff"]]),Ln={key:0,class:"entries"},In={class:"icon"},Pn={key:0,class:"material-symbols-outlined"},xn={key:1,class:"material-symbols-outlined"},An={class:"title"},Fn={class:"time"},En={class:"content"},Mn={key:0,class:"codeContainer"},Rn={key:1,class:"emptyMessage"},Un=R({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const i=V(N.core),t=V(N.builderManager),d=re(i);function r(f){f&&d.track("nav_logs_opened")}const _=[{icon:"delete",name:"Clear log",callback:()=>{t.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],h=b(()=>t.getLogEntries());return(f,c)=>(n(),A(Xe,{"panel-id":"log",name:"Log","contents-teleport-el":f.contentsTeleportEl,actions:_,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:r},{titleCompanion:x(()=>[I(Tn)]),default:x(()=>[h.value.length>0?(n(),p("div",Ln,[(n(!0),p(H,null,ie(h.value,(y,B)=>(n(),p(H,{key:B},[a("div",{class:z(["entry",y.type])},[a("div",In,[y.type=="error"?(n(),p("i",Pn,"error")):(n(),p("i",xn,"info"))]),a("div",An,L(y.title)+L(y.repeated>0?` · Repeated ${y.repeated} times`:""),1),a("div",Fn,L(y.timestampReceived.toLocaleTimeString()),1),a("div",En,[U(L(y.message)+" ",1),y.code?(n(),p("div",Mn,[a("code",null,L(y.code),1)])):S("",!0)])],2),y.blueprintExecution?(n(),A(Cn,{key:0,"execution-log":y.blueprintExecution},null,8,["execution-log"])):S("",!0)],64))),128))])):S("",!0),h.value.length==0?(n(),p("div",Rn,c[0]||(c[0]=[a("div",null,[U(" Exceptions and other relevant messages will be shown here."),a("br"),U("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):S("",!0)]),_:1},8,["contents-teleport-el"]))}}),Wn=O(Un,[["__scopeId","data-v-dd30a100"]]),On={class:"switches"},zn=R({__name:"BuilderPanelSwitcher",setup(e){const i=V(N.builderManager),t=Le("screenEl");return(d,r)=>(n(),p("div",{class:z(["BuilderPanelSwitcher",{openPanels:g(i).openPanels.value.size>0}])},[a("div",{ref_key:"screenEl",ref:t,class:"screen"},null,512),a("div",On,[I(Ua,{"contents-teleport-el":g(t)},null,8,["contents-teleport-el"]),I(Wn,{"contents-teleport-el":g(t)},null,8,["contents-teleport-el"])])],2))}}),qn=O(zn,[["__scopeId","data-v-75a489c0"]]),Vn={class:"WdsToast__icon"},Nn={class:"material-symbols-outlined"},Kn={class:"material-symbols-outlined"},jn=R({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const i=e,t=b(()=>{switch(i.type){case"info":return"info";case"success":return"check";case"error":return"close";default:return"question_mark"}});return(d,r)=>(n(),p("div",{class:z(["WdsToast",`WdsToast--${e.type}`])},[a("div",Vn,[a("span",Nn,L(t.value),1)]),a("p",null,L(e.message),1),e.action?(n(),p("button",{key:0,class:"WdsToast__action",onClick:r[0]||(r[0]=(..._)=>e.action.func&&e.action.func(..._))},[U(L(e.action.label)+" ",1),a("span",Kn,L(e.action.icon),1)])):S("",!0),e.closable?(n(),A(Z,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:r[1]||(r[1]=_=>d.$emit("close"))},{default:x(()=>r[2]||(r[2]=[a("span",{class:"material-symbols-outlined"},"close",-1)])),_:1})):S("",!0)],2))}}),Hn=O(jn,[["__scopeId","data-v-e8cc4657"]]),Zn={class:"BuilderToasts"},Gn=R({__name:"BuilderToasts",setup(e){const{toasts:i,removeToast:t}=Pe();return(d,r)=>(n(),p("div",Zn,[I(wt,{name:"list",tag:"div"},{default:x(()=>[(n(!0),p(H,null,ie(g(i),_=>(n(),A(Hn,{key:_.id,class:"BuilderToasts__toast",closable:_.closable,message:_.message,type:_.type,action:_.action,onClick:h=>g(t)(_.id)},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),Yn=O(Gn,[["__scopeId","data-v-6c357255"]]),Jn={key:0,class:"sidebar"},Xn={class:"builderMain"},Qn={class:"rendererWrapper"},eo=R({__name:"BuilderApp",setup(e){kt(D=>({f2a05b12:g(c).getMode()!=="preview"?"var(--builderSidebarWidth)":"0px"}));const i=ee({loader:()=>te(()=>import("./BuilderSettings-nTe4nU5k.js"),__vite__mapDeps([6,1,2,7,8,4,5,9,10]),import.meta.url),loadingComponent:le}),t=ee({loader:()=>te(()=>import("./BuilderSidebar-BJNYcXaH.js"),__vite__mapDeps([11,1,2,8,9,12]),import.meta.url),loadingComponent:le}),d=ee({loader:()=>te(()=>import("./ComponentRenderer-BBAYt90m.js"),__vite__mapDeps([13,1,2,7,14]),import.meta.url),loadingComponent:le}),r=ee({loader:()=>te(()=>import("./BuilderInstanceTracker-CukPzdXf.js"),__vite__mapDeps([15,1,2,16]),import.meta.url),loadingComponent:le}),_=ee({loader:()=>te(()=>import("./BuilderInsertionOverlay-NcmpqbiH.js"),__vite__mapDeps([17,1,2,18]),import.meta.url),loadingComponent:le}),h=ee({loader:()=>te(()=>import("./BuilderInsertionLabel-CUz_42eK.js"),__vite__mapDeps([19,1,2,20]),import.meta.url),loadingComponent:le}),f=V(N.core),c=V(N.builderManager),y=re(f),B=Pe(),{candidateId:C,candidateInstancePath:o,isCandidacyConfirmed:s,dropComponent:v,assignInsertionCandidacy:u,removeInsertionCandidacy:m}=Bt(f),{createAndInsertComponent:l,undo:k,redo:$,moveComponent:w,moveComponentUp:q,moveComponentDown:M,cutComponent:W,isPasteAllowed:F,isCopyAllowed:P,isCutAllowed:Q,isDeleteAllowed:ue,isGoToParentAllowed:ne,isGoToChildAllowed:be,isGoToNextSiblingAllowed:xe,isGoToPrevSiblingAllowed:we,pasteComponent:Ae,copyComponent:ke,removeComponentsSubtree:Ce,goToParent:_e,goToChild:T,goToNextSibling:K,goToPrevSibling:G,moveComponentToParent:Fe,moveComponentInsideNextSibling:Ee}=Te(f,c,y),ce=b(()=>c.getMode()),tt=b(()=>c.firstSelectedId.value);async function at(D){if(D.key=="Escape"){c.setSelection(null);return}const Y=$t()?D.metaKey:D.ctrlKey;if(D.target.closest("textarea, input, select"))return;if(D.key=="z"&&Y){D.preventDefault(),k();return}if(D.key=="y"&&Y){D.preventDefault(),$();return}if(!c.isSingleSelectionActive.value||!c.firstSelectedItem.value)return;const{componentId:E,instancePath:pe}=c.firstSelectedItem.value;if(D.key=="Delete"){const oe=c.selection.value.filter(Me=>ue(Me.componentId)).map(Me=>Me.componentId);Ce(...oe);return}if(Y)if(D.shiftKey)switch(D.key){case"ArrowDown":D.preventDefault(),xe(E)&&K(E);break;case"ArrowUp":D.preventDefault(),we(E)&&G(E);break;case"ArrowLeft":D.preventDefault(),ne(E)&&_e(E,pe);break;case"ArrowRight":D.preventDefault(),be(E)&&T(E);break}else switch(D.key){case"ArrowDown":D.preventDefault(),M(E);break;case"ArrowUp":D.preventDefault(),q(E);break;case"ArrowLeft":D.preventDefault(),Fe(E);break;case"ArrowRight":D.preventDefault(),Ee(E);break;case"v":if(!F(E))return;try{await Ae(E)}catch(oe){B.pushToast({type:"error",message:String(oe)})}break;case"c":P(E)&&ke(E);break;case"x":Q(E)&&W(E);break}}function nt(D){ce.value!=="preview"&&u(D)}function ot(D){if(ce.value==="preview")return;c.setSelection(null);const Y=v(D);if(!Y)return;const{draggedType:X,draggedId:E,parentId:pe,position:oe}=Y;E?w(E,pe,oe):l(X,pe,oe)}function st(D){if(ce.value==="preview"||D.target.closest("[data-writer-unselectable]"))return;const X=D.target.closest("[data-writer-id]");if(!X)return;const E=X.dataset.writerId,pe=X.dataset.writerInstancePath;c.isComponentIdSelected(E)&&c.selectionStatus.value!==Ke.Multiple||(D.preventDefault(),D.stopPropagation(),c.handleSelectionFromEvent(D,E,pe,"click"))}function lt(){c.isSettingsBarCollapsed.value=!1}const it=D=>{if(ce.value==="preview")return;const X=D.target.closest("[data-writer-id]").dataset.writerId,{type:E}=f.getComponentById(X);c.selectionStatus.value===Ke.Multiple&&(c.setSelection(X,void 0,"click"),c.isSettingsBarCollapsed.value=!0),D.dataTransfer.setData(`application/json;writer=${E},${X}`,"{}")};function rt(D){c.setSelection(null),m(D)}const qe=new AbortController;return de(()=>{document.addEventListener("keydown",at,{signal:qe.signal})}),he(()=>qe.abort()),(D,Y)=>(n(),p("div",{class:"BuilderApp",tabindex:"-1",style:ze(g(Ct))},[a("div",{class:z(["mainGrid",{openPanels:g(c).openPanels.value.size>0}])},[I(Ot,{class:"builderHeader"}),ce.value!=="preview"?(n(),p("div",Jn,[I(g(t))])):S("",!0),a("div",Xn,[a("div",Qn,[I(g(d),{class:z(["componentRenderer",{settingsOpen:g(c).isSingleSelectionActive}]),onDragover:nt,onDragstart:it,onDragend:rt,onDrop:ot,onClickCapture:st,onDblclick:lt},null,8,["class"])]),g(c).isSingleSelectionActive?(n(),A(g(i),{key:tt.value??"noneSelected"})):S("",!0)]),I(qn,{class:"panelSwitcher"})],2),ce.value!=="preview"?(n(),p(H,{key:0},[g(C)&&!g(s)?(n(),p(H,{key:0},[(n(),A(g(r),{key:g(o),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":g(o),"match-size":!0},{default:x(()=>[I(g(_))]),_:1},8,["instance-path"])),(n(),A(g(r),{key:g(o),class:"insertionLabelTracker","instance-path":g(o),"vertical-offset-pixels":-48},{default:x(()=>[I(g(h),null,{default:x(()=>[U(L(g(f).getComponentDefinition(g(f).getComponentById(g(C)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):S("",!0)],64)):S("",!0),Y[0]||(Y[0]=a("div",{id:"modal"},null,-1)),I(Kt,{id:"tooltip"}),I(Yn)],4))}}),to=O(eo,[["__scopeId","data-v-745c3f25"]]),oo=Object.freeze(Object.defineProperty({__proto__:null,default:to},Symbol.toStringTag,{value:"Module"}));export{le as B,ga as T,et as W,vn as a,oo as b,Pe as u};
